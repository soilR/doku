% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Daten Analyse mit RStudio - Dokumentation},
  pdfauthor={Dr.~Kristof Dorau},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{Daten Analyse mit RStudio - Dokumentation}
\author{Dr.~Kristof Dorau}
\date{Aktualisiert am: 2021-08-26 22:16:08}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{2}
\tableofcontents
}
\hypertarget{einleitung}{%
\section{Einleitung}\label{einleitung}}

Die folgende Anleitung soll eine Schritt-f√ºr-Schritt Hilfe f√ºr das erfolgreiche Arbeiten mit R geben. Die Abfolge der Kapitel basieren dabei auf den n√∂tigen Schwerpunkten, wie sie f√ºr den t√§glichen Gebrauch der Datenanalyse in den Geowissenschaften n√ºtzlich ist. Grundlage dieser Dokumentation und quasi die Bibel f√ºr Datenanalysten ist das Buch: H. Wickham and Grolemund, \textbf{R for Data Science} - Import, Tidy, Visualize, and Model Data, O'Reilly, Sebastopol, CA, USA, 2016. In der Literatur wird auch h√§ufig das Akronym ``r4ds'' verwendet, was eine Anspielung auf den Titel des Buches und dessen Inhalt ist.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/001} 

}

\caption{Schema Datenanalyse}\label{fig:unnamed-chunk-2}
\end{figure}

\hypertarget{syntax-und-stilistische-mittel-der-dokumentation}{%
\subsection{Syntax und stilistische Mittel der Dokumentation}\label{syntax-und-stilistische-mittel-der-dokumentation}}

Die Kapitel beinhalten verschiedene Rubriken und werden durch graphische Hilfsmittel hervorgehoben:

\begin{itemize}
\tightlist
\item
  Sogenannte code chunks (wir lernen sp√§ter was dies ist) sind grau hinterlegt und beinhalten Kommentare (\textbf{\#}), code (in diesem Fall die Rechnung 1+1; ja\ldots R kann wie ein Taschenrechner benutzt werden) und das dazugeh√∂rige Ergebnis (\textbf{\#\#}; zwei Rauten und keine Sorge, wir kl√§ren noch was die {[}1{]} bedeutet).
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Dies ist ein Kommentar }
\DecValTok{1}\SpecialCharTok{+}\DecValTok{1} 
\DocumentationTok{\#\# [1] 2}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  üîçÔ∏è Hier werden Literaturtipps gegeben
\item
  üí° N√ºtzliche Informationen und Tipps
\item
  üö® Wichtig zu merken
\end{itemize}

\begin{quote}
Dies ist ein Zitat
\end{quote}

\begin{itemize}
\item
  lubridate::() Das Wort zusammen mit ``::'' gibt den Namen des verwendeten packages wieder
\item
  Funktionsnamen + Klammer werden im Flie√ütext grau hinterlegt, wie bspw. \texttt{sum()} oder \texttt{mean()}
\end{itemize}

\hypertarget{falbeispiele}{%
\subsection{Falbeispiele}\label{falbeispiele}}

\hypertarget{speicherkoog}{%
\subsubsection{Speicherkoog}\label{speicherkoog}}

Ein Datensatz mit dem ich mich in dieser Dokumentation besch√§ftige stammt vom Polder Speicherkoog, einer 1978 eingedeichten Fl√§che an der Nordwestk√ºste von Schleswig-Holstein. Es ist damit der j√ºngste Koog und aus den Salzwiesen - die sich auch noch heute vor dem Deich befinden - haben sich in den letzten Jahrzehnten Kalkmarschen entwickelt. Mit \textgreater{} 90 Bodenpunkten geh√∂ren diese B√∂den zu den fruchtbarsten die es in Deutschland zu finden gibt.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/002} 

}

\caption{Lage Standort Speicherkoog}\label{fig:unnamed-chunk-4}
\end{figure}

An diesem Standort wird von \href{https://geographie.uni-koeln.de/forschung/arbeitsgruppen/bodengeographie-bodenkunde}{Prof.~Tim Mansfeldt; Universit√§t zu K√∂ln} seit 2010 eine vollautomatisierte Messstation betrieben, die seitdem auf st√ºndlicher Basis eine Vielzahl an bodenkundlichen, meteorologischen und hydrologischen Daten aufzeichnet. Der Datensatz (Stand Januar 2021) ist als .csv Dtei 27 mb gro√ü und umfasst 4,5 Millionen Messwerte. Warum die Auswertung dieses doch recht unhandlichen Datensatzes in R ein Kinderspiel ist m√∂chte ich auf den folgenden Seiten hervorheben. Dieses Fallbeispiel werde ich vorallem f√ºr die Darstellung von Zeitreihen nutzen.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/003} 

}

\caption{Messprogramm}\label{fig:unnamed-chunk-5}
\end{figure}

\hypertarget{mtcars-datensatz}{%
\subsubsection{\texorpdfstring{\texttt{mtcars} Datensatz}{mtcars Datensatz}}\label{mtcars-datensatz}}

R beinhaltet bereits interne Datens√§tze mit denen man explorative Datenanalyse betreiben kann. Einer davon ist der \texttt{mtcars} Datensatz. Es handelt sich dabei um Daten die aus dem 1974 erschienenen Magazin \emph{Motor Trend US} ver√∂ffentlicht wurden. Es beinhaltet Informationen zu Treibstoffverbrauch und zehn weiteren Kennwerten von 32 Automobilen.

\begin{itemize}
\tightlist
\item
  {[}, 1{]} mpg Miles/(US) gallon
\item
  {[}, 2{]} cyl Number of cylinders
\item
  {[}, 3{]} disp Displacement (cu.in.)
\item
  {[}, 4{]} hp Gross horsepower
\item
  {[}, 5{]} drat Rear axle ratio
\item
  {[}, 6{]} wt Weight (1000 lbs)
\item
  {[}, 7{]} qsec 1/4 mile time
\item
  {[}, 8{]} vs Engine (0 = V-shaped, 1 = straight)
\item
  {[}, 9{]} am Transmission (0 = automatic, 1 = manual)
\item
  {[},10{]} gear Number of forward gears
\item
  {[},11{]} carb Number of carburetors
\end{itemize}

\hypertarget{uxfcber-mich}{%
\subsection{√úber mich}\label{uxfcber-mich}}

Hi, ich bin Kristof und mit Leib und Seele Bodenkundler. Neben dreckigen H√§nden von der Gel√§ndearbeit mag ich das Hineindenken in gro√üe Datens√§tze. W√§hrend Studium, Promotion und auch in der Zeit danach als Wissenschaftlicher Mitarbeiter ist mein treuer Partner stets Excel (+xlstat), Origin und SPSS gewesen. Im Fr√ºhjahr 2020 war es dann soweit. Nach einigen fl√ºchtigen Begegnungen hatte ich endlich einen intensiveren Kontakt mit R (besser gesagt RStudio) und habe mir M√ºhe gegeben Sie intensiver kennenzulernen. Excel habe ich das noch nicht erz√§hlt, da ich Sie gelegentlich auch noch nutze ü§ê

R und ich haben also (Stand 09.04.2021) 1-j√§hriges und was soll ich sagen\ldotsüòç Ich hoffe wir werden noch viele sch√∂ne Jahre miteinander haben und ich kann den ein oder anderen √ºberzeugen sich dieser Partnerschaft anzuschlie√üen.

\hypertarget{literatur}{%
\subsection{Literatur üîç}\label{literatur}}

Diese Dokumentation orientiert sich stark an den folgenden Quellen, hinsichtlich Aufbau, Inhalt und Abbildungen. Quasi ein gro√üer Kuchen mit vielen Inhaltsstoffen, die dem Leser hoffentlich schmecken werden. Als wesentliche Quellen zu nennen sind:

\begin{itemize}
\tightlist
\item
  \href{https://r4ds.had.co.nz/index.html}{R for Data Science - Hadly Wickham}
\item
  \href{https://bookdown.org/ndphillips/YaRrr/}{YaRrr! The Pirate's Guide to R - Nathaniel D. Phillips}
\item
  \href{https://bookdown.org/joone/ComputationalMethods/}{Computational Methods in der politischen Kommunikationsforschung - Julian Unkel}
\item
  \href{https://bookdown.org/yihui/rmarkdown/}{R Markdown: The Definitive Guide - Yihui Xie}
\item
  \href{https://wilkelab.org/SDS375/}{Data Visualization in R - Claus Wilke}
\item
  \href{https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/\#colors}{A ggplot2 Tutorial for Beautiful Plotting in R - Cedric Scherer}
\item
  \href{https://github.com/allisonhorst/stats-illustrations}{Illustrationen von Allison Horst}
\end{itemize}

\hypertarget{erste-schritte-mit-r}{%
\section{Erste Schritte mit R}\label{erste-schritte-mit-r}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

R ist eine Programmiersprache f√ºr Datenanalyse mit vielen M√∂glichkeiten der Darstellung. Es hat sich als weit verbreitetes Hilfsmittel in der Wissenschaft aber auch Wirtschaft durchgesetzt und belegt unter den Standardsprachen (bspw. TIOBE-Index) Rang 9. Um die Benutzerfreundlichkeitt zu erh√∂hen wird weiterhin die Oberfl√§che RStudio angeboten. Das Desgin geht im Wesentlichen auf den Entwickler Ross Ihaka im Jahr 1993 zur√ºck.

\hypertarget{installation}{%
\subsection{Installation}\label{installation}}

Bevor wir starten m√ºssen noch einige Dinge installiert werden. Ein Tutorial dazu findet ihr auch hier:

\hypertarget{r}{%
\subsubsection{R}\label{r}}

\begin{figure}

{\centering \includegraphics[width=0.5\linewidth]{images/004} 

}

\caption{R logo}\label{fig:unnamed-chunk-8}
\end{figure}

R kann unter CRAN (comprehensive R archive network) heruntergeladen werden. CRAN setzt sich aus weltweit verteilten Servern zusammen, welche die Verteilung von R mit den dazugeh√∂rigen packages erm√∂glicht. Jedes Jahr gibt es ein gr√∂√üeres Update von R mit einigen kleineren. Man sollte daher regelm√§√üig R aktualisieren. Um base-R zu installieren bitte den folgenden Link klicken und den Instruktionen folgen.

\begin{longtable}[]{@{}ll@{}}
\toprule
Betriebssystem & Link \\
\midrule
\endhead
Windows & \url{http://cran.r-project.org/bin/windows/base/} \\
Mac & \url{http://cran.r-project.org/bin/macosx/} \\
\bottomrule
\end{longtable}

\hypertarget{rstudio}{%
\subsubsection{RStudio}\label{rstudio}}

\begin{figure}

{\centering \includegraphics[width=0.5\linewidth]{images/005} 

}

\caption{RStudio logo}\label{fig:unnamed-chunk-9}
\end{figure}

RStudio ist eine integrierte Benutzeroberfl√§che (IDE), welches das Arbeiten mit R vereinfacht. RStudio kann unter dem folgenden Link heruntergeladen werden: \url{https://www.rstudio.com/products/rstudio/download/}

\hypertarget{packages---das-tidyverse}{%
\subsubsection{Packages - das tidyverse}\label{packages---das-tidyverse}}

\begin{figure}

{\centering \includegraphics[width=0.5\linewidth]{images/006} 

}

\caption{Tidyverse logo}\label{fig:unnamed-chunk-10}
\end{figure}

Unter dem Begriff tidyverse ist eine Ansammlung von packages zu finden, welche vorallem vom RStudio Chefentwickler Hadly Wickham aufgesetzt wurden. Diese bilden die Grundlage zum Ausf√ºhren der √úbungen in diesem Buch. Mit dem folgenden Befehl kann das tidyverse installiert werden. Dazu einfach in die Konsole eintippen und mit enter best√§tigen

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

Um die Funktionen eines Packages jedoch zu nutzen muss es explizit aktiviert werden mit der Funktion library()

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

üí° Ein package ist eine Ansammlung von Funktionen, Daten und einer Dokumentation, welche das Arbeiten mit R vereinfachen. Bevor man sich an eine aufw√§ndige Analyse begibt sollte man √ºberpr√ºfen, ob es nicht ein Package gibt das einem das Problem direkt l√∂st.

\hypertarget{rstudio-benutzeroberfluxe4che}{%
\subsection{RStudio Benutzeroberfl√§che}\label{rstudio-benutzeroberfluxe4che}}

Die Benutzeroberfl√§che besteht aus vier wesentlichen Fenstern.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/007} 

}

\caption{Benutzeroberfl√§che RStudio. Source: https://bookdown.org/ndphillips/YaRrr/}\label{fig:unnamed-chunk-13}
\end{figure}

\hypertarget{source}{%
\subsubsection{Source}\label{source}}

Im source Fenster kann ein Skript geschrieben oder editiert werden. Die Befehle in diesem Fenster werden jedoch nicht explizit ausgef√ºhrt, sondern erst nachdem sie durch Run aktiviert werden. Es ist dabei m√∂glich einen Befehl pro Zeile auszuf√ºhren oder aber auch das komplette Skript durchlaufen zu lassen.
Es gibt drei verschiedene Methoden Code aus dem Source Fenster in der Console auszuwerten
- Copy+Paste des Befehls von dem source Fenster in die Konsole
- Den Befehl im source Fenster markieren und mit ``run'' ausf√ºhren
- Mit dem Hotkey ``command + enter'' wird die entsprechende Zeile direkt ausgef√ºhrt

üí° Die Hotkey Variante ist empfohlen.

\hypertarget{konsole}{%
\subsubsection{Konsole}\label{konsole}}

Die Konsole ist das Herzst√ºck von R. Code der hier geschrieben wird, wird auch direkt ausgef√ºhrt. Wenn man bspw. \texttt{1+1} in die Konsole tippt und mit enter best√§tigt, so bekommt man als direkte Antwort \texttt{2} ausgegeben.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{+}\DecValTok{1}
\DocumentationTok{\#\# [1] 2}
\end{Highlighting}
\end{Shaded}

üí° Versuche so viel wie m√∂glich im source Fenster zu arbeiten und nicht in der Konsole. Der Grund ist einfach: Code im source Fenster kann gespeichert werden und die Dokumentation bei mehreren Schritten ist √ºbersichtlicher.

\hypertarget{environment}{%
\subsubsection{Environment}\label{environment}}

Im Environment (Arbeitsumgebung) sind deine lokal gespreicherten R Objekte gespeichert. Dazu geh√∂ren, Vektoren, Matrizen oder spezielle Formate in R wie data frames oder tibbles. Weiterhin sind Daten hinterlegt wie gro√ü das Objekt ist und wie die Anzahl an Variablen und Beobachtungen ist.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/008} 

}

\caption{Tidyverse logo}\label{fig:unnamed-chunk-15}
\end{figure}

\hypertarget{files-plots-packages-help}{%
\subsubsection{Files / Plots / Packages / Help}\label{files-plots-packages-help}}

Unter Files werden die Dateien in deinem Projektordner angezeigt. Man kann hier ebenfalls Einstellungen an der Arbeitsumgebung durchf√ºhren. Wenn Abbildungen erstellt werden k√∂nnen diese optional unter deinem Code chunk angezeigt (siehe Abb. links) oder im Fenster ``plots'' (siehe Abb. rechts). Ich bevorzuge es die Abbildungen in einem seperaten Fenster angezeigt zu bekommen, da man √Ñnderungen im code unmittelbar sieht. Falls der code n√§mlich sehr lang ist muss man immer aufwendig runterscrollen.

\begin{figure}

{\centering \includegraphics[width=0.49\linewidth,height=0.2\textheight]{images/009} \includegraphics[width=0.49\linewidth,height=0.2\textheight]{images/010} 

}

\caption{caption}\label{fig:unnamed-chunk-16}
\end{figure}

Wenn R das erste mal heruntergeladen wird erscheinen nur packages die von den Entwicklern geschrieben wurden, bspw. die \texttt{mean()} und \texttt{hist()} Funktion. M√∂chte man jedoch auf Funktionen von anderen Autoren zur√ºckgreifen ist es notwendig, dass man zuerst deren package herunterl√§dt.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/011} 

}

\caption{Ein R package ist wie eine Gl√ºhbirne. Du musst sie mit install.packages() reindrehen, mit library() jedoch bei jeder neuen R Sitzung anschalten um sie zu nutzen. Source: https://bookdown.org/ndphillips/YaRrr/}\label{fig:unnamed-chunk-17}
\end{figure}

Es gibt eine M√∂glichkeit ein heruntergeladenes Package tempor√§r zu nutzen, und zwar durch die Notation \texttt{Package::Funktionsname()}. Ein Vorteil dieser Schreibweise ist es, dass dem Leser direkt die M√∂glichkeit gegeben wird zu erkennen von welchen package die Funktion stammt. Ein Nachteil ist jedoch, dass dies immer wieder von neuem geschrieben werden muss wenn das package nicht explizit mit \texttt{library("Package")} geladen wird.

Eine der wichtigsten Dinge ist das Hilfefenster. Hier kann man in den Dokumentationen zu den Packages nachlesen, welche Besonderheiten es gibt und was die Argumente bedeuten. In jeder Dokumentation gibt es auch eine Rubrik mit Beispielen.

üí° Wenn man vor einen Befehl ein ``?'' schreibt und die Zeile ausf√ºhrt erscheint automatisch die Dokumentation/Hilfe im Help Fenster.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?mean}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/012} 

}

\caption{Dokumentation zur Funktion mean() um einen Mittelwert zu bilden}\label{fig:unnamed-chunk-19}
\end{figure}

\hypertarget{code-lesen-und-schreiben}{%
\subsection{Code lesen und schreiben}\label{code-lesen-und-schreiben}}

Code chunks sind eine gro√üartige Sache (grau hinterlegte Box) und beinhalten \emph{Code}, \emph{Kommentare} und das \emph{Ergebnis}. Kommentare werden mit einer Raute (``\#'') kenntlich gemacht und werden beim Ausf√ºhren des chunks nicht von R erkannt. Dies hat sehr gro√üe Vorteile! Der wichtigste ist, dass man seine Gedanken vor jeden Befehl schreibt, um noch nach Jahren (im besten Fall üòÑ) nachzuvollziehen was man eigentlich damit gemeint hat. F√ºr Kollegen und einen selbst entsteht dadurch eine roadmap die zum Ziel f√ºhrt.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Definiere einen Vektor mit der L√§nge 1 bis 5 }
\NormalTok{vektor\_a }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}
\CommentTok{\# Zeige mir vektor\_a}
\NormalTok{vektor\_a}
\DocumentationTok{\#\# [1] 1 2 3 4 5}
\CommentTok{\# Wie lautet der Mittelwert von vektor\_a?}
\FunctionTok{mean}\NormalTok{(vektor\_a)}
\DocumentationTok{\#\# [1] 3}
\end{Highlighting}
\end{Shaded}

Der Inhalt eines code chunks sollte ohne Probleme in die eigene R Konsole kopiert und ausgef√ºhrt werden k√∂nnen.

üí° Falls eine Fehlermeldung auftritt wurde ein vorausgehendes package oder eine Datenquelle vermutlich nicht geladen.

\hypertarget{die-konsole}{%
\subsubsection{Die Konsole}\label{die-konsole}}

R code kann in jedem Texteditor oder Skriptfenster geschrieben werden. Um den Code auszuf√ºhren ist es jedoch wichtig ihn an die Kommandozeile (command-line; console) von R zu senden.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/013} 

}

\caption{Die Konsole mit der Kommandozeile von R. Source: https://bookdown.org/ndphillips/YaRrr/}\label{fig:unnamed-chunk-21}
\end{figure}

Die Kommandozeile in R startet mit dem \texttt{\textgreater{}} Symbol, auch \emph{prompt} genannt. Prompt leitet sich von prompting (auffordern) ab. Man wird also dazu aufgefordert einen Befehl einzutippen. \texttt{1+1} gibt also direkt \texttt{\#\#\ {[}1{]}\ 2} wieder. Die \texttt{{[}1{]}} steht dabei f√ºr den Index (mehr dazu sp√§ter).

\hypertarget{r-skript}{%
\subsubsection{R Skript}\label{r-skript}}

F√ºr einfache Befehle macht es Sinn direkt in die Konsole zu tippen. Code den man speichern m√∂chte und komplexere Anfragen sollten jedoch in ein R script geschrieben haben (hat die Dateiendung \texttt{.R}). Ein R Skript ist eine Zusammenfassung an code welches in einer Datei zusammengefasst wurde.
Um ein neues Skript zu speichern schreibe:

File - New file - R script

Um code in einem Skript auszuwerten muss es explizit an die Konsole gesendet werden.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/014} 

}

\caption{Code vom Skript an die Konsole senden. Source: https://bookdown.org/ndphillips/YaRrr/}\label{fig:unnamed-chunk-22}
\end{figure}

üí° Der shortcut strg+Enter wird euer bester Freund werden und ist meine bevorzugte Art.

\hypertarget{good-practice-code-zu-schreiben}{%
\subsubsection{Good practice Code zu schreiben}\label{good-practice-code-zu-schreiben}}

Einen klaren Gedanken auf das Papier zu bringen ist nicht so einfach. Beim Schreiben von Code verh√§lt es sich nat√ºrlich √§hnlich. Damit anderen Menschen ebenfalls Freude daran haben den Weg zum Ziel zu verstehen, sollte man es Ihnen so einfach wie m√∂glich machen. Hier sind ein paar Regeln:

\begin{itemize}
\tightlist
\item
  \textbf{\#} = Kommentiere code so h√§ufig wie m√∂glich mit der Raute \#. Mehr ist mehr!
\item
  \textbf{Leerzeichen} = Findestduesbesserwennichsoschreibe oder wenn ich wieder normal schreibe?
\item
  \textbf{Zeilenumbr√ºche} = Eine 100-seitige Abschlussarbeit in einem Absatz zu schreiben ist f√ºrchterlich und w√ºrde keiner tun. Bei code verh√§lt es sich √§hnlich.
\end{itemize}

üí© Beispiel

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\NormalTok{df}\OtherTok{\textless{}{-}}\FunctionTok{read.csv}\NormalTok{(}\StringTok{"data/data.csv"}\NormalTok{, }\AttributeTok{sep =} \StringTok{";"}\NormalTok{)}
\NormalTok{ggplot2}\SpecialCharTok{::}\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(wt,EH100b))}\SpecialCharTok{+}\FunctionTok{geom\_point}\NormalTok{()}
\FunctionTok{cor}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{wt, df}\SpecialCharTok{$}\NormalTok{EH100a, }\AttributeTok{use =} \StringTok{"complete"}\NormalTok{, }\AttributeTok{method =} \StringTok{"pearson"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

üí™ Beispiel

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Lade das package tidyverse}
\FunctionTok{library}\NormalTok{(tidyverse)}
\CommentTok{\# Lese den Datensatz "data" vom Speicherkoog ein}
\CommentTok{\# Das Trennzeichen ist Semikolon}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"data/data.csv"}\NormalTok{, }\AttributeTok{sep =} \StringTok{";"}\NormalTok{)}
\CommentTok{\# Stelle den Grundwasserstand (wt; in cm) und das Redoxpotenzial in 100 cm Tiefe dar (in mV)}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ wt)) }\SpecialCharTok{+} 
    \FunctionTok{geom\_histogram}\NormalTok{()}
\CommentTok{\# Berechne Pearson Korrelationskoeffizient zwischen Grundwasserstand und Redoxpotenzial in 100 cm Tiefe.}
\CommentTok{\# Entferne vorher fehlende Werte}
\FunctionTok{cor}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{wt, df}\SpecialCharTok{$}\NormalTok{EH100a, }\AttributeTok{use =} \StringTok{"complete"}\NormalTok{, }\AttributeTok{method =} \StringTok{"pearson"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{objekte-und-funktionen}{%
\subsection{Objekte und Funktionen}\label{objekte-und-funktionen}}

R arbeitet fast ausschlie√ülich mit zwei Dingen: Objekte und Funktionen. Im Folgenden Beispiel definieren wir ein Objekt (5 gemessene Werte der Lufttemperatur) mit der Funktion \texttt{c()}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle ein Objekt Lufttemperatur}
\NormalTok{lt }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{13.5}\NormalTok{, }\FloatTok{16.7}\NormalTok{, }\FloatTok{18.3}\NormalTok{, }\FloatTok{21.9}\NormalTok{, }\FloatTok{3.9}\NormalTok{)}
\CommentTok{\# Berechne die mittlere Lufttemperatur }
\FunctionTok{mean}\NormalTok{(lt)}
\DocumentationTok{\#\# [1] 14.86}
\end{Highlighting}
\end{Shaded}

Ein Objekt in R kann alles sein, bspw. ein

\begin{itemize}
\tightlist
\item
  Datensatz (data frames im Englischen; eine Sonderform des data frame ist ein tibble aber dazu sp√§ter mehr)
\item
  statistische Zusammenfassung des Datensatzes
\item
  statistischer Test
\item
  Einfache Nummern
\item
  Vektoren (wie in unserem Beispiel die 5 Messungen der Lufttemperatur)
\item
  Buchstaben und W√∂rter
\item
  Faktoren
\end{itemize}

Diese Objekte k√∂nnen verschiedene \textbf{Attribute} aufweisen, bspw. ein L√§ngenattribut unseres \texttt{lt} Vektors oder bei einem T-Test alle statistischen Parameter.

Was ist eine Funktion?

Eine Funktion greift meist auf ein oder mehrere Objekte zur√ºck (input), f√ºhrt etwas mit diesen durch, um dann etwas neues dadurch auszugeben (output). Ein Beispiel ist die Funktion um den Mittelwert von einem Vektor auszurechnen mit der Funktion \texttt{mean()}.

\hypertarget{neue-objekte-erstellen}{%
\subsubsection{Neue Objekte erstellen}\label{neue-objekte-erstellen}}

Einer der wichtigsten Kommandos in R ist der Befehl ein bestimmtes Objekt zuzuweisen mit \texttt{\textless{}-}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle ein Objekt mit dem Namen a und weisen ihm einen Satz zu}
\NormalTok{a }\OtherTok{\textless{}{-}} \StringTok{"Beste Norddeutschland Exkursion der Welt"}
\end{Highlighting}
\end{Shaded}

Schaue was passiert wenn du \texttt{a} in die Konsole eintippst.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a}
\DocumentationTok{\#\# [1] "Beste Norddeutschland Exkursion der Welt"}
\end{Highlighting}
\end{Shaded}

Was passiert wenn du \texttt{aa} eintippst?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{aa}
\end{Highlighting}
\end{Shaded}

\textbf{Fehler: Objekt `aa' nicht gefunden}

Richtig, wir haben das Objekt \texttt{aa} noch nicht definiert und daher kann es in unserer Arbeitsumgebung (Environment) auch nicht gefunden werden.

Objekte k√∂nnen auch miteinander verbunden werden:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \DecValTok{1}
\NormalTok{b }\OtherTok{\textless{}{-}} \DecValTok{100}
\CommentTok{\# Was ist a + b?}
\NormalTok{a}\SpecialCharTok{+}\NormalTok{b}
\DocumentationTok{\#\# [1] 101}
\CommentTok{\# Weise die Berechnung a + b dem Objekt c zu }
\NormalTok{c }\OtherTok{\textless{}{-}}\NormalTok{ a }\SpecialCharTok{+}\NormalTok{ b}
\CommentTok{\# Was passiert wenn du c in die Konsole eintippst?}
\NormalTok{c}
\DocumentationTok{\#\# [1] 101}
\end{Highlighting}
\end{Shaded}

Bei der Bennenung von Objekten gibt es auch Fehlerpotentzial:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Dies sind falsch benannte Objekte}
\NormalTok{Luft temperatur }\OtherTok{\textless{}{-}} \DecValTok{23} \CommentTok{\# Hat ein Leerzeichen}
\NormalTok{5lufttemperatur }\OtherTok{\textless{}{-}} \DecValTok{23} \CommentTok{\# Beginnt mit einer Zahl}
\NormalTok{lufttemperatur}\SpecialCharTok{!} \ErrorTok{\textless{}}\SpecialCharTok{{-}} \DecValTok{23} \CommentTok{\# Nicht g√ºltiger character "!"}
\end{Highlighting}
\end{Shaded}

Dar√ºber hinaus ist es wichtig zu wissen, dass R seeeeEeehr sensibel gegen√ºber Gro√ü- und Kleinschreibung ist. Die folgenden Objekte sind alle individuell:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Dies sind drei verschiedene Objekte}
\NormalTok{test }\OtherTok{\textless{}{-}} \DecValTok{1}
\NormalTok{TEST }\OtherTok{\textless{}{-}} \DecValTok{100}
\NormalTok{tEsT }\OtherTok{\textless{}{-}} \DecValTok{1000}
\end{Highlighting}
\end{Shaded}

üí° Gro√üe Buchstaben sollten bei der Benennung von Objekten nach M√∂glichkeit vermieden werden. Es dauert einfach l√§nger \texttt{MYDATA} oder \texttt{MyData} zu tippen als \texttt{mydata} ohne Umschalttaste.

Einige Dinge die man bei der Benennung von Objekten ber√ºcksichtigen sollte:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Gute Objektnamen}
\NormalTok{mittelwert }\OtherTok{\textless{}{-}} \FloatTok{2.5}
\NormalTok{mein\_alter }\OtherTok{\textless{}{-}} \DecValTok{32}
\NormalTok{groesse\_in\_cm }\OtherTok{\textless{}{-}} \DecValTok{175}

\CommentTok{\# Schlechte Objektnamen}
\NormalTok{x1 }\OtherTok{\textless{}{-}} \FloatTok{2.5}
\NormalTok{var2 }\OtherTok{\textless{}{-}} \DecValTok{32}
\NormalTok{asdasdasd }\OtherTok{\textless{}{-}} \DecValTok{175}
\end{Highlighting}
\end{Shaded}

Ich pers√∂nlich bevorzuge \textbf{snake\_case} W√∂rter. Sp√§ter lernen wir noch, dass sich diese W√∂rter durch ein Argument - den Namen Separator \texttt{name\_sep} - trennen lassen. Dies wird beim Umstrukturieren von Daten wichtig. Egal welches Schema man auch w√§hlt, einheitlich vorzugehen ist das Wichtigste.

üí° Gute Objektnamen sollten kurz und pr√§gnant sein! Lange Namen sind nicht intuitiv und Buchstaben alleine sagen auch nichts aus. Als Beispiel: Die durchschnittliche Lufttemperatur im Speicherkoog f√ºr M√§rz kann man mit \texttt{airtemp\_march\_koog} abk√ºrzen.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/016} 

}

\caption{Illustration von @allison_horst: https://twitter.com/allison_horst}\label{fig:unnamed-chunk-33}
\end{figure}

\hypertarget{beispiel-umrechnen-von-c-in-k}{%
\subsubsection{Beispiel: Umrechnen von ¬∞C in K}\label{beispiel-umrechnen-von-c-in-k}}

Der Mittelwert der Jahresdurchschnittstemperatur im Speicherkoog betr√§gt 10.14 ¬∞C. Mit Skalaren kann man einfache Rechenoperationen durchf√ºhren.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Mittelwert der Lufttemperatur in ¬∞C}
\NormalTok{mittel\_at }\OtherTok{\textless{}{-}} \FloatTok{10.14}
\CommentTok{\# Lasst uns die Lufttemperatur umrechnen von ¬∞C in K}
\CommentTok{\# 0 ¬∞C sind 273.15 K}
\NormalTok{mittel\_at }\SpecialCharTok{+} \FloatTok{273.15}
\DocumentationTok{\#\# [1] 283.29}
\end{Highlighting}
\end{Shaded}

Das Jahresmittel der Lufttemperatur betr√§gt also 283,3 K.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mittel\_at}
\DocumentationTok{\#\# [1] 10.14}
\end{Highlighting}
\end{Shaded}

Ups\ldots.wieso wird \texttt{mittel\_at} denn trotzdem in ¬∞C angezeigt ?! Denke daran:

üö® \textbf{Um ein Objekt zu √§ndern, muss es neu zugewiesen werden!}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Zuweisung des Jahresmittels der Lufttemperatur in K anstelle von ¬∞C}
\NormalTok{mittel\_at\_k }\OtherTok{\textless{}{-}}\NormalTok{ mittel\_at }\SpecialCharTok{+} \FloatTok{273.15}
\NormalTok{mittel\_at\_k}
\DocumentationTok{\#\# [1] 283.29}
\end{Highlighting}
\end{Shaded}

Wenn ihr bis hierhin gekommen seid, dann habt ihr schon eine ganze Menge verinnerlicht. Nicht das wir uns schon zur√ºcklehnen wollen, aber ein ein wenig Grund zum Feiern ist es dennoch üéâüçª.

\hypertarget{cheatsheets}{%
\subsection{Cheatsheets}\label{cheatsheets}}

Je √∂fter man mit bestimmten Funktionen, Befehlen und Argumenten in R arbeitet, desto leichter f√§llt es einem sie anzuwenden. Sich alle zu merken ist jedoch unm√∂glich und auch nicht zielf√ºhrend. Was jedoch hilfreich ist sind sogenannte Cheatsheets oder auf gut deutsch gesagt \textbf{Spickzettel}. Eine Zusammenfassung von sinnvollen Cheats ist hier zu finden:

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.5000}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.5000}}@{}}
\toprule
\begin{minipage}[b]{\linewidth}\raggedright
Beschreibung
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Link
\end{minipage} \\
\midrule
\endhead
Rstudio cheatsheets & \href{https://www.rstudio.com/resources/cheatsheets/}{https://www.rstudio.com/resources/cheatsheets} \\
Rstudio Benutzeroberfl√§che & \url{https://raw.githubusercontent.com/rstudio/cheatsheets/master/rstudio-ide.pdf} \\
Rmarkdown & \url{https://www.rstudio.com/wp-content/uploads/2016/03/rmarkdown-cheatsheet-2.0.pdf} \\
Daten einlesen; readr::() und tidyr::() & \url{https://raw.githubusercontent.com/rstudio/cheatsheets/master/data-import.pdf} \\
Arbeiten mit Faktoren; forcats::() & \url{https://raw.githubusercontent.com/rstudio/cheatsheets/master/factors.pdf} \\
Arbeiten mit Zeit und Datum; lubridate::() & \url{https://raw.githubusercontent.com/rstudio/cheatsheets/master/lubridate.pdf} \\
Buchstabenmanipulation; stringr::() & \url{https://raw.githubusercontent.com/rstudio/cheatsheets/master/strings.pdf} \\
Daten transformieren; dplyr::() & \url{https://raw.githubusercontent.com/rstudio/cheatsheets/master/data-transformation.pdf} \\
Dokumente erstellen; rmarkdown::() & \url{https://raw.githubusercontent.com/rstudio/cheatsheets/master/rmarkdown-2.0.pdf} \\
Datenvisualisierung; ggplot2::() & \url{https://raw.githubusercontent.com/rstudio/cheatsheets/master/data-visualization-2.1.pdf} \\
Erstellen von Karten I; sf::() & \url{https://raw.githubusercontent.com/rstudio/cheatsheets/master/cartography.pdf} \\
Erstellen von Karten II; sf::() & \url{https://raw.githubusercontent.com/rstudio/cheatsheets/master/sf.pdf} \\
shiny app & \url{https://raw.githubusercontent.com/rstudio/cheatsheets/master/shiny.pdf} \\
\bottomrule
\end{longtable}

\hypertarget{grundlagen}{%
\section{Grundlagen}\label{grundlagen}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

Im folgenden lernen wir mehr zu Datentypen in R und welche Rolle sie spielen. Ganz grundlegend lassen sich verschiedene Strukturen unterscheiden \href{https://statsandr.com/blog/variable-types-and-examples/}{Zusammenfassung}:

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/013a} 

}

\caption{Grundlegende Datenstruktur}\label{fig:unnamed-chunk-38}
\end{figure}

\begin{itemize}
\tightlist
\item
  \textbf{Quantitative Variablen} sind nummerisch und k√∂nnen gemessen werden

  \begin{itemize}
  \tightlist
  \item
    \textbf{Diskret} z√§hlbar mit einer finiten Anzahl an M√∂glichkeiten

    \begin{itemize}
    \tightlist
    \item
      Anzahl Kinder einer Familie
    \item
      Studenten in einem Klassenzimmer
    \item
      Br√∂tchen in einer T√ºte
    \end{itemize}
  \item
    \textbf{Kontinuierlich} nicht-z√§hlbar mit einer infiniten Anzahl an M√∂glichkeiten

    \begin{itemize}
    \tightlist
    \item
      Alter (e.g.~ein 28-j√§hriger Mann kann spezifischer ausgedr√ºckt 28 Jahre, 7 Monate, 16 Tage, 3 Stunden, 4 Minuten, 5 Sekunden, 31 Milisekunden, \ldots{} alt sein. Alle Messungen stoppen per Konvention bei einem gewissen Level an Pr√§zision, was uns aber nicht stoppen muss h√∂heraufl√∂send zu messen. Dies bedingt das unser Messwert eine infinite Anzahl an M√∂glichkeiten aufweisen kann.
    \item
      Gewicht
    \item
      Gr√∂√üe
    \end{itemize}
  \end{itemize}
\item
  \textbf{Qualitative Variable} oder kategorische Variable (factor in R) sind nicht-numerisch und die Werte passen in eine Kategorie

  \begin{itemize}
  \tightlist
  \item
    \textbf{Nominal} keine Hierarchie oder Ordnung in den Werten (e.g.~Geschlecht (m√§nnlich/weiblich) hat keine interne Struktur
  \item
    \textbf{Ordinal} hat eine interne Ordnung (e.g.~Gesundheitsstatus differenziert nach schlecht/m√§√üig/gut/hervorragend)
  \end{itemize}
\end{itemize}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/018} 

}

\caption{Illustration von @allison_horst: https://twitter.com/allison_horst}\label{fig:unnamed-chunk-39}
\end{figure}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/019} 

}

\caption{Illustration von @allison_horst: https://twitter.com/allison_horst}\label{fig:unnamed-chunk-40}
\end{figure}

\hypertarget{datentypen}{%
\subsection{Datentypen}\label{datentypen}}

Im folgenden werden die vier grundlegenden \textbf{Datentypen} (\emph{atomic vectors}) behandelt:

\begin{itemize}
\tightlist
\item
  \texttt{logical} (TRUE, FALSE)
\item
  \texttt{integer} (c(1, 2.4, 4.678))
\item
  \texttt{double} (auch als \texttt{numeric} bezeichnet; c(1L, 2L, 3L))
\item
  \texttt{character} (c(``these are'', ``some strings''))
\end{itemize}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/079} 

}

\caption{Atomic vectors, source: https://adv-r.hadley.nz/vectors-chap.html}\label{fig:unnamed-chunk-41}
\end{figure}

Diese Datentypen k√∂nnen in Form bestimmter Datenstrukturen miteinander verkn√ºft werden. In R ist dies √ºber die Dimensionalit√§t der Daten definiert mit den f√ºnf h√§ufigsten Strukturen:

\begin{longtable}[]{@{}lll@{}}
\caption{Datenstrukturen in R}\tabularnewline
\toprule
& Homogen & Heterogen \\
\midrule
\endfirsthead
\toprule
& Homogen & Heterogen \\
\midrule
\endhead
1d & Atomic vector & List \\
2d & Matrix & Data frame \\
nd & Array & \\
\bottomrule
\end{longtable}

üîç \href{https://adv-r.hadley.nz/}{Advanced R by Hadly Wickham}

\hypertarget{numerische-objekte}{%
\subsubsection{Numerische Objekte}\label{numerische-objekte}}

Zahlenwerte in R werden als \texttt{numeric} bezeichnet mit der Unterteilung in \texttt{integer} (ganze Zahlen) oder \texttt{double} (Dezimalzahlen). Die Zuweisung von R, selbst wenn ich eine ganze Zahl zuweise, ist jedoch vom Typ double.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \DecValTok{4}
\FunctionTok{typeof}\NormalTok{(a)}
\DocumentationTok{\#\# [1] "double"}
\end{Highlighting}
\end{Shaded}

üí° Mit der Funktion \texttt{typeof()} kann der Objekttyp erfragt werden.

Um eine ganze Zahl wiederzugeben muss ein L hinter die Zahl gesetzt werden.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}}\NormalTok{ 4L}
\FunctionTok{typeof}\NormalTok{(a)}
\DocumentationTok{\#\# [1] "integer"}
\end{Highlighting}
\end{Shaded}

\hypertarget{textobjekte}{%
\subsubsection{Textobjekte}\label{textobjekte}}

Ein \texttt{character} Objekt sind Namen wie \texttt{"Kristof"}, \texttt{"Tim"}, \texttt{"Beste\ Norddeutschland\ Exkursion\ der\ Welt"} (Textvariablen werden auch als \emph{string} bezeichnet). Um ein \texttt{character} Objekt zu definieren sind die Anf√ºhrungsstriche als einfache \texttt{\textquotesingle{}\ \textquotesingle{}} oder doppelte \texttt{"\ "} Anf√ºhrungszeichen wichtig!

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Dies sind alles character Objekte }
\StringTok{"Kristof"}
\DocumentationTok{\#\# [1] "Kristof"}
\StringTok{"Tim"}
\DocumentationTok{\#\# [1] "Tim"}
\StringTok{"Beste Norddeutschland Exkursion der Welt"}
\DocumentationTok{\#\# [1] "Beste Norddeutschland Exkursion der Welt"}
\end{Highlighting}
\end{Shaded}

Bestimmte Funktionen brauchen einen numerical input, wohingegen andere einen character input ben√∂tigen. Schaue was passiert:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"5"}\NormalTok{, }\StringTok{"1"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\textbf{Warnmeldung:In mean.default(c(``5'', ``1'')) :Argument ist weder numerisch noch boolesch: gebe NA zur√ºck}

Lasse ich die Anf√ºhrungsstriche weg, dann ist wieder alles im Lot:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\DocumentationTok{\#\# [1] 3}
\end{Highlighting}
\end{Shaded}

\hypertarget{logicals}{%
\subsubsection{Logicals}\label{logicals}}

Der dritte wichtige Objekttyp in R lautet \texttt{logical} und dieser kann zwei Werte annehmen: \texttt{TRUE} (wahr) und \texttt{FALSE} (falsch). Logicals entstehen durch den logischen Vergleich zwischen zwei Werten oder den Elementen eines Vektors. Operatoren die f√ºr diese Anfrage genutzt werden k√∂nnen lauten:

\begin{longtable}[]{@{}lll@{}}
\caption{Logische Operatoren in R.}\tabularnewline
\toprule
Operator & Bedeutung & Beispiel \\
\midrule
\endfirsthead
\toprule
Operator & Bedeutung & Beispiel \\
\midrule
\endhead
== & ist gleich & 1==1 (ergibt \texttt{TRUE}) ``a''==``b'' (ergibt \texttt{FALSE}) \\
!= & ist nicht gleich & 1 != 1 (ergibt \texttt{FALSE}) ``a'' != ``b'' (ergibt \texttt{TRUE}) \\
\textless{} & ist kleiner als & 1 \textless{} 2 (ergibt \texttt{TRUE}) 2 \textless{} 2 (ergibt \texttt{FALSE}) \\
\textgreater{} & ist gr√∂√üer als & 2 \textgreater{} 1 (ergibt \texttt{TRUE}) 2 \textgreater{} 2 (ergibt \texttt{FALSE}) \\
\textless= & ist kleiner gleich & 1 \textless= 2 (ergibt \texttt{TRUE}) 2 \textless= 2 (ergibt \texttt{TRUE}) \\
\textgreater= & ist gr√∂√üer gleich & 2 \textgreater= 1 (ergibt \texttt{TRUE}) 2 \textgreater= 2 (ergibt \texttt{TRUE}) \\
\bottomrule
\end{longtable}

\hypertarget{fehlende-werte}{%
\subsubsection{Fehlende Werte}\label{fehlende-werte}}

In R werden fehlende Werte mit \texttt{NA} f√ºr \texttt{not\ available} gekennzeichnet. F√ºr bestimmte Funktionen und Anwendungen ist es wichtig, falls ein \texttt{NA} Wert in einer Zeitreihe auftritt (ü§Ø \ldots leider ist dies in langen Zeitreihen fast immer der Fall), R explizit zu sagen was mit diesen Werten getan werden soll.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Ich habe einen Vektor mit einem fehlenden Wert NA}
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\ConstantTok{NA}\NormalTok{,}\DecValTok{5}\NormalTok{)}
\FunctionTok{mean}\NormalTok{(a)}
\DocumentationTok{\#\# [1] NA}
\end{Highlighting}
\end{Shaded}

Hm\ldots der Mittelwert von 1,2,3,4,NA und 5 ist NA und nicht eine Zahl? Wie kommt das blo√ü. In dem Fall ist es n√ºtzlich in die Dokumentation der Funktion \texttt{mean()} nachzuschauen.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?mean}
\end{Highlighting}
\end{Shaded}

\textbf{Default S3 method: mean(x, trim = 0, na.rm = FALSE, \ldots)}

Die default Argumente der Funktion lauten \texttt{na.rm\ =\ FALSE}, was soviel bedeutet \textbf{na} Werte nicht zu entfernen sondern in die Berechnung mit einzubeziehen.

üí° na steht f√ºr fehlende Werte (NA) und rm ist die Kurzform f√ºr remove, also entfernen.

Damit unsere Rechnung funktioniert m√ºssen wir in der \texttt{mean()} Funktion das Argument \texttt{na.rm\ =\ TRUE} setzen, also erst die fehlende Werte entfernen und dann den Mittelwert berechnen:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(a, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\DocumentationTok{\#\# [1] 3}
\end{Highlighting}
\end{Shaded}

üí™ Es funktioniert! Dies ist tats√§chlich einer der h√§ufigsten Fehler und egal wie h√§ufig man daran denkt, es kommt immer wieder vor das dies einer der Gr√ºnde ist warum man sich Stunden den Kopf √ºber ein nicht funktionierendes Skript zerbricht ü§Ø

\hypertarget{weitere-objekttypen}{%
\subsubsection{Weitere Objekttypen}\label{weitere-objekttypen}}

Neben den drei vermeintlich wichtigsten Objekttypen (\texttt{numeric}, \texttt{character}, \texttt{logical}) gibt es in R noch die Typen f√ºr

\begin{itemize}
\tightlist
\item
  Kategoriale Variablen \texttt{factor}
\item
  Datumsangaben \texttt{date}
\item
  Datumsangaben + Zeit \texttt{datetime}
\item
  \ldots{} und weitere
\end{itemize}

Wenn man Daten in R einliest muss man R jedoch einen Schubser geben, damit eine Spalte bspw. auch als \texttt{date}erkannt wird und nicht als \texttt{character} oder \texttt{numeric}. Wie man dies ber√ºcksichtigt lernen wir in dem Kapitel \textbf{Daten einlesen}.

\hypertarget{s3-objekte}{%
\paragraph{S3 Objekte}\label{s3-objekte}}

Vektoren in R weisen verschiedene Attribute auf. Die zwei wichtigsten Attribute sind:

\begin{itemize}
\tightlist
\item
  dimension (wandelt einen Vektor in eine Matrix oder Liste um)
\item
  class (bedient S3 Objekte, bspw. \texttt{factor}, \texttt{date} und \texttt{POSIXct})
\end{itemize}

Wenn ein Objekt in R ein \emph{class} Attribut besitzt wird es automatisch in ein \textbf{S3 object} umgewandelt und unterscheidet sich dadurch von einem normalen Vektor.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/080} 

}

\caption{S3 atomic vectors, source: https://adv-r.hadley.nz/vectors-chap.html#s3-atomic-vectors}\label{fig:unnamed-chunk-50}
\end{figure}

\texttt{factor} sind bspw. aufgebaut aus den Attributen \texttt{class} und \texttt{levels} um kategorische Daten zu speichern.

\hypertarget{objekttypen-uxe4ndern}{%
\subsubsection{Objekttypen √§ndern}\label{objekttypen-uxe4ndern}}

Die Syntax in R um Objekte umzuwandeln lautet \texttt{as.{[}Objekttyp{]}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \StringTok{"25"}
\FunctionTok{typeof}\NormalTok{(a)}
\DocumentationTok{\#\# [1] "character"}
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(a)}
\FunctionTok{typeof}\NormalTok{(a)}
\DocumentationTok{\#\# [1] "double"}
\end{Highlighting}
\end{Shaded}

Dies klappt allerdings nur, insofern die Umwandlung logisch ist. In allen anderen F√§llen gibt es eine Warnmeldung unter Erzeugung von \texttt{NA}s anstelle der Werte.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(}\StringTok{"Beste Norddeutschland Exkursion der Welt"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\textbf{\#\# Warning: NAs introduced by coercion}

\hypertarget{datenstrukturen}{%
\subsection{Datenstrukturen}\label{datenstrukturen}}

\begin{figure}

{\centering \includegraphics[width=0.5\linewidth]{images/015} 

}

\caption{Vergleich eines Skalars und eines Vektors}\label{fig:unnamed-chunk-53}
\end{figure}

Der einfachste Datentyp in R ist ein Skalar (\href{https://de.wikipedia.org/wiki/Skalar_(Mathematik)}{Mathematische Gr√∂√üe, die allein durch die Angabe eines \emph{Zahlen}wertes charakterisiert ist}). Im Gegensatz zu der mathematischen Beschreibung, kann in R ein Skalar jedoch \texttt{character} sein und muss nicht zwangsl√§ufig als \texttt{numeric} definiert sein. Mathematische Operationen sind mit \texttt{numerischen} Skalaren m√∂glich, nicht jedoch wenn diese in R als \texttt{character} gespeichert sind.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \StringTok{"1"}
\NormalTok{b }\OtherTok{\textless{}{-}} \StringTok{"2"}
\NormalTok{a }\SpecialCharTok{+}\NormalTok{ b}
\end{Highlighting}
\end{Shaded}

\textbf{Fehler in a + b : nicht-numerisches Argument f√ºr bin√§ren Operator}

Bisher haben wir einfache Objekte in R erzeugt, wie eben genau Skalare oder k√ºrzere Vektoren. Es gibt jedoch noch weitere Datenstrukturen, die sich hinsichtlich der Dimensionalit√§t unterscheiden (1D und 2D) und ob die Objekttypen homogen (nur ein Objekttyp) und heterogen (unterschiedliche Objekttypen) beinhalten:

\textbar Datenstruktur \textbar{} Dimensionalit√§t \textbar{} Objekttypen\textbar{}
\textbar Vektor \textbar{} eindimensional \textbar{} homogen\textbar{}
\textbar Liste \textbar{} eindimensional \textbar heterogen\textbar{}
\textbar Matrix \textbar{} zweidimensional \textbar{} homogen\textbar{}
\textbar Dataframe \textbar{} zweidimensional \textbar heterogen\textbar{}

Table: Datenstrukturen in R.

\hypertarget{vektor}{%
\subsubsection{Vektor}\label{vektor}}

Ein Vektor ist eine Ansammlung von Skalaren, die als ein R Objekt gespeichert wurden. Die Zahlen von 1 bis 10 bspw. bilden einen numerischen Vektor mit der L√§nge 10. Die Buchstaben im Alphabet sind ein Vektor mit der L√§nge 26.

üö® Vektoren k√∂nnen nur \texttt{numeric} \textbf{oder} \texttt{character} sein\ldots nicht beides!

Es gibt verschiedene M√∂glichkeiten einen Vektor selber zu bilden.

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3333}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3333}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3333}}@{}}
\caption{Funktionen um einen Vektor zu erzeugen.}\tabularnewline
\toprule
\begin{minipage}[b]{\linewidth}\raggedright
Funktion
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Beispiel
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Ergebnis
\end{minipage} \\
\midrule
\endfirsthead
\toprule
\begin{minipage}[b]{\linewidth}\raggedright
Funktion
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Beispiel
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Ergebnis
\end{minipage} \\
\midrule
\endhead
\texttt{c(a,\ b,\ ...)} & \texttt{c(1,\ 5,\ 9)} & 1, 5, 9 \\
\texttt{a:b} & \texttt{1:5} & 1, 2, 3, 4, 5 \\
\texttt{seq(from,\ to,\ by,\ length.out)} & \texttt{seq(from\ =\ 0,\ to\ =\ 6,\ by\ =\ 2)} & 0, 2, 4, 6 \\
\texttt{rep(x,\ times,\ each,\ length.out)} & \texttt{rep(c(7,\ 8),\ times\ =\ 2,\ each\ =\ 2)} & 7, 7, 8, 8, 7, 7, 8, 8 \\
\bottomrule
\end{longtable}

Die einfachste M√∂glichkeit einen Vektor zu erzeugen ist mit der \texttt{c()} Funktion. ``c'' leitet sich von dem englischen Wort concatenate ab und l√§sst sich frei √ºbersetzen mit ``zusammenbringen'' oder ``zusammenf√ºhren''.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Speichere einen Vektor mit den Zahlen von 1 bis 10 }
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{)}
\CommentTok{\# Stelle die Zahlen dar}
\NormalTok{a}
\DocumentationTok{\#\#  [1]  1  2  3  4  5  6  7  8  9 10}
\end{Highlighting}
\end{Shaded}

Man kann auch Vektoren miteinander verkn√ºpfen:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{)}
\NormalTok{b }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{)}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(a, b)}
\NormalTok{x}
\DocumentationTok{\#\#  [1]  1  2  3  4  5  6  7  8  9 10}
\end{Highlighting}
\end{Shaded}

üòé Yeah! Das hat ja gut geklappt.

Man kann auch \texttt{character} Vektoren erstellen mit demselben Prinzip

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wort\_vec }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Beste"}\NormalTok{, }\StringTok{"Exkursion"}\NormalTok{, }\StringTok{"der"}\NormalTok{, }\StringTok{"Welt"}\NormalTok{)}
\NormalTok{wort\_vec}
\DocumentationTok{\#\# [1] "Beste"     "Exkursion" "der"       "Welt"}
\end{Highlighting}
\end{Shaded}

Wenn ihr allerdings einen Vektor von 1:1000 erstellen wollt\ldots{} ü§Ø
Aber keine Sorge! Auch hierf√ºr gibt es Funktionen in R um das Leben zu erleichtern.

\hypertarget{ab}{%
\paragraph{a:b}\label{ab}}

Die Vektoren werden in Inkrementen von 1 aufgef√ºllt

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\DocumentationTok{\#\#  [1]  1  2  3  4  5  6  7  8  9 10}
\CommentTok{\# Das ganze geht auch R√ºckw√§rts}
\DecValTok{10}\SpecialCharTok{:}\DecValTok{1}
\DocumentationTok{\#\#  [1] 10  9  8  7  6  5  4  3  2  1}
\CommentTok{\# Oder mit nicht runden Zahlen (non{-}integers)}
\FloatTok{2.5}\SpecialCharTok{:}\FloatTok{8.5}
\DocumentationTok{\#\# [1] 2.5 3.5 4.5 5.5 6.5 7.5 8.5}
\end{Highlighting}
\end{Shaded}

\hypertarget{seq}{%
\paragraph{seq()}\label{seq}}

Diese Funktion musste ich f√ºr Zeitreihenuntersuchungen schon √∂fter verwenden und ist ein wahrer Retter in der Not.

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.4643}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.5357}}@{}}
\toprule
\begin{minipage}[b]{\linewidth}\raggedright
Argument
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Definition
\end{minipage} \\
\midrule
\endhead
\texttt{from} & Beginn der Sequenz \\
\texttt{to} & Ende der Sequenz \\
\texttt{by} & Die Inkremente \\
\texttt{length.out} & Die gew√ºnschte L√§nge der Sequent (nur wichtig wenn \texttt{by} festgelegt wurde) \\
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle Nummer von 1 bis 10 in einer Schritten}
\FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \DecValTok{1}\NormalTok{, }\AttributeTok{to =} \DecValTok{10}\NormalTok{, }\AttributeTok{by =} \DecValTok{1}\NormalTok{)}
\DocumentationTok{\#\#  [1]  1  2  3  4  5  6  7  8  9 10}
\CommentTok{\# Erstelle ganze Zahlen von 0 bis 100 in 10er Schritten}
\FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \DecValTok{0}\NormalTok{, }\AttributeTok{to =} \DecValTok{100}\NormalTok{, }\AttributeTok{by =} \DecValTok{10}\NormalTok{)}
\DocumentationTok{\#\#  [1]   0  10  20  30  40  50  60  70  80  90 100}
\end{Highlighting}
\end{Shaded}

Wenn das Argument \texttt{length.out} verwendet wird, entspricht die L√§nge des Vektors dem Wert von \texttt{length.out}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle 10 Zahlen von 1 bis 5}
\FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \DecValTok{1}\NormalTok{, }\AttributeTok{to =} \DecValTok{5}\NormalTok{, }\AttributeTok{length.out =} \DecValTok{10}\NormalTok{)}
\DocumentationTok{\#\#  [1] 1.000000 1.444444 1.888889 2.333333 2.777778 3.222222 3.666667 4.111111}
\DocumentationTok{\#\#  [9] 4.555556 5.000000}
\CommentTok{\# Erstelle 3 Zahlen von 0 bis 100}
\FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \DecValTok{0}\NormalTok{, }\AttributeTok{to =} \DecValTok{100}\NormalTok{, }\AttributeTok{length.out =} \DecValTok{3}\NormalTok{)}
\DocumentationTok{\#\# [1]   0  50 100}
\end{Highlighting}
\end{Shaded}

\hypertarget{rep}{%
\paragraph{rep()}\label{rep}}

\begin{longtable}[]{@{}ll@{}}
\toprule
Argument & Definition \\
\midrule
\endhead
\texttt{x} & Ein Skalar oder Vektor der wiederholt werden soll \\
\texttt{times} & Die Anzahl wie h√§ufig \texttt{x} wiederholt werden soll \\
\texttt{each} & Die Anzahl wie h√§ufig jeder Wert in \texttt{x} wiederholt werden soll \\
\texttt{length.out} & Die gew√ºnschte L√§nge der Sequenz \\
\bottomrule
\end{longtable}

Die rep() Funktion erlaubt es also einen Skalar oder Vektor beliebig oft zu wiederholen.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\AttributeTok{x =} \DecValTok{3}\NormalTok{, }\AttributeTok{times =} \DecValTok{10}\NormalTok{)}
\DocumentationTok{\#\#  [1] 3 3 3 3 3 3 3 3 3 3}
\FunctionTok{rep}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{each =} \DecValTok{3}\NormalTok{)}
\DocumentationTok{\#\# [1] 1 1 1 2 2 2}
\FunctionTok{rep}\NormalTok{(}\AttributeTok{x =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{length.out =} \DecValTok{10}\NormalTok{)}
\DocumentationTok{\#\#  [1] 1 2 3 1 2 3 1 2 3 1}
\end{Highlighting}
\end{Shaded}

üí° Man kann eine \texttt{a:b} Funktion mit einer \texttt{rep()} Funktion verkn√ºpfen.
üí° Sogar das \texttt{times} und \texttt{each} Argument lassen sich in die \texttt{rep()} Funktion integrieren

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\AttributeTok{x =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{each =} \DecValTok{2}\NormalTok{, }\AttributeTok{times =} \DecValTok{2}\NormalTok{)}
\DocumentationTok{\#\#  [1] 1 1 2 2 3 3 1 1 2 2 3 3}
\end{Highlighting}
\end{Shaded}

\hypertarget{vektorelemente-auswuxe4hlen}{%
\paragraph{Vektorelemente ausw√§hlen}\label{vektorelemente-auswuxe4hlen}}

Um auf eine Zahl in einem Vektor zuzugreifen k√∂nnen wir dies √ºber eine eckige Klammer \texttt{{[}{]}} tun.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{)}
\NormalTok{a[}\DecValTok{2}\NormalTok{]}
\DocumentationTok{\#\# [1] 2}
\NormalTok{a[}\DecValTok{5}\NormalTok{]}
\DocumentationTok{\#\# [1] 5}
\end{Highlighting}
\end{Shaded}

Wenn wir mehrere Elemente des Vektors ausw√§hlen m√∂chten, dann m√ºssen wir einen neuen Vektor √ºber die Positionen erzeugen, beispielsweise um das erste, dritte und f√ºnfte Element des Vektors auszugeben:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a[}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{5}\NormalTok{)]}
\DocumentationTok{\#\# [1] 1 3 5}
\end{Highlighting}
\end{Shaded}

Eine weitere M√∂glichkeite die ersten drei Elemente eines Vektors auszuw√§hlen ist mit dem Doppelpunkt \texttt{:} was so viel bedeutet wie \emph{von bis}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{]}
\DocumentationTok{\#\# [1] 1 2 3 4}
\end{Highlighting}
\end{Shaded}

Elemente in einem Vektor k√∂nnen auch mit \texttt{=} benannt werden. Bei der Benennung von Spaltennamen in einer Tabelle (dataframe oder Matrix in R) ist der Befehl √§hnlich.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{namen }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\AttributeTok{eins =} \StringTok{"Dies"}\NormalTok{, }\AttributeTok{zwei =} \StringTok{"ist"}\NormalTok{, }\AttributeTok{drei =} \StringTok{"ein"}\NormalTok{, }\AttributeTok{vier =} \StringTok{"Test"}\NormalTok{)}
\NormalTok{namen}
\DocumentationTok{\#\#   eins   zwei   drei   vier }
\DocumentationTok{\#\# "Dies"  "ist"  "ein" "Test"}
\NormalTok{namen[}\StringTok{"vier"}\NormalTok{]}
\DocumentationTok{\#\#   vier }
\DocumentationTok{\#\# "Test"}
\end{Highlighting}
\end{Shaded}

\hypertarget{liste}{%
\subsubsection{Liste}\label{liste}}

Listen √§hneln Vektoren und k√∂nnen √ºber die Funktion \texttt{list()} erzeugt werden. Beispielsweise der Standort Speicherkoog kann als Liste wie folgt erzeugt werden:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{country =} \StringTok{"Germany"}\NormalTok{, }\AttributeTok{state =} \StringTok{"Schleswig{-}Holstein"}\NormalTok{, }\AttributeTok{city =} \StringTok{"Meldorf"}\NormalTok{, }\AttributeTok{name =} \StringTok{"Speicherkoog"}\NormalTok{)}
\NormalTok{koog}
\DocumentationTok{\#\# $country}
\DocumentationTok{\#\# [1] "Germany"}
\DocumentationTok{\#\# }
\DocumentationTok{\#\# $state}
\DocumentationTok{\#\# [1] "Schleswig{-}Holstein"}
\DocumentationTok{\#\# }
\DocumentationTok{\#\# $city}
\DocumentationTok{\#\# [1] "Meldorf"}
\DocumentationTok{\#\# }
\DocumentationTok{\#\# $name}
\DocumentationTok{\#\# [1] "Speicherkoog"}
\end{Highlighting}
\end{Shaded}

Die Darstellung gegen√ºber Vektoren ist jedoch eine andere. Anstelle der Darstellung nebeneinander werden die Listen Elemente untereinander dargestellt.

\hypertarget{matrix-und-dataframe}{%
\subsubsection{Matrix und dataframe}\label{matrix-und-dataframe}}

\begin{figure}

{\centering \includegraphics[width=0.5\linewidth]{images/020} 

}

\caption{Darstellung von Datenstrukturen}\label{fig:unnamed-chunk-68}
\end{figure}

\hypertarget{matrix}{%
\paragraph{Matrix}\label{matrix}}

Eine Matrix ist eine zweidimensionale Struktur und kann mit der Funktion \texttt{matrix()} erzeugt werden.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle einen Vektor von 1 bis 10}
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{)}
\CommentTok{\# Teile den Vektor auf zwei Spalten auf}
\NormalTok{b }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(a, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\NormalTok{b}
\DocumentationTok{\#\#      [,1] [,2]}
\DocumentationTok{\#\# [1,]    1    6}
\DocumentationTok{\#\# [2,]    2    7}
\DocumentationTok{\#\# [3,]    3    8}
\DocumentationTok{\#\# [4,]    4    9}
\DocumentationTok{\#\# [5,]    5   10}
\CommentTok{\# Teile den Vektor auf zwei Zeilen auf}
\NormalTok{c }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(a, }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{)}
\NormalTok{c}
\DocumentationTok{\#\#      [,1] [,2] [,3] [,4] [,5]}
\DocumentationTok{\#\# [1,]    1    3    5    7    9}
\DocumentationTok{\#\# [2,]    2    4    6    8   10}
\end{Highlighting}
\end{Shaded}

Mit der Funktion \texttt{rbind()} (row = Zeile) oder \texttt{cbind()} (column = Spalte) k√∂nnen wir mehrere Vektoren auch zusammenf√ºhren.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{)}
\NormalTok{b }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{11}\SpecialCharTok{:}\DecValTok{20}\NormalTok{)}
\NormalTok{c }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{21}\SpecialCharTok{:}\DecValTok{30}\NormalTok{)}
\CommentTok{\# Erstelle eine Matrix mit drei Spalten}
\FunctionTok{cbind}\NormalTok{(a,b,c)}
\DocumentationTok{\#\#        a  b  c}
\DocumentationTok{\#\#  [1,]  1 11 21}
\DocumentationTok{\#\#  [2,]  2 12 22}
\DocumentationTok{\#\#  [3,]  3 13 23}
\DocumentationTok{\#\#  [4,]  4 14 24}
\DocumentationTok{\#\#  [5,]  5 15 25}
\DocumentationTok{\#\#  [6,]  6 16 26}
\DocumentationTok{\#\#  [7,]  7 17 27}
\DocumentationTok{\#\#  [8,]  8 18 28}
\DocumentationTok{\#\#  [9,]  9 19 29}
\DocumentationTok{\#\# [10,] 10 20 30}
\CommentTok{\# Erstelle eine Matrix mit drei Zeilen}
\FunctionTok{rbind}\NormalTok{(a,b,c)}
\DocumentationTok{\#\#   [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]}
\DocumentationTok{\#\# a    1    2    3    4    5    6    7    8    9    10}
\DocumentationTok{\#\# b   11   12   13   14   15   16   17   18   19    20}
\DocumentationTok{\#\# c   21   22   23   24   25   26   27   28   29    30}
\end{Highlighting}
\end{Shaded}

Die Spalten- oder Zeilennamen einer Matrix k√∂nnen auch benannt oder umbenannt werden mit der Funktion \texttt{colnames()} oder \texttt{rownames()}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mat }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(a,b,c)}
\NormalTok{mat}
\DocumentationTok{\#\#   [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]}
\DocumentationTok{\#\# a    1    2    3    4    5    6    7    8    9    10}
\DocumentationTok{\#\# b   11   12   13   14   15   16   17   18   19    20}
\DocumentationTok{\#\# c   21   22   23   24   25   26   27   28   29    30}
\FunctionTok{rownames}\NormalTok{(mat) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Zeile 1"}\NormalTok{, }\StringTok{"Zeile 2"}\NormalTok{, }\StringTok{"Zeile 3"}\NormalTok{)}
\NormalTok{mat}
\DocumentationTok{\#\#         [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]}
\DocumentationTok{\#\# Zeile 1    1    2    3    4    5    6    7    8    9    10}
\DocumentationTok{\#\# Zeile 2   11   12   13   14   15   16   17   18   19    20}
\DocumentationTok{\#\# Zeile 3   21   22   23   24   25   26   27   28   29    30}
\end{Highlighting}
\end{Shaded}

Eine n√ºtzliche Funktion lautet \texttt{t()} um eine Matrix oder dataframe zu \textbf{transponieren}, also umzuwandeln und um 90¬∞ zu vertauschen.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Transponiere die Matrix mat }
\FunctionTok{t}\NormalTok{(mat)}
\DocumentationTok{\#\#       Zeile 1 Zeile 2 Zeile 3}
\DocumentationTok{\#\#  [1,]       1      11      21}
\DocumentationTok{\#\#  [2,]       2      12      22}
\DocumentationTok{\#\#  [3,]       3      13      23}
\DocumentationTok{\#\#  [4,]       4      14      24}
\DocumentationTok{\#\#  [5,]       5      15      25}
\DocumentationTok{\#\#  [6,]       6      16      26}
\DocumentationTok{\#\#  [7,]       7      17      27}
\DocumentationTok{\#\#  [8,]       8      18      28}
\DocumentationTok{\#\#  [9,]       9      19      29}
\DocumentationTok{\#\# [10,]      10      20      30}
\end{Highlighting}
\end{Shaded}

Unsere Zeilennamen machen jetzt nat√ºrlich keinen Sinn mehr üôÉ Versuche mal die Spaltennamen richtig zu beschriften.

\hypertarget{dataframe}{%
\paragraph{Dataframe}\label{dataframe}}

Eine Matrix √§hnelt der Datenstruktur wie man sie aus Excel, SPSS etc. kennt. Gro√üer Unterschied ist aber, dass eine Matrix nur \textbf{einen} Datentyp erlaubt und ein dataframe \textbf{mehrere} Typen. Mit der Funktion \texttt{data.frame()} k√∂nnen wir gleich lange Vektoren unterschiedlichen Typs kombinieren.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle einen dataframe}
\NormalTok{beatles\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{name =} \FunctionTok{c}\NormalTok{(}\StringTok{"John"}\NormalTok{, }\StringTok{"Paul"}\NormalTok{, }\StringTok{"George"}\NormalTok{, }\StringTok{"Ringo"}\NormalTok{),}
  \AttributeTok{surname =} \FunctionTok{c}\NormalTok{(}\StringTok{"Lennon"}\NormalTok{, }\StringTok{"McCartney"}\NormalTok{, }\StringTok{"Harrison"}\NormalTok{, }\StringTok{"Starr"}\NormalTok{),}
  \AttributeTok{born =} \FunctionTok{c}\NormalTok{(}\DecValTok{1940}\NormalTok{, }\DecValTok{1942}\NormalTok{, }\DecValTok{1943}\NormalTok{, }\DecValTok{1940}\NormalTok{)}
\NormalTok{)}
\NormalTok{beatles\_data}
\DocumentationTok{\#\#     name   surname born}
\DocumentationTok{\#\# 1   John    Lennon 1940}
\DocumentationTok{\#\# 2   Paul McCartney 1942}
\DocumentationTok{\#\# 3 George  Harrison 1943}
\DocumentationTok{\#\# 4  Ringo     Starr 1940}
\end{Highlighting}
\end{Shaded}

Die h√§ndische Eingabe von tabellarischen Daten w√§re nat√ºrlich umst√§ndlich. In R gibt es einfache M√∂glichkeiten diese aus externen Datenquellen (z.B. CSV, Excel, txt, \ldots) einzulesen und zu verarbeiten.

\hypertarget{tibble}{%
\paragraph{tibble}\label{tibble}}

\texttt{tibble} haben dieselbe Datenstruktur wie \texttt{data.frame}, nur das Attribut \texttt{class} in einem tibble ist l√§nger:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# create a data frame}
\NormalTok{df1 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"b"}\NormalTok{, }\StringTok{"c"}\NormalTok{),}
  \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)}
\NormalTok{)}
\FunctionTok{typeof}\NormalTok{(df1)}
\DocumentationTok{\#\# [1] "list"}
\FunctionTok{attributes}\NormalTok{(df1)}
\DocumentationTok{\#\# $names}
\DocumentationTok{\#\# [1] "x" "y"}
\DocumentationTok{\#\# }
\DocumentationTok{\#\# $class}
\DocumentationTok{\#\# [1] "data.frame"}
\DocumentationTok{\#\# }
\DocumentationTok{\#\# $row.names}
\DocumentationTok{\#\# [1] 1 2 3}

\CommentTok{\# create a tibble}
\NormalTok{df2 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"b"}\NormalTok{, }\StringTok{"c"}\NormalTok{),}
  \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)}
\NormalTok{)}
\FunctionTok{typeof}\NormalTok{(df2)}
\DocumentationTok{\#\# [1] "list"}
\FunctionTok{attributes}\NormalTok{(df2)}
\DocumentationTok{\#\# $names}
\DocumentationTok{\#\# [1] "x" "y"}
\DocumentationTok{\#\# }
\DocumentationTok{\#\# $row.names}
\DocumentationTok{\#\# [1] 1 2 3}
\DocumentationTok{\#\# }
\DocumentationTok{\#\# $class}
\DocumentationTok{\#\# [1] "tbl\_df"     "tbl"        "data.frame"}
\end{Highlighting}
\end{Shaded}

\hypertarget{zufallszahlen-erzeugen}{%
\subsection{Zufallszahlen erzeugen}\label{zufallszahlen-erzeugen}}

R ist eine Statistiksprache und da w√§re es doch verwunderlich wenn es nicht auch Funktionen gibt, um Zufallszahlen zu erzeugen. F√ºr Vektoren ist dies die Funktion \texttt{sample()}:

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.1786}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.8214}}@{}}
\toprule
\begin{minipage}[b]{\linewidth}\raggedright
Argument
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Definition
\end{minipage} \\
\midrule
\endhead
\texttt{x} & Ein Vektor (character oder numeric) von dem die Zufallszahlen erzeugt werden. \\
\texttt{size} & Die Anzahl der Zufallszahlen. Der Standard (default) ist die L√§nge des Vektors \texttt{x}. \\
\texttt{replace} & Standard ist \texttt{FALSE}. Bei \texttt{TRUE} kann die Zahl mehrmals vorkommen. \\
\texttt{prob} & Ein Vektor der M√∂glichkeiten f√ºr \texttt{x} mit der Wahrs \texttt{x} is. The vector of probabilities you give as an argument should add up to one. If you don't specify the \texttt{prob} argument, all outcomes will be equally likely. \\
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Die Zahlen 1 bis 5 treten nur einmal auf}
\FunctionTok{sample}\NormalTok{(}\AttributeTok{x =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, }\AttributeTok{size =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# [1] 1 3 5 4 2}
\CommentTok{\# Die Zahlen 1 bis 5 k√∂nnen ggf. mehrmals auftreten hei replace = TRUE}
\FunctionTok{sample}\NormalTok{(}\AttributeTok{x =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, }\AttributeTok{size =} \DecValTok{5}\NormalTok{, }\AttributeTok{replace =}\NormalTok{ T)}
\DocumentationTok{\#\# [1] 5 1 2 3 3}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/017} 

}

\caption{Illustration von @allison_horst: https://twitter.com/allison_horst}\label{fig:unnamed-chunk-76}
\end{figure}

Die erzeugten Zufallsvariablen k√∂nnen dabei \textbf{normalverteilt} oder \textbf{nicht-normalverteilt} sein. Es gibt jedoch noch eine Vielzahl weiterer Funktionen in R, die mit dem help Befehl aufgerufen werden k√∂nnen

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?Distributions}
\end{Highlighting}
\end{Shaded}

Die normale Standardverteilung (auch bekannt unter Gausssche Normalverteilung) kann mit der Funktion \texttt{rnorm} erzeugt werden. Es k√∂nnen dabei die folgenden Argumente gesetzt werden.

\begin{longtable}[]{@{}ll@{}}
\toprule
Argument & Definition \\
\midrule
\endhead
\texttt{n} & Stichprobenanzahl. \\
\texttt{mean} & Mittelwert der Verteilung. \\
\texttt{sd} & Standardabweichung der Verteilung. \\
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle 100000 Zahlen mit dem Mittelwert 10 und der Standardverteilung 3}
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\AttributeTok{n =} \DecValTok{100000}\NormalTok{, }\AttributeTok{mean =} \DecValTok{10}\NormalTok{, }\AttributeTok{sd =} \DecValTok{3}\NormalTok{)}
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(a)}
\CommentTok{\# Erstelle zwei weitere Spalten. Selber Mittelwert aber unterschiedliche SD }
\CommentTok{\# Keine Sorge! Was das komische Symbol \%\textgreater{}\% bedeutet lernen wir sp√§ter}
\FunctionTok{colnames}\NormalTok{(a) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"norm\_3"}\NormalTok{)}
\NormalTok{a }\OtherTok{\textless{}{-}}\NormalTok{ a }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{norm\_1 =} \FunctionTok{rnorm}\NormalTok{(}\AttributeTok{n =} \DecValTok{100000}\NormalTok{, }\AttributeTok{mean =} \DecValTok{10}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{norm\_0.5 =} \FunctionTok{rnorm}\NormalTok{(}\AttributeTok{n =} \DecValTok{100000}\NormalTok{, }\AttributeTok{mean =} \DecValTok{10}\NormalTok{, }\AttributeTok{sd =} \FloatTok{0.5}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{everything}\NormalTok{())}
\CommentTok{\# Erstelle die Abbildung mit ggplot...keine Sorge. Die Power von ggplot lernt ihr sp√§ter kennen. }
\NormalTok{a }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ value, }\AttributeTok{color =} \FunctionTok{fct\_reorder}\NormalTok{(}\AttributeTok{.f =}\NormalTok{ name, }\AttributeTok{.x =}\NormalTok{ value, }\AttributeTok{.fun =}\NormalTok{ max))) }\SpecialCharTok{+}
    \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_color\_discrete}\NormalTok{(}\AttributeTok{name =} \StringTok{"Standardabweichung"}\NormalTok{) }\SpecialCharTok{+}
\NormalTok{    my\_theme}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-78-1} \end{center}

Das Erzeugen der Daten ist spielend leicht. Plotten der Daten vermittelt weiterhin einen Eindruck davon, wie die Dichteverteilung der Daten variiert bei gleichem \texttt{mean()} aber unterschiedlicher \texttt{sd()}.
Was sagt euch die Stichprobenanzahl √ºber das Aussehen der Kurve aus?

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Normalverteilung bei 10 Zufallszahlen}
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\AttributeTok{n =} \DecValTok{10}\NormalTok{, }\AttributeTok{mean =} \DecValTok{10}\NormalTok{, }\AttributeTok{sd =} \DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{as.data.frame}\NormalTok{()}
\NormalTok{p1 }\OtherTok{\textless{}{-}}\NormalTok{ a }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ .)) }\SpecialCharTok{+}
    \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
        \AttributeTok{title =} \StringTok{"n = 10"}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{geom\_vline}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{mean}\NormalTok{(.)), }\AttributeTok{color =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
\NormalTok{    my\_theme}
\CommentTok{\# Normalverteilung bei 100 Zufallszahlen}
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\AttributeTok{n =} \DecValTok{100}\NormalTok{, }\AttributeTok{mean =} \DecValTok{10}\NormalTok{, }\AttributeTok{sd =} \DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{as.data.frame}\NormalTok{()}
\NormalTok{p2 }\OtherTok{\textless{}{-}}\NormalTok{ a }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ .)) }\SpecialCharTok{+}
    \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
        \AttributeTok{title =} \StringTok{"n = 100"}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{geom\_vline}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{mean}\NormalTok{(.)), }\AttributeTok{color =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
\NormalTok{    my\_theme}
\CommentTok{\# Normalverteilung bei 100.000 Zufallszahlen}
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\AttributeTok{n =} \DecValTok{100000}\NormalTok{, }\AttributeTok{mean =} \DecValTok{10}\NormalTok{, }\AttributeTok{sd =} \DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{as.data.frame}\NormalTok{()}
\NormalTok{p3 }\OtherTok{\textless{}{-}}\NormalTok{ a }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ .)) }\SpecialCharTok{+}
    \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
        \AttributeTok{title =} \StringTok{"n = 100.000"}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{geom\_vline}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{mean}\NormalTok{(.)), }\AttributeTok{color =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
\NormalTok{    my\_theme}

\NormalTok{p1 }\SpecialCharTok{+}\NormalTok{ p2 }\SpecialCharTok{+}\NormalTok{ p3}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-79-1} \end{center}

üö® Jedes mal wenn das Skript neu ausgef√ºhrt wird, √§ndern sich auch die Zufallszahlen.

\hypertarget{rechnen-mit-vektoren}{%
\subsection{Rechnen mit Vektoren}\label{rechnen-mit-vektoren}}

Es lassen sich mit Vektoren mathematische Operationen und zusammenfassende Statistiken durchf√ºhren. Im folgenden wollen wir Redoxpotenziale umrechnen, welche mit einer Silber-Silberchlorid Elektrode gemessen wurden. F√ºr die Vergleichbarkeit und korrekte Nomenklatur sollten die Werte jedoch immer gegen die Standardwasserstoffelektrode (SHE) angegeben werden. Das Potenzial der SHE ist bei 25 ¬∞C um +207 mV gr√∂√üer, als das der Ag-AgCl Elektrode. Was m√ºssen wir also tun? Wir m√ºssen auf jeden Wert +207 mV addieren. Kein Problem in R:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Ein Vektor mit gemessenen Redoxpotenzialen einer Ag{-}AgCl Elektrode}
\CommentTok{\# Die Funktion \textasciigrave{}runif()\textasciigrave{} erzeugt Werte mit einer stetigen Gleichverteilung zwischen min() und max()}
\NormalTok{e\_agcl }\OtherTok{\textless{}{-}} \FunctionTok{runif}\NormalTok{(}\AttributeTok{n =} \DecValTok{100}\NormalTok{, }\AttributeTok{min =} \DecValTok{400}\NormalTok{, }\AttributeTok{max =} \DecValTok{500}\NormalTok{)}
\CommentTok{\# Addition von +207 mV auf jeden Wert des Vektors }
\NormalTok{eh }\OtherTok{\textless{}{-}}\NormalTok{ e\_agcl }\SpecialCharTok{+} \DecValTok{207}
\CommentTok{\# Erstelle einen data frame aus den beiden Vektoren }
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(e\_agcl, eh) }
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{n =} \FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \DecValTok{1}\NormalTok{, }\AttributeTok{to =} \FunctionTok{nrow}\NormalTok{(df))) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{c}\NormalTok{(}\StringTok{"e\_agcl"}\NormalTok{, }\StringTok{"eh"}\NormalTok{))}
\CommentTok{\# Plotte die Darstellung}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(n, value, }\AttributeTok{color =}\NormalTok{ name)) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}
        \AttributeTok{title =} \StringTok{"Verlauf der Redoxpotenziale (korrigiert und unkorrigiert)"}\NormalTok{, }
        \AttributeTok{x =} \StringTok{"Zeit"}\NormalTok{, }
        \AttributeTok{y =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"E"}\NormalTok{[H], }\StringTok{" (mV)"}\NormalTok{))}
\NormalTok{    ) }\SpecialCharTok{+}
    \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{800}\NormalTok{)) }\SpecialCharTok{+}
\NormalTok{    my\_theme}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-80-1} \end{center}

Wenn wir mathematische Berechnungen mit einem Skalar an einem Vektor durchf√ºhren (in unserem Fall +207 mV), dann f√ºhrt R die Berechnung f√ºr jedes Element des Vektors durch. Es ist nicht nur Addition m√∂glich, sondern auch Subtraktion, Multiplikation und Division. Selbst logarithmieren und entlogarithmieren etc. ist kein Problem.

Eine Zusammfassung der m√∂glichen Operationen seht ihr unten:

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.2985}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3433}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3582}}@{}}
\caption{Statistik Funktionen in R.}\tabularnewline
\toprule
\begin{minipage}[b]{\linewidth}\raggedright
Funktion
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Beispiel
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Ergebnis
\end{minipage} \\
\midrule
\endfirsthead
\toprule
\begin{minipage}[b]{\linewidth}\raggedright
Funktion
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Beispiel
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Ergebnis
\end{minipage} \\
\midrule
\endhead
\texttt{sum(x),\ product(x)} & \texttt{sum(1:10)} & 55 \\
\texttt{min(x),\ max(x)} & \texttt{min(1:10)} & 1 \\
\texttt{mean(x),\ median(x)} & \texttt{mean(1:10)} & 5.5 \\
\texttt{sd(x),\ var(x),\ range(x)} & \texttt{sd(1:10)} & 3.0276504 \\
\texttt{quantile(x,\ probs)} & \texttt{quantile(1:10,\ probs\ =\ .2)} & 2.8 \\
\texttt{summary(x)} & \texttt{summary(1:10)} & \texttt{Min\ =\ 1.00.\ 1st\ Qu.\ =\ 3.25,\ Median\ =\ 5.50,\ Mean\ =\ 5.50,\ 3rd\ Qu.\ =\ 7.75,\ Max\ =\ 10.0} \\
\bottomrule
\end{longtable}

Lasst uns den Mittelwert und die Standardabweichung des Redoxpotentziales der Zeitreihe berechnen (wenn nicht explizit erw√§hnt beziehe ich mich immer auf den E\textsubscript{H} Wert in mV gemessen).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Mittelwert }
\FunctionTok{mean}\NormalTok{(eh)}
\DocumentationTok{\#\# [1] 658.5736}
\CommentTok{\# SD}
\FunctionTok{sd}\NormalTok{(eh)}
\DocumentationTok{\#\# [1] 29.46584}
\end{Highlighting}
\end{Shaded}

Kein Problem mehr f√ºr uns üòé

Vektoren sind simple 1-dimensionale Objekte in R. Wir haben jedoch auch schon Objekte wie Matrix, dataframe oder Listen kennengelernt. Eine grundlegende Sache einer Matrix oder eines dataframe ist es, dass die Vektoren \textbf{diesselbe} L√§nge haben m√ºssen! Dies l√§sst sich mit der Funktion \texttt{length()} √ºberpr√ºfen. Wie lang war nochmal unser \texttt{eh} Vektor?

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(eh)}
\DocumentationTok{\#\# [1] 100}
\end{Highlighting}
\end{Shaded}

Die \texttt{length()} Funktion ist nicht die einzige wichtige Funktion um mit Vektoren oder Daten im Allgemeinen zu arbeiten. F√ºr eure Arbeit mit R sind folgende wichtig:

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.1884}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.2754}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.3768}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 6\tabcolsep) * \real{0.1594}}@{}}
\toprule
\begin{minipage}[b]{\linewidth}\raggedright
Funktion
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Beschreibung
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Beispiel
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Ergebnis
\end{minipage} \\
\midrule
\endhead
\texttt{round(x,\ digits)} & Runde Elemente in x zu \texttt{digits} Stellen & \texttt{round(c(2.231,\ 3.1415),\ digits\ =\ 1)} & 2.2, 3.1 \\
\texttt{ceiling(x),\ floor(x)} & Runde Elemente in x Auf (oder ab) zur n√§chsten ganzen Zahl & \texttt{ceiling(c(5.1,\ 7.9))} & 6, 8 \\
\texttt{x\ \%\%\ y} & Ganzzahlige Division (ie. x durch y) & \texttt{7\ \%\%\ 3} & 1 \\
\bottomrule
\end{longtable}

\hypertarget{str-funktion}{%
\subsection{str() Funktion}\label{str-funktion}}

Eine wichtige Funktion um Informationen √ºber einen Datensatz oder ein Objekt zu bekommen ist die Funktion \texttt{str()}, kurz f√ºr \textbf{structure}. Diese Funktion l√§sst sich auf alle Datenstrukturen in R anweden, also f√ºr Vektoren, Listen, Matrix und dataframes.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erkunden eines Vektors mit 100 Zufallszahlen}
\FunctionTok{str}\NormalTok{(eh)}
\DocumentationTok{\#\#  num [1:100] 640 641 680 693 665 ...}
\end{Highlighting}
\end{Shaded}

Hier kann man folgende Informationen draus ablesen:

\begin{itemize}
\tightlist
\item
  Es handelt sich um ein \texttt{numeric} Datenformat
\item
  Der Vektor hat 100 Elemente von 1 bis 100
\item
  Die ersten f√ºnf Zahlen lauten \ldots{}
\end{itemize}

Haben wir ein komplizierteres Objekt wie den mtcars Datensatz wird die \texttt{str()} Auflistung etwas komplexer:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erkunden des Datensatzes mtcars}
\FunctionTok{str}\NormalTok{(mtcars)}
\DocumentationTok{\#\# \textquotesingle{}data.frame\textquotesingle{}:    32 obs. of  11 variables:}
\DocumentationTok{\#\#  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...}
\DocumentationTok{\#\#  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...}
\DocumentationTok{\#\#  $ disp: num  160 160 108 258 360 ...}
\DocumentationTok{\#\#  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...}
\DocumentationTok{\#\#  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...}
\DocumentationTok{\#\#  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...}
\DocumentationTok{\#\#  $ qsec: num  16.5 17 18.6 19.4 17 ...}
\DocumentationTok{\#\#  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...}
\DocumentationTok{\#\#  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...}
\DocumentationTok{\#\#  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...}
\DocumentationTok{\#\#  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...}
\end{Highlighting}
\end{Shaded}

Wir k√∂nnen an der Datenstruktur erkennen, dass es sich um einen \texttt{data.frame} handelt mit 32 observations von 11 Variablen. Alle haben den Datentyp \texttt{numeric}. Die Liste ist jedoch so lang, dass sie nicht komplett dargestellt wird. Wollen wir nur die ersten f√ºnf Eintr√§ge anzeigen geht dies mit der \texttt{head()} Funktion und die letzten f√ºnf Eintr√§ge mit der \texttt{tail()} Funktion:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(mtcars, }\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\#                    mpg cyl disp  hp drat    wt  qsec vs am gear carb}
\DocumentationTok{\#\# Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4}
\DocumentationTok{\#\# Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4}
\DocumentationTok{\#\# Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1}
\DocumentationTok{\#\# Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1}
\DocumentationTok{\#\# Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2}
\FunctionTok{tail}\NormalTok{(mtcars, }\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\#                 mpg cyl  disp  hp drat    wt qsec vs am gear carb}
\DocumentationTok{\#\# Lotus Europa   30.4   4  95.1 113 3.77 1.513 16.9  1  1    5    2}
\DocumentationTok{\#\# Ford Pantera L 15.8   8 351.0 264 4.22 3.170 14.5  0  1    5    4}
\DocumentationTok{\#\# Ferrari Dino   19.7   6 145.0 175 3.62 2.770 15.5  0  1    5    6}
\DocumentationTok{\#\# Maserati Bora  15.0   8 301.0 335 3.54 3.570 14.6  0  1    5    8}
\DocumentationTok{\#\# Volvo 142E     21.4   4 121.0 109 4.11 2.780 18.6  1  1    4    2}
\end{Highlighting}
\end{Shaded}

Wenn man den Namen des Datensatzes / Objektes in die Funktion \texttt{View()} - V dabei gro√ü geschrieben - eingibt, dann kann man sich den Datensatz auch im Viewer Fenster von R ansehen.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{View}\NormalTok{(mtcars)}
\end{Highlighting}
\end{Shaded}

\hypertarget{selektion-von-spaltenzeilen-in-dataframes}{%
\subsection{Selektion von Spalten/Zeilen in dataframes}\label{selektion-von-spaltenzeilen-in-dataframes}}

Man kann auf einen einzelnen Vektor des \texttt{mtcars} dataframes zugreifen, indem man den Namen des Datensatzes mit dem \texttt{\$} und weiterhin mit dem Spaltennamen verkn√ºpft:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Zeige mit die Pferdest√§rken (hp) der Fahrzeuge an}
\NormalTok{mtcars}\SpecialCharTok{$}\NormalTok{hp}
\DocumentationTok{\#\#  [1] 110 110  93 110 175 105 245  62  95 123 123 180 180 180 205 215 230  66  52}
\DocumentationTok{\#\# [20]  65  97 150 150 245 175  66  91 113 264 175 335 109}
\end{Highlighting}
\end{Shaded}

Das Ergebnis ist ein Vektor, mit dem wir die bekannten Vektorfunktionen anwenden k√∂nnen. Die eckige Zahl zu Beginn der Zeile steht dabei f√ºr das \texttt{i}te Element des Vektors. Die Zahl 110 steht also auf der Position (dem Index) {[}1{]} und die Zahl 245 and Position {[}24{]}. Die Darstellung erleichert es einen √úberblick √ºber die Anzahl an Elementen zu bekommen.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp)}
\DocumentationTok{\#\# [1] 146.6875}
\end{Highlighting}
\end{Shaded}

Die Autos haben im Mittel also 146 PS, bereits 1974 üòé

Auch mit \texttt{{[}{]}} kann auf Vektoren in einem dataframe zugegriffen werden. Der Spaltenname muss hierbei jedoch in \texttt{""} gesetzt werden.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(mtcars[}\StringTok{"hp"}\NormalTok{], }\DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\#                    hp}
\DocumentationTok{\#\# Mazda RX4         110}
\DocumentationTok{\#\# Mazda RX4 Wag     110}
\DocumentationTok{\#\# Datsun 710         93}
\DocumentationTok{\#\# Hornet 4 Drive    110}
\DocumentationTok{\#\# Hornet Sportabout 175}
\end{Highlighting}
\end{Shaded}

Wenn wir die Position der Spalte \texttt{hp} kennen gen√ºgt aber auch die Zahl

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(mtcars[}\DecValTok{4}\NormalTok{], }\DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\#                    hp}
\DocumentationTok{\#\# Mazda RX4         110}
\DocumentationTok{\#\# Mazda RX4 Wag     110}
\DocumentationTok{\#\# Datsun 710         93}
\DocumentationTok{\#\# Hornet 4 Drive    110}
\DocumentationTok{\#\# Hornet Sportabout 175}
\end{Highlighting}
\end{Shaded}

Last but not least, eine letzte M√∂glichkeit Daten zu spezifizieren ist durch das Setzen eines Kommas:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# W√§hle die ersten zwei Zeilen aus aber ALLE Spalten}
\FunctionTok{head}\NormalTok{(mtcars[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, ], }\DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\#               mpg cyl disp  hp drat    wt  qsec vs am gear carb}
\DocumentationTok{\#\# Mazda RX4      21   6  160 110  3.9 2.620 16.46  0  1    4    4}
\DocumentationTok{\#\# Mazda RX4 Wag  21   6  160 110  3.9 2.875 17.02  0  1    4    4}
\CommentTok{\# W√§hle die ersten zwei Spalten aus aber ALLE Zeilen}
\FunctionTok{head}\NormalTok{(mtcars[ ,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{], }\DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\#                    mpg cyl}
\DocumentationTok{\#\# Mazda RX4         21.0   6}
\DocumentationTok{\#\# Mazda RX4 Wag     21.0   6}
\DocumentationTok{\#\# Datsun 710        22.8   4}
\DocumentationTok{\#\# Hornet 4 Drive    21.4   6}
\DocumentationTok{\#\# Hornet Sportabout 18.7   8}
\end{Highlighting}
\end{Shaded}

Der Abschnitt vor dem \texttt{,} bezieht sich also auf die \emph{Zeilen} und danach auf die \emph{Spalten}.

Mit \texttt{subset()} kann man noch spezifischer auf den Inhalt eines dataframes zugreifen und auch mit logischen Operatoren arbeiten. Es ist eine der wichtigsten Funktionen um auf Daten zur√ºckzugreifen.

\begin{longtable}[]{@{}ll@{}}
\toprule
Argument & Beschreibung \\
\midrule
\endhead
\texttt{x} & Name des dataframes \\
\texttt{subset} & Ein logischer Vektor der Werte die man behalten m√∂chte \\
\texttt{select} & Die Spalten die man behalten m√∂chte \\
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# W√§hle nur Autos mit mehr als 5 Zylinder aus}
\FunctionTok{head}\NormalTok{(}\FunctionTok{subset}\NormalTok{(mtcars,}
       \AttributeTok{subset =}\NormalTok{ cyl }\SpecialCharTok{\textgreater{}} \DecValTok{5}\NormalTok{), }\DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\#                    mpg cyl disp  hp drat    wt  qsec vs am gear carb}
\DocumentationTok{\#\# Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4}
\DocumentationTok{\#\# Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4}
\DocumentationTok{\#\# Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1}
\DocumentationTok{\#\# Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2}
\DocumentationTok{\#\# Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1}
\CommentTok{\# W√§hle nur Autos mit mehr als 5 Zylinder \& \textgreater{} 100 PS aus}
\FunctionTok{head}\NormalTok{(}\FunctionTok{subset}\NormalTok{(mtcars,}
       \AttributeTok{subset =}\NormalTok{ cyl }\SpecialCharTok{\textgreater{}} \DecValTok{5} \SpecialCharTok{\&}
\NormalTok{                hp }\SpecialCharTok{\textgreater{}} \DecValTok{100}\NormalTok{), }\DecValTok{5}\NormalTok{) }
\DocumentationTok{\#\#                    mpg cyl disp  hp drat    wt  qsec vs am gear carb}
\DocumentationTok{\#\# Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4}
\DocumentationTok{\#\# Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4}
\DocumentationTok{\#\# Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1}
\DocumentationTok{\#\# Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2}
\DocumentationTok{\#\# Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1}
\CommentTok{\# W√§hle nur Autos mit mehr als 5 Zylinder \& \textgreater{} 100 PS aus \& dabei weniger als 15 Meilen pro Gallone fahren}
\FunctionTok{head}\NormalTok{(}\FunctionTok{subset}\NormalTok{(mtcars,}
       \AttributeTok{subset =}\NormalTok{ cyl }\SpecialCharTok{\textgreater{}} \DecValTok{5} \SpecialCharTok{\&}
\NormalTok{                hp }\SpecialCharTok{\textgreater{}} \DecValTok{100} \SpecialCharTok{\&}
\NormalTok{                mpg }\SpecialCharTok{\textless{}} \DecValTok{15}\NormalTok{), }\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\#                      mpg cyl disp  hp drat    wt  qsec vs am gear carb}
\DocumentationTok{\#\# Duster 360          14.3   8  360 245 3.21 3.570 15.84  0  0    3    4}
\DocumentationTok{\#\# Cadillac Fleetwood  10.4   8  472 205 2.93 5.250 17.98  0  0    3    4}
\DocumentationTok{\#\# Lincoln Continental 10.4   8  460 215 3.00 5.424 17.82  0  0    3    4}
\DocumentationTok{\#\# Chrysler Imperial   14.7   8  440 230 3.23 5.345 17.42  0  0    3    4}
\DocumentationTok{\#\# Camaro Z28          13.3   8  350 245 3.73 3.840 15.41  0  0    3    4}
\end{Highlighting}
\end{Shaded}

Wenn ihr also mit richtigen (unter heutigen Gesichtspunkten) Drecksschleudern rumfahren wollt, dann habt ihr durch logisches Filtern eine gute Auswahl getroffen. Diese f√ºnf Autos erf√ºllen unsere drei gesetzten Kriterien.

Hier findet ihr eine Auflistung der logischen Operatoren in R:

\begin{longtable}[]{@{}ll@{}}
\toprule
Logischer Operator & Bedeutung \\
\midrule
\endhead
\texttt{==} & Gleich \\
\texttt{!=} & Nicht gleich \\
\texttt{\textless{}} & Kleiner als \\
\texttt{\textless{}=} & Kleiner als oder gleich \\
\texttt{\textgreater{}} & Gr√∂√üer als \\
\texttt{\textgreater{}=} & Gr√∂√üer als oder gleich \\
\texttt{\textbar{}} & Oder \\
\texttt{!} & Nicht \\
\texttt{\%in\%} & Durchsuche in \\
\bottomrule
\end{longtable}

Mit der Hilfe von \texttt{\&} (\textbf{UND}), \texttt{\textbar{}} (\textbf{ODER}), \texttt{\%in\%} (\textbf{VIELE ODER ARGUMENTE}) k√∂nnen Abfragen wie \texttt{\textgreater{}} oder \texttt{\textless{}} erg√§nzt werden.

\hypertarget{erstellen-von-eigenen-funktionen}{%
\subsection{Erstellen von eigenen Funktionen}\label{erstellen-von-eigenen-funktionen}}

Wie wir einzelne Funktionen (bspw. \texttt{mean()} und \texttt{sd()}) anwenden haben wir bereits gelernt. Wir k√∂nnen aber auch selber eine Anwendung oder Funktion schreiben, in der mehrere Funktionen geb√ºndelt sind. Viele Schritte in der Datenaufbereitung und Analyse wiederholen sich st√§ndig. Daher ist es sinnvoll bestimmte Schritte zu ``automatisieren''. Wollen wir zum Beispiel statistische Werte zum \texttt{mtcars} Datensatz haben, so k√∂nnen wir jeden Wert einzeln abfragen mit

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp) }\CommentTok{\# Anzahl der Werte}
\DocumentationTok{\#\# [1] 32}
\FunctionTok{mean}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp) }\CommentTok{\# Arithmetisches Mittel}
\DocumentationTok{\#\# [1] 146.6875}
\FunctionTok{sd}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp) }\CommentTok{\# Standardabweichung}
\DocumentationTok{\#\# [1] 68.56287}
\FunctionTok{min}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp) }\CommentTok{\# Minimum}
\DocumentationTok{\#\# [1] 52}
\FunctionTok{max}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp) }\CommentTok{\# Maximum}
\DocumentationTok{\#\# [1] 335}
\FunctionTok{median}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp) }\CommentTok{\# Median}
\DocumentationTok{\#\# [1] 123}
\end{Highlighting}
\end{Shaded}

Eine M√∂glichkeit wiederholte Abfragen zu erm√∂glichen ist das Ablegen in einen einzelnen Vektor:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mtcars\_hp\_descriptives }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \AttributeTok{n =} \FunctionTok{length}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp),}
  \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp),}
  \AttributeTok{sd =} \FunctionTok{sd}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp),}
  \AttributeTok{min =} \FunctionTok{min}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp),}
  \AttributeTok{max =} \FunctionTok{max}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp),}
  \AttributeTok{median =} \FunctionTok{median}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{hp)}
\NormalTok{)}

\NormalTok{mtcars\_hp\_descriptives}
\DocumentationTok{\#\#         n      mean        sd       min       max    median }
\DocumentationTok{\#\#  32.00000 146.68750  68.56287  52.00000 335.00000 123.00000}
\end{Highlighting}
\end{Shaded}

Et voila üéâ Eingabe des Objektes \texttt{mtcars\_hp\_descriptives} erm√∂glicht es uns die statistischen Kennwerte direkt auszugeben. Im \texttt{mtcars} Datensatz gibt es aber noch weitere Kenndaten. Wie k√∂nnen wir den code so anpassen, dass wir nicht jedes mal alles wieder neu abtippen m√ºssen. Es w√§re doch zu sch√∂n wenn so etwas in R m√∂glich ist. Zwei Argumente warum ihr euch bei diesen Schritten gut √ºberlegen solltet eine Funktion zu schreiben:

\begin{itemize}
\tightlist
\item
  Anstatt mehrerer Codezeilen ist in Zukunft f√ºr dasselbe Ergebnis eine Codezeile -- der Funktionsaufruf -- erforderlich.
\item
  Der Code bzw. euer Skript wird weniger redundant und √ºbersichtlicher
\item
  Fehlerkorrekturen und Anpassungen werden vereinfacht, da ihr nur die Funktion √§ndern m√ºsst und nicht jedes mal die Stellen wo die Funktion auftritt.
\end{itemize}

Funktionen in R sind Objekte und werden ebenfalls mit dem \texttt{\textless{}-} zugewiesen. Das Schema ist dabei immer das folgende mit drei zentralen Komponenten:

\begin{itemize}
\tightlist
\item
  Funktionsargumente, wie bei unseren bisherigen Funktionen auch (bspw. \texttt{na.rm\ =\ TRUE})
\item
  Body der Funktion, welcher den Code zum Ausf√ºhren enth√§lt
\item
  environment, beinhaltet die Datenstruktur damit die Funktion einen Wert mit dem Namen assoziieren kann
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{funktionsname }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(argument\_1, argument\_2) \{}
  \CommentTok{\# Body: Code, der ausgef√ºhrt wird}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Mit der Funktion \texttt{function()} weisen wir einem Objektnamen ein Funktionsobjekt zu. Um den Code auf eine andere Variable anzuwenden, m√ºssten wir jeweils \texttt{mtcars\$hp} ersetzen -- z. B. durch \texttt{mtcars\$cyl} oder eine Variable aus einem anderen Datensatz. Wir m√∂chten diesen Teil also durch einen Platzhalter ersetzen, den wir dann als Funktionsargument √ºbergeben k√∂nnen. Mit einem generischen Platzhalter, den wir der Einfachheit halber als x bezeichnen, s√§he der Code also wie folgt aus:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{descriptives }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{ }\CommentTok{\# Wir definieren \textquotesingle{}x\textquotesingle{} als Argument}
\NormalTok{  descriptives\_vector }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
    \AttributeTok{n =} \FunctionTok{length}\NormalTok{(x),}
    \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(x),}
    \AttributeTok{sd =} \FunctionTok{sd}\NormalTok{(x),}
    \AttributeTok{min =} \FunctionTok{min}\NormalTok{(x),}
    \AttributeTok{max =} \FunctionTok{max}\NormalTok{(x),}
    \AttributeTok{median =} \FunctionTok{median}\NormalTok{(x)}
\NormalTok{  )}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Die Funktionsargumente werden in eine runde Klammer geschrieben \texttt{()} und der body in eine eckige \texttt{{[}{]}}. Unter \textbf{Environment} taucht unsere Funktion \texttt{descriptives} nun bei der Rubrik Funktionen auf und kann im Folgenden eingesetzt werden.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{descriptives}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{disp)}
\end{Highlighting}
\end{Shaded}

Komisch das uns die Werte noch nicht angezeigt werden. Dies liegt daran, dass wir abschlie√üend noch definieren m√ºssen, was die Funktion mit der Anfrage durchf√ºhren soll. Vereinfacht gesagt, die Werte sollen angezeigt werden.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{descriptives }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{ }\CommentTok{\# Wir definieren \textquotesingle{}x\textquotesingle{} als Argument}
\NormalTok{  descriptives\_vector }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
    \AttributeTok{n =} \FunctionTok{length}\NormalTok{(x),}
    \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(x),}
    \AttributeTok{sd =} \FunctionTok{sd}\NormalTok{(x),}
    \AttributeTok{min =} \FunctionTok{min}\NormalTok{(x),}
    \AttributeTok{max =} \FunctionTok{max}\NormalTok{(x),}
    \AttributeTok{median =} \FunctionTok{median}\NormalTok{(x)}
\NormalTok{  )}
  \FunctionTok{return}\NormalTok{(descriptives\_vector) }\CommentTok{\# oder nur descriptives\_vector}
\NormalTok{\}}

\FunctionTok{descriptives}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{cyl)  }\CommentTok{\# Zusammenfassung der Zylinder}
\DocumentationTok{\#\#         n      mean        sd       min       max    median }
\DocumentationTok{\#\# 32.000000  6.187500  1.785922  4.000000  8.000000  6.000000}
\FunctionTok{descriptives}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{mpg)  }\CommentTok{\# Zusammenfassung des Verbrauchs}
\DocumentationTok{\#\#         n      mean        sd       min       max    median }
\DocumentationTok{\#\# 32.000000 20.090625  6.026948 10.400000 33.900000 19.200000}
\FunctionTok{descriptives}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{gear) }\CommentTok{\# Zusammenfassung Anzahl der G√§nge}
\DocumentationTok{\#\#          n       mean         sd        min        max     median }
\DocumentationTok{\#\# 32.0000000  3.6875000  0.7378041  3.0000000  5.0000000  4.0000000}
\end{Highlighting}
\end{Shaded}

Falls wir jedoch fehlende Werte \texttt{NA}s in unserem Datensatz haben m√ºssen wir die Funktion anpassen, da dies in den Funktionsargumenten momentan noch fehlt.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{descriptives }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) \{ }\CommentTok{\# Default{-}Wert f√ºr \textquotesingle{}na.rm\textquotesingle{} = TRUE}
\NormalTok{  descriptives\_vector }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
    \AttributeTok{n =} \FunctionTok{length}\NormalTok{(x),}
    \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(x, }\AttributeTok{na.rm =}\NormalTok{ na.rm), }
    \AttributeTok{sd =} \FunctionTok{sd}\NormalTok{(x, }\AttributeTok{na.rm =}\NormalTok{ na.rm),     }
    \AttributeTok{min =} \FunctionTok{min}\NormalTok{(x, }\AttributeTok{na.rm =}\NormalTok{ na.rm),   }
    \AttributeTok{max =} \FunctionTok{max}\NormalTok{(x, }\AttributeTok{na.rm =}\NormalTok{ na.rm),}
    \AttributeTok{median =} \FunctionTok{median}\NormalTok{(x, }\AttributeTok{na.rm =}\NormalTok{ na.rm)}
\NormalTok{  )}
  \FunctionTok{return}\NormalTok{(descriptives\_vector)}
\NormalTok{\}}

\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{12}\NormalTok{,}\DecValTok{4}\NormalTok{,}\ConstantTok{NA}\NormalTok{)}
\FunctionTok{descriptives}\NormalTok{(a)}
\DocumentationTok{\#\#         n      mean        sd       min       max    median }
\DocumentationTok{\#\#  5.000000  6.250000  4.031129  3.000000 12.000000  5.000000}
\end{Highlighting}
\end{Shaded}

üí° Anstelle von \texttt{TRUE} oder \texttt{FALSE} erkennt R auch ein einfaches \texttt{T} oder \texttt{F}.

Viele Funktionen haben \texttt{default} als vordefinierte Argumente. Diese k√∂nnten wir auch in unserer Funktion erg√§nzen indem wir na.rm \texttt{=} setzen:

Dieser Default-Wert wird nun also immer verwendet, wenn wir das Argument nicht angegeben haben. Unsere Funktion ist somit noch flexibler geworden.

\hypertarget{speziellere-anwendungen-von-funktionen}{%
\subsubsection{Speziellere Anwendungen von Funktionen}\label{speziellere-anwendungen-von-funktionen}}

Lasst uns diese Kenntnisse erweitern und unsere Daten mit Statistikparametern plotten:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{spezialplot }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(}\AttributeTok{x =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{),}
                        \AttributeTok{y =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{),}
                        \AttributeTok{add.mean =} \ConstantTok{FALSE}\NormalTok{,}
                        \AttributeTok{add.regression =} \ConstantTok{FALSE}\NormalTok{,}
                        \AttributeTok{p.threshold =}\NormalTok{ .}\DecValTok{05}\NormalTok{,}
                        \AttributeTok{add.modeltext =} \ConstantTok{FALSE}\NormalTok{,}
\NormalTok{                        ...  }\CommentTok{\# Weitere Argumente die erg√§nzt werden sollen}
\NormalTok{                           ) \{}
\CommentTok{\# Erstelle den Plot}
\CommentTok{\# und setze ggf. weitere Argumente wie \textasciigrave{}main\textasciigrave{} f√ºr Titel}
  \FunctionTok{plot}\NormalTok{(x, y, ...)}

\CommentTok{\# Erstelle Referenzlinie vom Mittelwert wenn add.mean = TRUE}
\ControlFlowTok{if}\NormalTok{(add.mean }\SpecialCharTok{==} \ConstantTok{TRUE}\NormalTok{) \{}

  \FunctionTok{abline}\NormalTok{(}\AttributeTok{h =} \FunctionTok{mean}\NormalTok{(y), }\AttributeTok{lty =} \DecValTok{2}\NormalTok{)}
  \FunctionTok{abline}\NormalTok{(}\AttributeTok{v =} \FunctionTok{mean}\NormalTok{(x), }\AttributeTok{lty =} \DecValTok{2}\NormalTok{)}
\NormalTok{\}}

\CommentTok{\# Erstelle Regressionlinie wenn add.regression = TRUE}
\ControlFlowTok{if}\NormalTok{(add.regression }\SpecialCharTok{==} \ConstantTok{TRUE}\NormalTok{) \{}

\NormalTok{  model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x) }\CommentTok{\# Erstelle Regression mit \textasciigrave{}lm\textasciigrave{} linear model}

\NormalTok{  p.value }\OtherTok{\textless{}{-}} \FunctionTok{anova}\NormalTok{(model)}\SpecialCharTok{$}\StringTok{"Pr(\textgreater{}F)"}\NormalTok{[}\DecValTok{1}\NormalTok{] }\CommentTok{\# Ziehe den p Wert aus dem Objekt p.value}

  \CommentTok{\# Definiere die Farbe in Abh√§ngigkeit von p.value und p.threshold}
  \ControlFlowTok{if}\NormalTok{(p.value }\SpecialCharTok{\textless{}}\NormalTok{ p.threshold) \{line.col }\OtherTok{\textless{}{-}} \StringTok{"red"}\NormalTok{\}}
  \ControlFlowTok{if}\NormalTok{(p.value }\SpecialCharTok{\textgreater{}=}\NormalTok{ p.threshold) \{line.col }\OtherTok{\textless{}{-}} \StringTok{"black"}\NormalTok{\}}

  \FunctionTok{abline}\NormalTok{(}\FunctionTok{lm}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x), }\AttributeTok{col =}\NormalTok{ line.col, }\AttributeTok{lwd =} \DecValTok{2}\NormalTok{) }\CommentTok{\# F√ºge die Regressionlinie hinzu}

\NormalTok{\}}

  \CommentTok{\# Add regression equation text if add.modeltext is TRUE}
\ControlFlowTok{if}\NormalTok{(add.modeltext }\SpecialCharTok{==} \ConstantTok{TRUE}\NormalTok{) \{}

  \CommentTok{\# Erstelle Regressionsdaten}
\NormalTok{  model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x)}

  \CommentTok{\# Extrahiere die Koeffizienten vom Objekt \textasciigrave{}model\textasciigrave{}}
\NormalTok{  coefficients }\OtherTok{\textless{}{-}}\NormalTok{ model}\SpecialCharTok{$}\NormalTok{coefficients}
\NormalTok{  a }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(coefficients[}\DecValTok{1}\NormalTok{], }\DecValTok{2}\NormalTok{)}
\NormalTok{  b }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(coefficients[}\DecValTok{2}\NormalTok{], }\DecValTok{2}\NormalTok{)}

  \CommentTok{\# Create text}
\NormalTok{  model.text }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"Regression Equation: "}\NormalTok{, a, }\StringTok{" + "}\NormalTok{, b, }\StringTok{" * x"}\NormalTok{, }\AttributeTok{sep =} \StringTok{""}\NormalTok{)}

  \CommentTok{\# Add text to top of plot}
  \FunctionTok{mtext}\NormalTok{(model.text, }\AttributeTok{side =} \DecValTok{3}\NormalTok{, }\AttributeTok{line =}\NormalTok{ .}\DecValTok{5}\NormalTok{, }\AttributeTok{cex =}\NormalTok{ .}\DecValTok{8}\NormalTok{)}

\NormalTok{\}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Jetzt k√∂nnen wir in unsere Beispielfunktion Daten einsetzen aus dem \texttt{mtcars} Datensatz:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{spezialplot}\NormalTok{(}\AttributeTok{x =}\NormalTok{ mtcars}\SpecialCharTok{$}\NormalTok{mpg, }
            \AttributeTok{y =}\NormalTok{ mtcars}\SpecialCharTok{$}\NormalTok{hp)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-101-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Das sieht danach aus, dass der Verbrauch gr√∂√üer ist je mehr PS das Auto hat}
\CommentTok{\# Wir k√∂nnen das √úberpr√ºfen indem wir die zus√§tzlichen Argumente in unserer Funktion setzen}
\FunctionTok{spezialplot}\NormalTok{(}\AttributeTok{x =}\NormalTok{ mtcars}\SpecialCharTok{$}\NormalTok{mpg, }
            \AttributeTok{y =}\NormalTok{ mtcars}\SpecialCharTok{$}\NormalTok{hp, }
            \AttributeTok{add.mean =} \ConstantTok{TRUE}\NormalTok{, }
            \AttributeTok{add.regression =} \ConstantTok{TRUE}\NormalTok{, }
            \AttributeTok{add.modeltext =} \ConstantTok{TRUE}\NormalTok{, }
            \AttributeTok{p.threshold =}\NormalTok{ .}\DecValTok{05}\NormalTok{, }
            \AttributeTok{xlab =} \StringTok{"Miles per gallon"}\NormalTok{,}
            \AttributeTok{ylab =} \StringTok{"Horsepower"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-101-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Und wie schaut das ganze f√ºr Gewicht und Verbrauch aus}
\FunctionTok{spezialplot}\NormalTok{(}\AttributeTok{x =}\NormalTok{ mtcars}\SpecialCharTok{$}\NormalTok{mpg, }
            \AttributeTok{y =}\NormalTok{ mtcars}\SpecialCharTok{$}\NormalTok{wt, }
            \AttributeTok{add.mean =} \ConstantTok{TRUE}\NormalTok{, }
            \AttributeTok{add.regression =} \ConstantTok{TRUE}\NormalTok{, }
            \AttributeTok{add.modeltext =} \ConstantTok{TRUE}\NormalTok{, }
            \AttributeTok{p.threshold =}\NormalTok{ .}\DecValTok{05}\NormalTok{, }
            \AttributeTok{xlab =} \StringTok{"Miles per gallon"}\NormalTok{,}
            \AttributeTok{ylab =} \StringTok{"Weight (1000 lbs)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-101-3} \end{center}

Schnelle Analyse: Je mehr Pferdest√§rken und je gr√∂√üer das Gewicht, desto gr√∂√üer ist auch der Verbrauch des Autos.

üí° Anstelle eine Funktion immer wieder aufs neue zu schreiben empfiehlt es sich ein R Skript anzulegen unter File -\textgreater{} New File -\textgreater{} R script. Hier k√∂nnt ihr eure Funktionen reinschreiben, in eurem Projektordner hinterlegen und mit der Funktion \texttt{source} automatisch in eure aktuelle R session hineinladen. Das spart Platz und beschleunigt eure explorative Datenanlyse erheblich.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Evaluiere den Code in meinem \textasciigrave{}custom\_function\textasciigrave{} script zu Beginn meiner Session}
\FunctionTok{source}\NormalTok{(}\AttributeTok{file =} \StringTok{"custom\_functions.R"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{nutze-...-als-platzhalter}{%
\subsubsection{\texorpdfstring{Nutze \texttt{...} als Platzhalter}{Nutze ... als Platzhalter}}\label{nutze-...-als-platzhalter}}

Wenn man nicht alle Argumente in einer Funktion definieren m√∂chte, sich dieses aber noch f√ºr sp√§ter offen lassen m√∂chte:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{descriptives }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x, ...) \{ }\CommentTok{\# Here is where the additional arguments go}
\NormalTok{  descriptives\_vector }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
    \AttributeTok{n =} \FunctionTok{length}\NormalTok{(x),}
    \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(x, ...), }\CommentTok{\# and here}
    \AttributeTok{sd =} \FunctionTok{sd}\NormalTok{(x, ...),     }
    \AttributeTok{min =} \FunctionTok{min}\NormalTok{(x, ...),   }
    \AttributeTok{max =} \FunctionTok{max}\NormalTok{(x, ...),}
    \AttributeTok{median =} \FunctionTok{median}\NormalTok{(x, ...)}
\NormalTok{  )}
  \FunctionTok{return}\NormalTok{(descriptives\_vector)}
\NormalTok{\}}

\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{12}\NormalTok{,}\DecValTok{4}\NormalTok{,}\ConstantTok{NA}\NormalTok{)}
\FunctionTok{descriptives}\NormalTok{(a, }\AttributeTok{na.rm =}\NormalTok{ T)}
\DocumentationTok{\#\#         n      mean        sd       min       max    median }
\DocumentationTok{\#\#  5.000000  6.250000  4.031129  3.000000 12.000000  5.000000}
\end{Highlighting}
\end{Shaded}

\hypertarget{wie-lese-ich-daten-ein}{%
\section{Wie lese ich Daten ein}\label{wie-lese-ich-daten-ein}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

Wir sind immer noch nicht ganz bei dem Punkt angekommen, was es mit dem Begriff \emph{tidy} auf sich hat. Soviel soll aber gesagt sein: Daten in der ``freien Laufbahn'' sind immer \textbf{dreckig} und NICHT \textbf{tidy}.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/001} 

}

\caption{Schema der Datenanalyse in R}\label{fig:unnamed-chunk-105}
\end{figure}

Anwenden l√§sst sich das Paretoprinzip auf dieses Schema.

\begin{quote}
Bei der Datenanalyse werden 80\% der Ergebnisse mit 20\% des Aufwandes erreicht, die verbleibenden 20\% mit 80\% des Aufwandes.
\end{quote}

In der Datenanylse wird sehr viel Zeit zu Beginn verwendet

\begin{itemize}
\tightlist
\item
  Daten zu erheben
\item
  zu finden
\item
  zu importieren
\item
  zu s√§ubern
\item
  zu transformieren
\item
  zu modifizieren
\item
  zu analysieren
\end{itemize}

Die echte Analyse der Daten ist dann verh√§ltnism√§√üig schnell erledigt.

\hypertarget{tidy-data}{%
\subsection{Tidy data}\label{tidy-data}}

Daten in Tabellen k√∂nnen auf eine Vielzahl strukturiert und angezeigt werden. Das Konzept von \textbf{tidy data} is fundamental f√ºr das Arbeiten und die Visualisierung in R. Weiterhin sind konsistent aufbereitete Daten leichter zu lesen, zu verarbeiten, zu laden und zu speichern.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/021} 

}

\caption{Konzept tidy data [R for Data Science](https://r4ds.had.co.nz/tidy-data.html)}\label{fig:unnamed-chunk-106}
\end{figure}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Jede \emph{Variable} hat eine eigene Spalte
\item
  Jede \emph{Beobachtung} steht in einer eigenen Zeile
\item
  Jeder \emph{Wert} steht in einer eigenen Zelle
\end{enumerate}

\hypertarget{dateiformate}{%
\subsection{Dateiformate}\label{dateiformate}}

Es gibt eine Vielzahl von Dateiformaten, um nur wenige zu nennen: \texttt{.xls}, \texttt{.xlsx}, \texttt{.sav}, \texttt{.csv}, \texttt{.txt} \ldots{}
Bei Dateien mit der Endung .xlsx von Microsoft oder .sav von SPSS handelt es sich um \emph{propriet√§re} Dateien, welche im Eigentum von Unternehmen stehen. Der Austausch zwischen diesen Formaten ist h√§ufig problematisch, da Formatierungen verloren gehen k√∂nnen und eben nur spezfisch f√ºr das Dateiformat ist. Ein \emph{offenes} und weit verbreitetes Format sind \texttt{.csv} Dateien f√ºr comma-separated-values.

üö® Im deutschsprachigen Raum wird auch \texttt{;} als Trennzeichen verwendet.

\begin{figure}

{\centering \includegraphics[width=0.25\linewidth]{images/022} \includegraphics[width=0.25\linewidth]{images/023} \includegraphics[width=0.25\linewidth]{images/024} \includegraphics[width=0.25\linewidth]{images/025} \includegraphics[width=0.25\linewidth]{images/026} \includegraphics[width=0.25\linewidth]{images/027} \includegraphics[width=0.25\linewidth]{images/028} \includegraphics[width=0.25\linewidth]{images/029} 

}

\caption{Tidyverse Logos}\label{fig:unnamed-chunk-107}
\end{figure}

Das Herzst√ºck des tidyverse sind die packages mit dem dazugeh√∂rigen Namen im Logo. Es hat sich mit Bezug zum Datenhandling durchgesetzt. Das Designprinzip in den jeweiligen packages baut dabei aufeinander auf.

\begin{quote}
The tidyverse is an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures.
\end{quote}

\begin{longtable}[]{@{}ll@{}}
\toprule
Package & Beschreibung \\
\midrule
\endhead
ggplot2 & Erstellen von Abbildungen basierend auf der \emph{Grammar of Graphics} \\
dyplr & Stellt Funktionen bereit um Daten zu manipulieren, bspw. \texttt{filter()} \\
tidyr & Funktionen um \emph{tidy data} zu erzeugen, bspw. \texttt{pivot\_longer()} \\
readr & Schnelle und effiziente Art Daten einzulesen und zu transformieren \\
tibble & Eine effektivere Darstellung eines dataframe \\
stringr & Vereinfacht das Arbeiten mit Textobjekten \\
forcats & Vereinfacht das Arbeiten mit Faktoren, bspw. \texttt{relevel()} \\
\bottomrule
\end{longtable}

Alle packages k√∂nnen automatisch heruntergeladen werden mit dem folgenden Befehl:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{) }\CommentTok{\# Muss man nur einmal durchf√ºhren}
\FunctionTok{library}\NormalTok{(tidyverse)            }\CommentTok{\# Muss jedes mal wieder neu "angeschaltet" werden}
\end{Highlighting}
\end{Shaded}

\hypertarget{readrread_delim}{%
\subsection{readr::read\_delim()}\label{readrread_delim}}

Nun wollen wir lernen, einen gro√üen Datensatz einzulesen. Dazu verwenden wir die Daten aus dem Speicherkoog. Es handelt sich um eine .csv Datei, die entweder mit der Funktion

\begin{itemize}
\tightlist
\item
  \texttt{read\_csv()} (liest CSV-Dateien, die ein Komma \texttt{,} als Spalten- und einen Punkt \texttt{.} als Dezimaltrennzeichen verwenden)
\item
  \texttt{read\_csv2()} (liest CSV-Dateien, die ein Semikolon \texttt{;} als Spalten- und das Komma \texttt{,} als Dezimaltrennzeichen verwenden)
\end{itemize}

eingelesen werden k√∂nnen. Dazu geben wir den Dateipfad relativ zu unserem Arbeitsverzeichnis an. Ich habe bspw. meine Daten zum einlesen in einem Unterordner \texttt{data}. Von der Datei selber wird der Pfad durch \texttt{/} getrennt angegeben.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Laden der Daten mit der Funktion read\_csv}
\NormalTok{koog\_raw }\OtherTok{\textless{}{-}}\NormalTok{ readr}\SpecialCharTok{::}\FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data/data.csv"}\NormalTok{)}
\NormalTok{koog\_raw}
\DocumentationTok{\#\# \# A tibble: 94,537 x 1}
\DocumentationTok{\#\#    \textasciigrave{}time;date;ST10;MP10;ST20;MP20;ST30;MP30;ST60;MP60;ST100;MP100;ST150;MP150;E\textasciitilde{}}
\DocumentationTok{\#\#    \textless{}chr\textgreater{}                                                                        }
\DocumentationTok{\#\#  1 1;01.04.2010 00:00;7.42;0;7.28;0;6.98;0;6.13;0;5.55;0;5.44;0;449.27;439.59;4\textasciitilde{}}
\DocumentationTok{\#\#  2 2;01.04.2010 01:00;7.21;0;7.24;0;6.99;0;6.12;0;5.6;0;5.42;0;450.75;439.89;43\textasciitilde{}}
\DocumentationTok{\#\#  3 3;01.04.2010 02:00;7.01;0;7.14;0;6.94;0;6.13;0;5.59;0;5.41;0;452.22;440.21;4\textasciitilde{}}
\DocumentationTok{\#\#  4 4;01.04.2010 03:00;6.91;0;7.12;0;6.88;0;6.17;0;5.63;0;5.44;0;452.95;440.31;4\textasciitilde{}}
\DocumentationTok{\#\#  5 5;01.04.2010 04:00;6.81;0;7.12;0;6.9;0;6.17;0;5.58;0;5.47;0;453.46;440.66;43\textasciitilde{}}
\DocumentationTok{\#\#  6 6;01.04.2010 05:00;6.73;0;6.96;0;6.89;0;6.15;0;5.6;0;5.45;0;453.62;440.9;436\textasciitilde{}}
\DocumentationTok{\#\#  7 7;01.04.2010 06:00;6.66;0;6.96;0;6.91;0;6.16;0;5.64;0;5.43;0;453.62;441.04;4\textasciitilde{}}
\DocumentationTok{\#\#  8 8;01.04.2010 07:00;6.59;0;6.9;0;6.85;0;6.19;0;5.65;0;5.44;0;453.64;441.16;43\textasciitilde{}}
\DocumentationTok{\#\#  9 9;01.04.2010 08:00;6.51;0;6.92;0;6.85;0;6.17;0;5.61;0;5.45;0;453.46;441.12;4\textasciitilde{}}
\DocumentationTok{\#\# 10 10;01.04.2010 09:00;6.54;0;6.82;0;6.81;0;6.2;0;5.65;0;5.45;0;453.54;441.33;4\textasciitilde{}}
\DocumentationTok{\#\# \# ... with 94,527 more rows}
\end{Highlighting}
\end{Shaded}

Ui, hier ist aber etwas schief gelaufen. Wir haben die Datei erfolgreich in unserer Arbeitsumgebung laden k√∂nnen aber 94537 observations bei nur einer Variable?! Schaut euch den Datensatz \texttt{koog\_raw} mal genauer an, indem ihr auf das Symbol (rot umrandet) klickt:

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/031} 

}

\caption{Environment}\label{fig:unnamed-chunk-110}
\end{figure}

Richtig, wir haben vergessen den Zahlenseparator richtig zu setzen. read\_csv() und read\_csv2 sind Spezialformen der Funktion \texttt{read\_delim()}. Zuk√ºnftig werden wir \texttt{read\_delim()} verwenden wenn nicht klar ist, wie die Trennzeichen in unseren Rohdaten hinterlegt sind. Bei uns ist es ein \texttt{;} und kein \texttt{,}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_raw }\OtherTok{\textless{}{-}}\NormalTok{ readr}\SpecialCharTok{::}\FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/data.csv"}\NormalTok{, }\AttributeTok{delim =} \StringTok{";"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

üí° Wenn ihr in der Klammer von read\_delim() den Tab dr√ºckt (siehe unten) dann bekommt ihr einen Vorschlag, welche Argumente in der Funktion belegt werden k√∂nnen.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/030} 

}

\caption{Tab Taste}\label{fig:unnamed-chunk-112}
\end{figure}

Schauen wir uns den Datensatz \texttt{koog\_raw} etwas genauer an.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(koog\_raw, }\AttributeTok{n =} \DecValTok{10}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 10 x 55}
\DocumentationTok{\#\#     time date   ST10  MP10  ST20  MP20  ST30  MP30  ST60  MP60 ST100 MP100 ST150}
\DocumentationTok{\#\#    \textless{}dbl\textgreater{} \textless{}chr\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\#  1     1 01.0\textasciitilde{}  7.42     0  7.28     0  6.98     0  6.13     0  5.55     0  5.44}
\DocumentationTok{\#\#  2     2 01.0\textasciitilde{}  7.21     0  7.24     0  6.99     0  6.12     0  5.6      0  5.42}
\DocumentationTok{\#\#  3     3 01.0\textasciitilde{}  7.01     0  7.14     0  6.94     0  6.13     0  5.59     0  5.41}
\DocumentationTok{\#\#  4     4 01.0\textasciitilde{}  6.91     0  7.12     0  6.88     0  6.17     0  5.63     0  5.44}
\DocumentationTok{\#\#  5     5 01.0\textasciitilde{}  6.81     0  7.12     0  6.9      0  6.17     0  5.58     0  5.47}
\DocumentationTok{\#\#  6     6 01.0\textasciitilde{}  6.73     0  6.96     0  6.89     0  6.15     0  5.6      0  5.45}
\DocumentationTok{\#\#  7     7 01.0\textasciitilde{}  6.66     0  6.96     0  6.91     0  6.16     0  5.64     0  5.43}
\DocumentationTok{\#\#  8     8 01.0\textasciitilde{}  6.59     0  6.9      0  6.85     0  6.19     0  5.65     0  5.44}
\DocumentationTok{\#\#  9     9 01.0\textasciitilde{}  6.51     0  6.92     0  6.85     0  6.17     0  5.61     0  5.45}
\DocumentationTok{\#\# 10    10 01.0\textasciitilde{}  6.54     0  6.82     0  6.81     0  6.2      0  5.65     0  5.45}
\DocumentationTok{\#\# \# ... with 42 more variables: MP150 \textless{}dbl\textgreater{}, EH10a \textless{}dbl\textgreater{}, EH10b \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   EH10c \textless{}dbl\textgreater{}, EH20a \textless{}dbl\textgreater{}, EH20b \textless{}dbl\textgreater{}, EH20c \textless{}dbl\textgreater{}, EH30a \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   EH30b \textless{}dbl\textgreater{}, EH30c \textless{}dbl\textgreater{}, EH60a \textless{}dbl\textgreater{}, EH60b \textless{}dbl\textgreater{}, EH60c \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   EH100a \textless{}dbl\textgreater{}, EH100b \textless{}dbl\textgreater{}, EH100c \textless{}dbl\textgreater{}, EH150a \textless{}dbl\textgreater{}, EH150b \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   EH150c \textless{}dbl\textgreater{}, WD \textless{}dbl\textgreater{}, WS \textless{}dbl\textgreater{}, AT \textless{}dbl\textgreater{}, RH \textless{}dbl\textgreater{}, AP \textless{}dbl\textgreater{}, pp \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   SR \textless{}dbl\textgreater{}, wt \textless{}dbl\textgreater{}, EC \textless{}dbl\textgreater{}, BAT \textless{}dbl\textgreater{}, LT \textless{}dbl\textgreater{}, ...44 \textless{}lgl\textgreater{}, PP \textless{}chr\textgreater{},}
\DocumentationTok{\#\# \#   WT \textless{}dbl\textgreater{}, OXY10 \textless{}dbl\textgreater{}, OXY20 \textless{}dbl\textgreater{}, OXY30 \textless{}dbl\textgreater{}, OXY60 \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

Wir haben ja bereits gesagt, dass es praktischer ist ausschlie√ülich die Spalten mit Kleinbuchstaben (\emph{snake\_case}) zu belegen. Es gibt eine einfache Funktion mit \texttt{janitor::clean\_names()}, welche automatisch die Spalten koh√§rent umcodiert und individuell vergibt:

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/034} 

}

\caption{Illustration von @allison_horst: https://twitter.com/allison_horst}\label{fig:unnamed-chunk-114}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_raw }\OtherTok{\textless{}{-}}\NormalTok{ janitor}\SpecialCharTok{::}\FunctionTok{clean\_names}\NormalTok{(koog\_raw)}
\FunctionTok{head}\NormalTok{(koog\_raw, }\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 55}
\DocumentationTok{\#\#    time date    st10  mp10  st20  mp20  st30  mp30  st60  mp60 st100 mp100 st150}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{} \textless{}chr\textgreater{}  \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1     1 01.04\textasciitilde{}  7.42     0  7.28     0  6.98     0  6.13     0  5.55     0  5.44}
\DocumentationTok{\#\# 2     2 01.04\textasciitilde{}  7.21     0  7.24     0  6.99     0  6.12     0  5.6      0  5.42}
\DocumentationTok{\#\# 3     3 01.04\textasciitilde{}  7.01     0  7.14     0  6.94     0  6.13     0  5.59     0  5.41}
\DocumentationTok{\#\# 4     4 01.04\textasciitilde{}  6.91     0  7.12     0  6.88     0  6.17     0  5.63     0  5.44}
\DocumentationTok{\#\# 5     5 01.04\textasciitilde{}  6.81     0  7.12     0  6.9      0  6.17     0  5.58     0  5.47}
\DocumentationTok{\#\# \# ... with 42 more variables: mp150 \textless{}dbl\textgreater{}, eh10a \textless{}dbl\textgreater{}, eh10b \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh10c \textless{}dbl\textgreater{}, eh20a \textless{}dbl\textgreater{}, eh20b \textless{}dbl\textgreater{}, eh20c \textless{}dbl\textgreater{}, eh30a \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh30b \textless{}dbl\textgreater{}, eh30c \textless{}dbl\textgreater{}, eh60a \textless{}dbl\textgreater{}, eh60b \textless{}dbl\textgreater{}, eh60c \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh100a \textless{}dbl\textgreater{}, eh100b \textless{}dbl\textgreater{}, eh100c \textless{}dbl\textgreater{}, eh150a \textless{}dbl\textgreater{}, eh150b \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh150c \textless{}dbl\textgreater{}, wd \textless{}dbl\textgreater{}, ws \textless{}dbl\textgreater{}, at \textless{}dbl\textgreater{}, rh \textless{}dbl\textgreater{}, ap \textless{}dbl\textgreater{}, pp \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   sr \textless{}dbl\textgreater{}, wt \textless{}dbl\textgreater{}, ec \textless{}dbl\textgreater{}, bat \textless{}dbl\textgreater{}, lt \textless{}dbl\textgreater{}, x44 \textless{}lgl\textgreater{}, pp\_2 \textless{}chr\textgreater{},}
\DocumentationTok{\#\# \#   wt\_2 \textless{}dbl\textgreater{}, oxy10 \textless{}dbl\textgreater{}, oxy20 \textless{}dbl\textgreater{}, oxy30 \textless{}dbl\textgreater{}, oxy60 \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

Tritt eine Variable 2x auf wie bspw. \texttt{pp}, so wird der zweite \texttt{pp} Eintrag um \texttt{pp\_2} erg√§nzt.

Wof√ºr stehen die einzelnen Spalten also:

\begin{longtable}[]{@{}lll@{}}
\toprule
Spaltenname & Beschreibung & Einheit \\
\midrule
\endhead
time & Zeilennummer der observation (st√ºndliches Messinterval & \\
date & Datum + Zeitangabe der Messung & \\
st10:st150 & Bodentemperatur pro Tiefe (einfache Wiederholung) & ¬∞C \\
mp10:mp150 & Matrixpotenzial pro Tiefe (einfache Wiederholung) & log hPa \\
eh10a:eh150c & Redoxpotentzial pro Tiefe (dreifache Wiederholung) & mV \\
wd & Windrichtung & ¬∞ \\
ws & Windgeschwindigkeit & m s\textsuperscript{-1} \\
at & Lufttemperatur & ¬∞C \\
rh & Relative Luftfeuchte & \% \\
ap & Luftdruck & hPa \\
pp & Niederschlag & mm h\textsuperscript{-1} \\
sr & Solarstrahlung & W m\textsuperscript{-2} \\
wt & Grundwasserflurabstand & cm u GOK \\
ec & Elektrische Leitf√§higkeit & mS cm\textsuperscript{-1} \\
bat & Akkuleistung der Schaltschranks & V \\
lt & Loggertemperatur & ¬∞C \\
oxy10:oxy150 & Sauerstoffgehalt & \%-Lufts√§ttigung \\
\bottomrule
\end{longtable}

\hypertarget{arbeiten-mit-zeiten}{%
\subsection{Arbeiten mit Zeiten}\label{arbeiten-mit-zeiten}}

In der Spalte \texttt{time} stehen die Zeilennummern und unter \texttt{date} finden wir das Datum, allerdings als \texttt{character} hinterlegt. Beim Einlesen der Daten denkt R, dass es sich um Text handelt aber wir wissen es besser. Wir m√ºssen R nun explizit mitteilen wie unser Zeitstempel \texttt{date} codiert ist, n√§mlich mit \texttt{\%Tag.\%Monat.\%Jahr\ \%Stunde:\%Minute}. In R wird ein Datum jedoch mit 2021-08-26 22:16:17 angegeben. Wir tun also folgendes:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_raw }\OtherTok{\textless{}{-}}\NormalTok{ readr}\SpecialCharTok{::}\FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/data.csv"}\NormalTok{, }\AttributeTok{delim =} \StringTok{";"}\NormalTok{, }
                          \AttributeTok{col\_types =}\NormalTok{ readr}\SpecialCharTok{::}\FunctionTok{cols}\NormalTok{(}
                            \CommentTok{\# date = √ºberschreibt die Spalte mit der neuen Spezifikation}
                            \AttributeTok{date =}\NormalTok{ readr}\SpecialCharTok{::}\FunctionTok{col\_datetime}\NormalTok{(}\AttributeTok{format =} \StringTok{"\%d.\%m.\%Y \%H:\%M"}\NormalTok{) }
\NormalTok{  ))}
\FunctionTok{head}\NormalTok{(koog\_raw, }\AttributeTok{n =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\DocumentationTok{\#\# \# A tibble: 5 x 2}
\DocumentationTok{\#\#    time date               }
\DocumentationTok{\#\#   \textless{}dbl\textgreater{} \textless{}dttm\textgreater{}             }
\DocumentationTok{\#\# 1     1 2010{-}04{-}01 00:00:00}
\DocumentationTok{\#\# 2     2 2010{-}04{-}01 01:00:00}
\DocumentationTok{\#\# 3     3 2010{-}04{-}01 02:00:00}
\DocumentationTok{\#\# 4     4 2010{-}04{-}01 03:00:00}
\DocumentationTok{\#\# 5     5 2010{-}04{-}01 04:00:00}
\end{Highlighting}
\end{Shaded}

Super\ldots nun haben wir ein sogenanntes \texttt{POSIXct} Objekt. Dies ist eine Datum+Zeitangabe in R und l√§sst sich mit einfachen Funktionen in eine andere Darstellungsform codieren. Welche M√∂glichkeiten es gibt Zeiten zu codieren k√∂nnt ihr unter \texttt{?strptime} nachlesen. Die g√§ngisten K√ºrzel findet ihr aber hier aufgelistet:

\begin{itemize}
\tightlist
\item
  ``\%'' is used as a separator between dates üö®
\item
  \textbf{\%y} Year without century (00--99).
\item
  \textbf{\%Y} Year with century.
\item
  \textbf{\%m} Month as decimal number (01--12).
\item
  \textbf{\%d} Day of the month as decimal number (01--31).
\item
  \textbf{\%H} Hours as decimal number (00--23).
\item
  \textbf{\%M} Minute as decimal number (00--59).
\item
  \textbf{\%T} Equivalent to \%H:\%M:\%S.
\end{itemize}

üí° Mit der Funktion \texttt{Sys.time()} k√∂nnt ihr euch das aktuell Datum + Uhrzeit anzeigen lassen

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/035} 

}

\caption{Illustration von @allison_horst: https://twitter.com/allison_horst}\label{fig:unnamed-chunk-117}
\end{figure}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/036} 

}

\caption{Illustration von @allison_horst: https://twitter.com/allison_horst}\label{fig:unnamed-chunk-118}
\end{figure}

Aus dem Zeitstempel \texttt{date}k√∂nnen wir mit dem package \texttt{lubridate::} und den Funktionen ganz einfach aus dem \texttt{POSIXct} Objekt das Jahr, Monat, Tag, Stunde, Minute, \ldots{} extrahieren:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Jahr}
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(date) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date =} \FunctionTok{year}\NormalTok{(date)) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# Extrahiere das Jahr mit der Funktion \textasciigrave{}year()\textasciigrave{}}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 1}
\DocumentationTok{\#\#    date}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1  2010}
\DocumentationTok{\#\# 2  2010}
\DocumentationTok{\#\# 3  2010}
\DocumentationTok{\#\# 4  2010}
\DocumentationTok{\#\# 5  2010}
\CommentTok{\# Monat}
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(date) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date =} \FunctionTok{month}\NormalTok{(date)) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# Extrahiere das Jahr mit der Funktion \textasciigrave{}month()\textasciigrave{}}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 1}
\DocumentationTok{\#\#    date}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1     4}
\DocumentationTok{\#\# 2     4}
\DocumentationTok{\#\# 3     4}
\DocumentationTok{\#\# 4     4}
\DocumentationTok{\#\# 5     4}
\end{Highlighting}
\end{Shaded}

\hypertarget{daten-manipulieren}{%
\section{Daten manipulieren}\label{daten-manipulieren}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

Mit Daten Manipulation meinen wir nicht unsere Daten so zu frisieren, dass etwas rauskommt was wir gerne h√§tten. Es bedeutet vielmehr die Daten so auszuw√§hlen, dass wir aus einer gro√üen Menge Daten selektieren k√∂nnen, um damit besser zu Arbeiten. Einer der wichtigsten Operatoren um eine Vielzahl an Auswahlm√∂glichkeiten zu treffen ist der \texttt{\%\textgreater{}\%} Operator (pipe). Ausgesprochen lautet die Funktion soviel wie ``und dann''. Mit dem \texttt{\%\textgreater{}\%} Operator k√∂nnen Daten in eine Funktion √ºberf√ºhrt werden oder zwei aufeinander aufbauende Funktionen miteinander verkn√ºpft werden.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Die folgenden Zeilen sind identisch}
\FunctionTok{f}\NormalTok{(x)}
\NormalTok{x }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{f}\NormalTok{()}
\CommentTok{\# Anhand einer Funktion}
\FunctionTok{mean}\NormalTok{(x)}
\NormalTok{x }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mean}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

F√ºr die Strukturierung und Transformation der Daten sind zwei packages ganz entscheidend, n√§mlich \texttt{dplyr::} und \texttt{tidyr::}.

Die wichtigsten Funktionen aus dem \texttt{dplyr::} package lauten:

\begin{itemize}
\tightlist
\item
  select()
\item
  filter()
\item
  arrange()
\item
  mutate()
\item
  transmute()
\item
  summarize()
\item
  group\_by()
\item
  across()
\item
  joins
\end{itemize}

Die wichtigsten Funktionen aus dem \texttt{tidyr::} package lauten:

\begin{itemize}
\tightlist
\item
  pivot\_longer()
\item
  pivot\_wider()
\end{itemize}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/032} 

}

\caption{Illustration von @allison_horst: https://twitter.com/allison_horst}\label{fig:unnamed-chunk-124}
\end{figure}

\hypertarget{select---variablen-auswuxe4hlen-spaltenweise}{%
\subsection{select() - Variablen ausw√§hlen (spaltenweise)}\label{select---variablen-auswuxe4hlen-spaltenweise}}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/037} 

}

\caption{Illustration von C.Wilke: https://wilkelab.org/SDS375/}\label{fig:unnamed-chunk-125}
\end{figure}

Um aus unserem Speicherkoog Datensatz nur die Variablen der Bodentemperatur auszugeben, geben wir folgenden Befehl ein:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(date, st10, st20, st30, st60, st100, st150) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 7}
\DocumentationTok{\#\#   date                 st10  st20  st30  st60 st100 st150}
\DocumentationTok{\#\#   \textless{}dttm\textgreater{}              \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 2010{-}04{-}01 00:00:00  7.42  7.28  6.98  6.13  5.55  5.44}
\DocumentationTok{\#\# 2 2010{-}04{-}01 01:00:00  7.21  7.24  6.99  6.12  5.6   5.42}
\DocumentationTok{\#\# 3 2010{-}04{-}01 02:00:00  7.01  7.14  6.94  6.13  5.59  5.41}
\DocumentationTok{\#\# 4 2010{-}04{-}01 03:00:00  6.91  7.12  6.88  6.17  5.63  5.44}
\DocumentationTok{\#\# 5 2010{-}04{-}01 04:00:00  6.81  7.12  6.9   6.17  5.58  5.47}
\end{Highlighting}
\end{Shaded}

Die Variablen werden dazu ohne \texttt{""} ausgeschrieben und durch \texttt{,} getrennt. M√∂chte ich aus dem Datensatz nur eine Variable entfernen so gen√ºgt ein es ein \texttt{-} vor den Namen der Variable zu setzen:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{date) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 54}
\DocumentationTok{\#\#    time  st10  mp10  st20  mp20  st30  mp30  st60  mp60 st100 mp100 st150 mp150}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1     1  7.42     0  7.28     0  6.98     0  6.13     0  5.55     0  5.44     0}
\DocumentationTok{\#\# 2     2  7.21     0  7.24     0  6.99     0  6.12     0  5.6      0  5.42     0}
\DocumentationTok{\#\# 3     3  7.01     0  7.14     0  6.94     0  6.13     0  5.59     0  5.41     0}
\DocumentationTok{\#\# 4     4  6.91     0  7.12     0  6.88     0  6.17     0  5.63     0  5.44     0}
\DocumentationTok{\#\# 5     5  6.81     0  7.12     0  6.9      0  6.17     0  5.58     0  5.47     0}
\DocumentationTok{\#\# \# ... with 41 more variables: eh10a \textless{}dbl\textgreater{}, eh10b \textless{}dbl\textgreater{}, eh10c \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh20a \textless{}dbl\textgreater{}, eh20b \textless{}dbl\textgreater{}, eh20c \textless{}dbl\textgreater{}, eh30a \textless{}dbl\textgreater{}, eh30b \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh30c \textless{}dbl\textgreater{}, eh60a \textless{}dbl\textgreater{}, eh60b \textless{}dbl\textgreater{}, eh60c \textless{}dbl\textgreater{}, eh100a \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh100b \textless{}dbl\textgreater{}, eh100c \textless{}dbl\textgreater{}, eh150a \textless{}dbl\textgreater{}, eh150b \textless{}dbl\textgreater{}, eh150c \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   wd \textless{}dbl\textgreater{}, ws \textless{}dbl\textgreater{}, at \textless{}dbl\textgreater{}, rh \textless{}dbl\textgreater{}, ap \textless{}dbl\textgreater{}, pp \textless{}dbl\textgreater{}, sr \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   wt \textless{}dbl\textgreater{}, ec \textless{}dbl\textgreater{}, bat \textless{}dbl\textgreater{}, lt \textless{}dbl\textgreater{}, x44 \textless{}lgl\textgreater{}, pp\_2 \textless{}chr\textgreater{}, wt\_2 \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   oxy10 \textless{}dbl\textgreater{}, oxy20 \textless{}dbl\textgreater{}, oxy30 \textless{}dbl\textgreater{}, oxy60 \textless{}dbl\textgreater{}, oxy80 \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

In dem \texttt{select()} Aufruf kann ich auch direkt Variablen umbenennen:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{date, w√§rmste}\AttributeTok{\_messtiefe =}\NormalTok{ st10) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 54}
\DocumentationTok{\#\#    time w√§rmste\_messtiefe  mp10  st20  mp20  st30  mp30  st60  mp60 st100 mp100}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{}             \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1     1              7.42     0  7.28     0  6.98     0  6.13     0  5.55     0}
\DocumentationTok{\#\# 2     2              7.21     0  7.24     0  6.99     0  6.12     0  5.6      0}
\DocumentationTok{\#\# 3     3              7.01     0  7.14     0  6.94     0  6.13     0  5.59     0}
\DocumentationTok{\#\# 4     4              6.91     0  7.12     0  6.88     0  6.17     0  5.63     0}
\DocumentationTok{\#\# 5     5              6.81     0  7.12     0  6.9      0  6.17     0  5.58     0}
\DocumentationTok{\#\# \# ... with 43 more variables: st150 \textless{}dbl\textgreater{}, mp150 \textless{}dbl\textgreater{}, eh10a \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh10b \textless{}dbl\textgreater{}, eh10c \textless{}dbl\textgreater{}, eh20a \textless{}dbl\textgreater{}, eh20b \textless{}dbl\textgreater{}, eh20c \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh30a \textless{}dbl\textgreater{}, eh30b \textless{}dbl\textgreater{}, eh30c \textless{}dbl\textgreater{}, eh60a \textless{}dbl\textgreater{}, eh60b \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh60c \textless{}dbl\textgreater{}, eh100a \textless{}dbl\textgreater{}, eh100b \textless{}dbl\textgreater{}, eh100c \textless{}dbl\textgreater{}, eh150a \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh150b \textless{}dbl\textgreater{}, eh150c \textless{}dbl\textgreater{}, wd \textless{}dbl\textgreater{}, ws \textless{}dbl\textgreater{}, at \textless{}dbl\textgreater{}, rh \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   ap \textless{}dbl\textgreater{}, pp \textless{}dbl\textgreater{}, sr \textless{}dbl\textgreater{}, wt \textless{}dbl\textgreater{}, ec \textless{}dbl\textgreater{}, bat \textless{}dbl\textgreater{}, lt \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   x44 \textless{}lgl\textgreater{}, pp\_2 \textless{}chr\textgreater{}, wt\_2 \textless{}dbl\textgreater{}, oxy10 \textless{}dbl\textgreater{}, oxy20 \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

Alle Messtiefen immer auszuschreiben ben√∂tigt Zeit und ist fehleranf√§llig. Es gibt bei \texttt{dplyr::select()} sogenannte \emph{helper functions}. Diese lauten \texttt{starts\_with()}, \texttt{ends\_with()} und \texttt{contains()}. Da wir einen string aus unseren Variablennamen (die Namen der Spalten) ausw√§hlen muss dieser Befehl allerdings in \texttt{""} gesetzt werden. In Kurz lautet die Auswahl der Bodentemperatur also:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 6}
\DocumentationTok{\#\#    st10  st20  st30  st60 st100 st150}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1  7.42  7.28  6.98  6.13  5.55  5.44}
\DocumentationTok{\#\# 2  7.21  7.24  6.99  6.12  5.6   5.42}
\DocumentationTok{\#\# 3  7.01  7.14  6.94  6.13  5.59  5.41}
\DocumentationTok{\#\# 4  6.91  7.12  6.88  6.17  5.63  5.44}
\DocumentationTok{\#\# 5  6.81  7.12  6.9   6.17  5.58  5.47}
\end{Highlighting}
\end{Shaded}

Wollen wir eine bestimmte Abfolge ausw√§hlen, bspw. die Meteorologischen Parameter die in den Spalten \texttt{wd} bis \texttt{sr} stehen, dann geht dies √ºber den folgenden Befehl:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(wd}\SpecialCharTok{:}\NormalTok{sr) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# ":" bedeutet soviel wie "von bis"}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 7}
\DocumentationTok{\#\#      wd    ws    at    rh    ap    pp     sr}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1   199   6     6.6  78.2  998.  14.7 0.0201}
\DocumentationTok{\#\# 2   217   6.7   6    79.7  998.  14.7 0.0192}
\DocumentationTok{\#\# 3   225   7.5   5.8  81.8  998.  14.7 0.0297}
\DocumentationTok{\#\# 4   201   5     5.8  81.3  999.  14.7 0.0242}
\DocumentationTok{\#\# 5   212   6.7   5.7  81.5  999.  14.7 0.0284}
\end{Highlighting}
\end{Shaded}

\hypertarget{filter---filtern-von-variablen-zeilenweise}{%
\subsection{filter() - Filtern von Variablen (zeilenweise)}\label{filter---filtern-von-variablen-zeilenweise}}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/033} 

}

\caption{Illustration von @allison_horst: https://twitter.com/allison_horst}\label{fig:unnamed-chunk-131}
\end{figure}

Mithilfe der logischen Operatoren k√∂nnen wir aus dem Datensatz E\textsubscript{H} Werte filtern die \textgreater{} 400 mV sind, also oxidierend.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Redoxverlauf in 10 cm Tiefe}
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(date, eh10a)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{800}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-132-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Lasst uns nur Werte filtern und darstellen \textgreater{} 400 mV}
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(eh10a }\SpecialCharTok{\textgreater{}} \DecValTok{400}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(date, eh10a)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{800}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-132-2} \end{center}

\texttt{filter} Anfragen k√∂nnen auch miteinander verkn√ºpft werden durch \texttt{!} f√ºr \texttt{NICHT}, \texttt{\&} f√ºr \texttt{UND}, \texttt{\textbar{}} f√ºr \texttt{ODER}. Die Bedingungen lassen sich durch ein \texttt{,} voneinander trennen.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Lasst uns nur Werte filtern und darstellen zwischen 350 und 450 mV \& bis 2012}
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(eh10a }\SpecialCharTok{\textgreater{}} \DecValTok{350} \SpecialCharTok{\&}\NormalTok{ eh10a }\SpecialCharTok{\textless{}} \DecValTok{450} \SpecialCharTok{\&}\NormalTok{ date }\SpecialCharTok{\textless{}} \FunctionTok{as.POSIXct}\NormalTok{(}\StringTok{"2012{-}12{-}31 23:00:00"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(date, eh10a)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{800}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-133-1} \end{center}

üí° Da es sich bei unserer Spalte date um ein \texttt{POSIXct} Objekt handelt m√ºssen wir in dem \texttt{filter()}Befehl dies auch explizit angeben.

\hypertarget{arrange---sortieren-des-datensatzes}{%
\subsection{arrange() - Sortieren des Datensatzes}\label{arrange---sortieren-des-datensatzes}}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/038} 

}

\caption{Illustration von C.Wilke: https://wilkelab.org/SDS375/}\label{fig:unnamed-chunk-134}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Sortiere in aufsteigender Reihenfolge}
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(st10) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(date, st10) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 2}
\DocumentationTok{\#\#   date                 st10}
\DocumentationTok{\#\#   \textless{}dttm\textgreater{}              \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 2018{-}03{-}04 13:00:00 {-}0.84}
\DocumentationTok{\#\# 2 2018{-}03{-}04 14:00:00 {-}0.82}
\DocumentationTok{\#\# 3 2018{-}03{-}04 23:00:00 {-}0.82}
\DocumentationTok{\#\# 4 2018{-}03{-}04 18:00:00 {-}0.81}
\DocumentationTok{\#\# 5 2018{-}03{-}04 07:00:00 {-}0.8}
\CommentTok{\# Sortiere in absteigender Reihenfolge}
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(st10)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(date, st10) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 2}
\DocumentationTok{\#\#   date                 st10}
\DocumentationTok{\#\#   \textless{}dttm\textgreater{}              \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 2010{-}07{-}12 15:00:00  22.5}
\DocumentationTok{\#\# 2 2010{-}07{-}10 16:00:00  22.4}
\DocumentationTok{\#\# 3 2010{-}07{-}12 16:00:00  22.4}
\DocumentationTok{\#\# 4 2010{-}07{-}14 17:00:00  22.3}
\DocumentationTok{\#\# 5 2010{-}07{-}10 17:00:00  22.3}
\end{Highlighting}
\end{Shaded}

Wenn man mehrere Argumente angibt, dann wird zuerst nach der ersten Variable sortiert, dann innerhalb der ersten Variable nach der zweiten, usw. \ldots{}

\hypertarget{mutate---erstelle-neue-variablen}{%
\subsection{mutate() - Erstelle neue Variablen}\label{mutate---erstelle-neue-variablen}}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/040} 

}

\caption{Illustration von @allison_horst: https://twitter.com/allison_horst}\label{fig:unnamed-chunk-136}
\end{figure}

Mit \texttt{mutate()} k√∂nnen neue Variablen dem Datensatz hinzugef√ºgt werden. Wollen wir bspw. die gemessenen Redoxpotenziale gemessen mit der Silber-Silberchlorid Elektrode gegen die Standardwasserstoffelektrode korrigieren, dann m√ºssen wir auf jede Variable in unserem Datensatz die den string ``eh'' enth√§lt + 207 mV addieren. Es gibt eine kurze Version die dieses √ºbernimmt:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Stelle die eh Werte in allen Tiefen dar}
\NormalTok{koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"eh"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 18}
\DocumentationTok{\#\#   eh10a eh10b eh10c eh20a eh20b eh20c eh30a eh30b eh30c eh60a eh60b eh60c eh100a}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1  449.  440.  435.  434.  433.  451.  70.8  382.  154. 11.1  {-}85.1 {-}106.  {-}23.8}
\DocumentationTok{\#\# 2  451.  440.  436.  435.  433.  451.  70.3  382.  153. 10.4  {-}85.6 {-}107.  {-}24.1}
\DocumentationTok{\#\# 3  452.  440.  436.  435.  433.  451.  69.5  381.  152.  9.82 {-}86.3 {-}107.  {-}24.4}
\DocumentationTok{\#\# 4  453.  440.  436.  435.  434.  452.  68.9  382.  152.  9.16 {-}86.7 {-}107.  {-}24.6}
\DocumentationTok{\#\# 5  453.  441.  437.  435.  434.  452.  68.9  382.  152.  8.56 {-}87.2 {-}107.  {-}24.9}
\DocumentationTok{\#\# \# ... with 5 more variables: eh100b \textless{}dbl\textgreater{}, eh100c \textless{}dbl\textgreater{}, eh150a \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh150b \textless{}dbl\textgreater{}, eh150c \textless{}dbl\textgreater{}}

\CommentTok{\# Mit across() kann man eine Funktion auf die Variablen anwenden die in der Beschreibung}
\CommentTok{\# das K√ºrzel "eh" tragen}
\NormalTok{koog }\OtherTok{\textless{}{-}}\NormalTok{ koog\_raw }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"eh"}\NormalTok{), }\SpecialCharTok{\textasciitilde{}}\NormalTok{. }\SpecialCharTok{+} \DecValTok{207}\NormalTok{)) }

\CommentTok{\# Stelle die korrigierten eh Werte da}
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"eh"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 18}
\DocumentationTok{\#\#   eh10a eh10b eh10c eh20a eh20b eh20c eh30a eh30b eh30c eh60a eh60b eh60c eh100a}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1  656.  647.  642.  641.  640.  658.  278.  589.  361.  218.  122.  101.   183.}
\DocumentationTok{\#\# 2  658.  647.  643.  642.  640.  658.  277.  589.  360.  217.  121.  100.   183.}
\DocumentationTok{\#\# 3  659.  647.  643.  642.  640.  658.  277.  588.  360.  217.  121.  100.   183.}
\DocumentationTok{\#\# 4  660.  647.  643.  642.  641.  659.  276.  588.  359.  216.  120.  100.   182.}
\DocumentationTok{\#\# 5  660.  648.  644.  642.  641.  659.  276.  589.  359.  216.  120.  100.   182.}
\DocumentationTok{\#\# \# ... with 5 more variables: eh100b \textless{}dbl\textgreater{}, eh100c \textless{}dbl\textgreater{}, eh150a \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh150b \textless{}dbl\textgreater{}, eh150c \textless{}dbl\textgreater{}}
\end{Highlighting}
\end{Shaded}

Vielleicht ist es euch aufgefallen, dass wir unsere Datei \texttt{koog\_raw} nun umbenannt haben zu \texttt{koog}. Dies hat folgenden Grund. \textbf{Rohdaten sollten Rohdaten bleiben}. Wenn wir die Daten komplexer umstrukturieren oder eben auch korrigieren (+207 mV) dann kann man immer wieder Bezug zu den Rohdaten nehmen. √Ñndern wir diese ist es nicht mehr m√∂glich. Weiterer fun fact: Weisen wir mit der Funktion +207 mV nicht ein neues Objekt zu sondern √ºberschreiben das bestehende, dann addieren wir immer wieder aufs neue 207 mV und der E\textsubscript{H} steigt ins unendliche üôÉ

Wir k√∂nnen nicht nur Spalten hinzuf√ºgen durch Berechnungen, sondern auch indem wir aus bestehenden Vektoren Informationen extrahieren. Wenn wir im n√§chsten Kapitel Mittelwerte berechnen und Daten gruppieren wird dies besonders n√ºtzlich. Als Beispiel wollen wir aus dem date das Jahr, Monat, Tag, etc. in eine neue Spalte √ºberf√ºhren und benennen diese neu:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle neue Spalten mit Zeitstempeln}
\NormalTok{koog }\OtherTok{\textless{}{-}}\NormalTok{ koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{year =}\NormalTok{ lubridate}\SpecialCharTok{::}\FunctionTok{year}\NormalTok{(date),}
         \AttributeTok{month =}\NormalTok{ lubridate}\SpecialCharTok{::}\FunctionTok{month}\NormalTok{(date),}
         \AttributeTok{day =}\NormalTok{ lubridate}\SpecialCharTok{::}\FunctionTok{day}\NormalTok{(date),}
         \AttributeTok{hour =}\NormalTok{ lubridate}\SpecialCharTok{::}\FunctionTok{hour}\NormalTok{(date), }
         \AttributeTok{daily =} \FunctionTok{format}\NormalTok{(date, }\StringTok{"\%Y{-}\%m{-}\%d"}\NormalTok{),}
         \AttributeTok{monthly =} \FunctionTok{format}\NormalTok{(date, }\StringTok{"\%Y{-}\%m"}\NormalTok{))}

\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(date, year, month, day, hour, daily, monthly) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 7}
\DocumentationTok{\#\#   date                 year month   day  hour daily      monthly}
\DocumentationTok{\#\#   \textless{}dttm\textgreater{}              \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}chr\textgreater{}      \textless{}chr\textgreater{}  }
\DocumentationTok{\#\# 1 2010{-}04{-}01 00:00:00  2010     4     1     0 2010{-}04{-}01 2010{-}04}
\DocumentationTok{\#\# 2 2010{-}04{-}01 01:00:00  2010     4     1     1 2010{-}04{-}01 2010{-}04}
\DocumentationTok{\#\# 3 2010{-}04{-}01 02:00:00  2010     4     1     2 2010{-}04{-}01 2010{-}04}
\DocumentationTok{\#\# 4 2010{-}04{-}01 03:00:00  2010     4     1     3 2010{-}04{-}01 2010{-}04}
\DocumentationTok{\#\# 5 2010{-}04{-}01 04:00:00  2010     4     1     4 2010{-}04{-}01 2010{-}04}
\end{Highlighting}
\end{Shaded}

üö® Die neue Spalten Jahr, Monat, etc, sind nach der Transformation keine \texttt{POSIXct} Objekt!

Wir k√∂nnen in unserem Datensatz auch bestehende Variablen √ºberschreiben, bspw. alle Werte der Bodentemperatur \textless= 6 ¬∞C. Dazu m√ºssen wir nicht jede Spalte einzeln durchgehen sondern k√∂nnen den folgenden Befehl annwenden:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_clean }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(daily }\SpecialCharTok{\textless{}} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2010{-}04{-}05"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(daily, }\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"st"}\NormalTok{))}
\FunctionTok{head}\NormalTok{(koog\_clean)}
\DocumentationTok{\#\# \# A tibble: 4 x 7}
\DocumentationTok{\#\#   daily       st10  st20  st30  st60 st100 st150}
\DocumentationTok{\#\#   \textless{}date\textgreater{}     \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 2010{-}04{-}01  6.70  6.81  6.76  6.18  5.64  5.46}
\DocumentationTok{\#\# 2 2010{-}04{-}02  6.42  6.29  6.31  6.15  5.74  5.54}
\DocumentationTok{\#\# 3 2010{-}04{-}03  6.47  6.35  6.30  6.08  5.78  5.62}
\DocumentationTok{\#\# 4 2010{-}04{-}04  7.45  6.82  6.56  6.09  5.80  5.69}

\CommentTok{\# Bereinige den Datensatz}
\NormalTok{koog\_clean }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate\_at}\NormalTok{(}\FunctionTok{vars}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)), }\SpecialCharTok{\textasciitilde{}}\FunctionTok{ifelse}\NormalTok{(. }\SpecialCharTok{\textless{}=}\DecValTok{6}\NormalTok{, }\ConstantTok{NA}\NormalTok{, .))}
\DocumentationTok{\#\# \# A tibble: 4 x 7}
\DocumentationTok{\#\#   daily       st10  st20  st30  st60 st100 st150}
\DocumentationTok{\#\#   \textless{}date\textgreater{}     \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}lgl\textgreater{} \textless{}lgl\textgreater{}}
\DocumentationTok{\#\# 1 2010{-}04{-}01  6.70  6.81  6.76  6.18 NA    NA   }
\DocumentationTok{\#\# 2 2010{-}04{-}02  6.42  6.29  6.31  6.15 NA    NA   }
\DocumentationTok{\#\# 3 2010{-}04{-}03  6.47  6.35  6.30  6.08 NA    NA   }
\DocumentationTok{\#\# 4 2010{-}04{-}04  7.45  6.82  6.56  6.09 NA    NA}
\end{Highlighting}
\end{Shaded}

Die \texttt{\textasciitilde{}} gibt an, welche Operation mit den Variablen zur Linken (alle die ``st'' im Namen tragen) durchgef√ºhrt werden soll. Die Funktion \texttt{ifelse()} ist √§hnlich wie in Excel: \emph{WENN} X = Y, \emph{DANN}, \emph{SONST} Z. Der \texttt{.} ist ein Platzhalter f√ºr die Variablen auf die das Kriterium ``st'' zutrifft. Mit diesem Befehl haben wir also alle Werte in 100 und 150 cm gel√∂scht.

Einen Mittelwert aus mehrere Variablen pro Zeile zu generieren ist auch kein Problem:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_day }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rowwise}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# f√ºhre die folgende Berechnung Zeilenweise durch}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{eh10\_mean =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(eh10a, eh10b, eh10c), }\AttributeTok{na.rm =}\NormalTok{ T),}
         \AttributeTok{eh20\_mean =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(eh20a, eh20b, eh20c), }\AttributeTok{na.rm =}\NormalTok{ T),}
         \AttributeTok{eh30\_mean =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(eh30a, eh30b, eh30c), }\AttributeTok{na.rm =}\NormalTok{ T),}
         \AttributeTok{eh60\_mean =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(eh60a, eh60b, eh60c), }\AttributeTok{na.rm =}\NormalTok{ T),}
         \AttributeTok{eh100\_mean =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(eh100a, eh100b, eh100c), }\AttributeTok{na.rm =}\NormalTok{ T),}
         \AttributeTok{eh150\_mean =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(eh150a, eh150b, eh150c), }\AttributeTok{na.rm =}\NormalTok{ T)) }

\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(daily, }\FunctionTok{contains}\NormalTok{(}\StringTok{"eh"}\NormalTok{) }\SpecialCharTok{\&} \FunctionTok{contains}\NormalTok{(}\StringTok{"mean"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 7}
\DocumentationTok{\#\# \# Rowwise: }
\DocumentationTok{\#\#   daily      eh10\_mean eh20\_mean eh30\_mean eh60\_mean eh100\_mean eh150\_mean}
\DocumentationTok{\#\#   \textless{}date\textgreater{}         \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}      \textless{}dbl\textgreater{}      \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 2010{-}04{-}01      597.      643.      594.      369.       388.      {-}171.}
\DocumentationTok{\#\# 2 2010{-}04{-}02      597.      643.      594.      369.       388.      {-}171.}
\DocumentationTok{\#\# 3 2010{-}04{-}03      597.      643.      594.      369.       388.      {-}171.}
\DocumentationTok{\#\# 4 2010{-}04{-}04      597.      643.      594.      369.       388.      {-}171.}
\DocumentationTok{\#\# 5 2010{-}04{-}05      597.      643.      594.      369.       388.      {-}171.}
\end{Highlighting}
\end{Shaded}

\hypertarget{summarize---zusammenfassung-von-variablen}{%
\subsection{summarize() - Zusammenfassung von Variablen}\label{summarize---zusammenfassung-von-variablen}}

Mit \texttt{summarize()} k√∂nnen Daten zusammengefasst werden, indem wir eine Funktion auf eine beliebige Anzahl von Spalten anwenden. Schauen wir uns also den Verlauf der Bodentemperatur f√ºr den Speicherkoog in den unterschiedlichen Tiefen an:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Bodentemperatur f√ºr 2011}
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{==} \StringTok{"2011"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{name =} \FunctionTok{fct\_relevel}\NormalTok{(name, }\StringTok{"st10"}\NormalTok{,}\StringTok{"st20"}\NormalTok{,}\StringTok{"st30"}\NormalTok{,}\StringTok{"st60"}\NormalTok{,}\StringTok{"st100"}\NormalTok{,}\StringTok{"st150"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(date, value, }\AttributeTok{color =}\NormalTok{ name)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_viridis\_d}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-141-1} \end{center}

Aus dem Verlauf der Daten k√∂nnen wir noch nicht viel ablesen. Eine zusammenfassende Statistik kann jedoch schnell und einfach unter Verwendung von \texttt{summarize()} erfolgen.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Berechne den Mittelwert der Temperatur und speicher ihn in ein neues Objekt st\_sum}
\NormalTok{st\_sum }\OtherTok{\textless{}{-}}\NormalTok{ koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{==} \StringTok{"2011"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{mean\_10 =} \FunctionTok{mean}\NormalTok{(st10, }\AttributeTok{na.rm =}\NormalTok{ T), }\CommentTok{\# Nicht vergessen das Argument na.rm = T zu setzen!}
            \AttributeTok{mean\_20 =} \FunctionTok{mean}\NormalTok{(st20, }\AttributeTok{na.rm =}\NormalTok{ T),}
            \AttributeTok{mean\_30 =} \FunctionTok{mean}\NormalTok{(st30, }\AttributeTok{na.rm =}\NormalTok{ T),}
            \AttributeTok{mean\_60 =} \FunctionTok{mean}\NormalTok{(st60, }\AttributeTok{na.rm =}\NormalTok{ T),}
            \AttributeTok{mean\_100 =} \FunctionTok{mean}\NormalTok{(st100, }\AttributeTok{na.rm =}\NormalTok{ T),}
            \AttributeTok{mean\_150 =} \FunctionTok{mean}\NormalTok{(st150, }\AttributeTok{na.rm =}\NormalTok{ T))}
\CommentTok{\# Runde die Werte in st\_sum auf die dritte Nachkommastelle}
\FunctionTok{round}\NormalTok{(st\_sum, }\DecValTok{2}\NormalTok{)}
\DocumentationTok{\#\#   mean\_10 mean\_20 mean\_30 mean\_60 mean\_100 mean\_150}
\DocumentationTok{\#\# 1     9.4    9.35    9.34    9.06     9.21     9.18}
\end{Highlighting}
\end{Shaded}

Super. Mit diesen Werten k√∂nnen wir etwas anfangen und weiter arbeiten. M√∂chten man diese beschreibende Statistik f√ºr Variablen in einem dataframe mit einem bestimmten Merkmal durchf√ºhren gibt es auch shortcuts k√ºrzere Befehle:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Mittelwert f√ºr die Spalten st10 und st20}
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise\_at}\NormalTok{(}\FunctionTok{vars}\NormalTok{(st10, st20), mean, }\AttributeTok{na.rm =}\NormalTok{ T) }
\DocumentationTok{\#\# \# A tibble: 1 x 2}
\DocumentationTok{\#\#    st10  st20}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1  9.64  9.92}

\CommentTok{\# Mittelwert f√ºr die Spalten st10 bis st150}
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise\_at}\NormalTok{(}\FunctionTok{vars}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)), mean, }\AttributeTok{na.rm =}\NormalTok{ T)}
\DocumentationTok{\#\# \# A tibble: 1 x 6}
\DocumentationTok{\#\#    st10  st20  st30  st60 st100 st150}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1  9.64  9.92  9.70  9.23  9.93  9.70}

\CommentTok{\# Mittelwert und SD f√ºr die Spalten st10 bis st150}
\CommentTok{\# fn1 steht dabei f√ºr Funktion 1 = mean und fn2 f√ºr sd}
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise\_at}\NormalTok{(}\FunctionTok{vars}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)), }\FunctionTok{list}\NormalTok{(mean, sd), }\AttributeTok{na.rm =}\NormalTok{ T) }\CommentTok{\# Wir schreiben die Funktionen mean und sd in eine Liste }
\DocumentationTok{\#\# \# A tibble: 1 x 12}
\DocumentationTok{\#\#   st10\_fn1 st20\_fn1 st30\_fn1 st60\_fn1 st100\_fn1 st150\_fn1 st10\_fn2 st20\_fn2}
\DocumentationTok{\#\#      \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1     9.64     9.92     9.70     9.23      9.93      9.70     5.11     4.75}
\DocumentationTok{\#\# \# ... with 4 more variables: st30\_fn2 \textless{}dbl\textgreater{}, st60\_fn2 \textless{}dbl\textgreater{}, st100\_fn2 \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   st150\_fn2 \textless{}dbl\textgreater{}}

\CommentTok{\# Umbenennen geht nat√ºrlich auch }
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise\_at}\NormalTok{(}\FunctionTok{vars}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)), }\FunctionTok{list}\NormalTok{(}\AttributeTok{mean =}\NormalTok{ mean, }\AttributeTok{sd =}\NormalTok{ sd), }\AttributeTok{na.rm =}\NormalTok{ T)}
\DocumentationTok{\#\# \# A tibble: 1 x 12}
\DocumentationTok{\#\#   st10\_mean st20\_mean st30\_mean st60\_mean st100\_mean st150\_mean st10\_sd st20\_sd}
\DocumentationTok{\#\#       \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}      \textless{}dbl\textgreater{}      \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1      9.64      9.92      9.70      9.23       9.93       9.70    5.11    4.75}
\DocumentationTok{\#\# \# ... with 4 more variables: st30\_sd \textless{}dbl\textgreater{}, st60\_sd \textless{}dbl\textgreater{}, st100\_sd \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   st150\_sd \textless{}dbl\textgreater{}}
\end{Highlighting}
\end{Shaded}

Erinnert ihr euch noch an unsere selbst geschriebene Funktion \texttt{descriptives}? Zusammen mit dem Verben aus dem tidyverse entstehen so unendlich viele M√∂glichkeiten mit m√§chtigen Werkzeugen der Datenanalyse:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{descriptives }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) \{ }\CommentTok{\# Default{-}Wert f√ºr \textquotesingle{}na.rm\textquotesingle{} = TRUE}
\NormalTok{  descriptives\_vector }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
    \AttributeTok{n =} \FunctionTok{length}\NormalTok{(x),}
    \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(x, }\AttributeTok{na.rm =}\NormalTok{ na.rm), }
    \AttributeTok{sd =} \FunctionTok{sd}\NormalTok{(x, }\AttributeTok{na.rm =}\NormalTok{ na.rm),     }
    \AttributeTok{min =} \FunctionTok{min}\NormalTok{(x, }\AttributeTok{na.rm =}\NormalTok{ na.rm),   }
    \AttributeTok{max =} \FunctionTok{max}\NormalTok{(x, }\AttributeTok{na.rm =}\NormalTok{ na.rm),}
    \AttributeTok{median =} \FunctionTok{median}\NormalTok{(x, }\AttributeTok{na.rm =}\NormalTok{ na.rm)}
\NormalTok{  )}
  \FunctionTok{return}\NormalTok{(descriptives\_vector)}
\NormalTok{\}}
\CommentTok{\# Wende unsere Funktion descriptives auf die Spalten Bodentemperatur an}
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise\_at}\NormalTok{(}\FunctionTok{vars}\NormalTok{(st10), descriptives)}
\DocumentationTok{\#\# \# A tibble: 6 x 1}
\DocumentationTok{\#\#       st10}
\DocumentationTok{\#\#      \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 94537   }
\DocumentationTok{\#\# 2     9.64}
\DocumentationTok{\#\# 3     5.11}
\DocumentationTok{\#\# 4    {-}0.84}
\DocumentationTok{\#\# 5    22.5 }
\DocumentationTok{\#\# 6     9.71}
\end{Highlighting}
\end{Shaded}

ü§Ø Mit diesem kurzen Befehl haben wir mit einem Streich \texttt{n}, \texttt{mean}, \texttt{sd}, \texttt{min}, \texttt{max}, und \texttt{median} berechnet f√ºr alle Tiefen! Stark.

\hypertarget{group_by---gruppiere-variablen}{%
\subsection{group\_by - Gruppiere Variablen}\label{group_by---gruppiere-variablen}}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/041} 

}

\caption{Illustration von C.Wilke: https://wilkelab.org/SDS375/}\label{fig:unnamed-chunk-145}
\end{figure}

Mit der Funktion \texttt{group\_by()} k√∂nnen wir unsere Daten nach einer oder mehrerer Variablen gruppieren. zusammen mit der Funktion \texttt{summarise()} entstehen so sehr elegante M√∂glichkeiten explorative Datenanalyse zu betreiben. M√∂chten wir bspw. wissen wie die Bodentemperaturen in den Jahren sind k√∂nnen wir erst nach der Variable \texttt{year} gruppieren gefolgt von \texttt{summarise}:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Gruppiere nach Jahr und berechne den Mittelwert f√ºr st10}
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{group\_by}\NormalTok{(year) }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{summarise}\NormalTok{(}\AttributeTok{mean\_st10 =} \FunctionTok{round}\NormalTok{(}\FunctionTok{mean}\NormalTok{(st10, }\AttributeTok{na.rm =}\NormalTok{ T), }\DecValTok{2}\NormalTok{)) }\CommentTok{\# Die Funktion round() rundet die Zahlen}
\DocumentationTok{\#\# \# A tibble: 12 x 2}
\DocumentationTok{\#\#     year mean\_st10}
\DocumentationTok{\#\#    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\DocumentationTok{\#\#  1  2010     11.5 }
\DocumentationTok{\#\#  2  2011      9.4 }
\DocumentationTok{\#\#  3  2012      9.92}
\DocumentationTok{\#\#  4  2013      9.31}
\DocumentationTok{\#\#  5  2014     10.7 }
\DocumentationTok{\#\#  6  2015      9.77}
\DocumentationTok{\#\#  7  2016      9.47}
\DocumentationTok{\#\#  8  2017      9.18}
\DocumentationTok{\#\#  9  2018      9.11}
\DocumentationTok{\#\# 10  2019      8.95}
\DocumentationTok{\#\# 11  2020      9.48}
\DocumentationTok{\#\# 12  2021      3.05}
\end{Highlighting}
\end{Shaded}

2010 war also das w√§rmste Jahr im Mittel aber Vorsicht\ldots wir haben in dem Jahr auch erst im April angefangen zu messen. Wir k√∂nnen die Gruppierung auch noch spezieller gestalten, indem wir uns ausschlie√ülich den April in jedem Jahr ansehen:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{==} \StringTok{"4"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# Zuerst suchen wir uns nur die Zeilen aus dem April raus}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{group\_by}\NormalTok{(year, month) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# Dann gruppieren wir nach Jahr und Monat}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{summarise}\NormalTok{(}\AttributeTok{mean\_st10 =} \FunctionTok{round}\NormalTok{(}\FunctionTok{mean}\NormalTok{(st10, }\AttributeTok{na.rm =}\NormalTok{ T), }\DecValTok{2}\NormalTok{)) }\CommentTok{\# Mittelwert berechnen}
\DocumentationTok{\#\# \# A tibble: 11 x 3}
\DocumentationTok{\#\# \# Groups:   year [11]}
\DocumentationTok{\#\#     year month mean\_st10}
\DocumentationTok{\#\#    \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\DocumentationTok{\#\#  1  2010     4      8.4 }
\DocumentationTok{\#\#  2  2011     4      8.88}
\DocumentationTok{\#\#  3  2012     4      6.73}
\DocumentationTok{\#\#  4  2013     4      5.65}
\DocumentationTok{\#\#  5  2014     4      9.22}
\DocumentationTok{\#\#  6  2015     4      7.99}
\DocumentationTok{\#\#  7  2016     4      7.17}
\DocumentationTok{\#\#  8  2017     4      7.49}
\DocumentationTok{\#\#  9  2018     4      7.87}
\DocumentationTok{\#\# 10  2019     4      6.94}
\DocumentationTok{\#\# 11  2020     4      6.56}
\end{Highlighting}
\end{Shaded}

April 2014 war √ºberdurchschnittlich warm im Vergleich zu den anderen Jahren ‚òÄÔ∏è

Mit der Kombination aus \texttt{group\_by()} und \texttt{summarize()} k√∂nnen wir aus einem SEHR gro√üen Datensatz von st√ºndlichen Messungen (n = 94537) einen kompakteren Datensatz auf Tagesbasis, Monatsbasis, und Jahresbasis bilden:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Tagesmittelwerte}
\NormalTok{koog\_day }\OtherTok{\textless{}{-}}\NormalTok{ koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(daily) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise\_if}\NormalTok{(is.numeric, mean, }\AttributeTok{na.rm =}\NormalTok{ T)}

\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(daily, st10) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 2}
\DocumentationTok{\#\#   daily       st10}
\DocumentationTok{\#\#   \textless{}chr\textgreater{}      \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 2010{-}04{-}01  6.70}
\DocumentationTok{\#\# 2 2010{-}04{-}02  6.42}
\DocumentationTok{\#\# 3 2010{-}04{-}03  6.47}
\DocumentationTok{\#\# 4 2010{-}04{-}04  7.45}
\DocumentationTok{\#\# 5 2010{-}04{-}05  7.28}

\CommentTok{\# Monatsmittelwerte}
\NormalTok{koog\_month }\OtherTok{\textless{}{-}}\NormalTok{ koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(monthly) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise\_if}\NormalTok{(is.numeric, mean, }\AttributeTok{na.rm =}\NormalTok{ T)}

\NormalTok{koog\_month }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(monthly, st10) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 2}
\DocumentationTok{\#\#   monthly  st10}
\DocumentationTok{\#\#   \textless{}chr\textgreater{}   \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 2010{-}04  8.40}
\DocumentationTok{\#\# 2 2010{-}05 10.9 }
\DocumentationTok{\#\# 3 2010{-}06 15.5 }
\DocumentationTok{\#\# 4 2010{-}07 19.0 }
\DocumentationTok{\#\# 5 2010{-}08 17.2}

\CommentTok{\# Jahresmittelwerte}
\NormalTok{koog\_year }\OtherTok{\textless{}{-}}\NormalTok{ koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(year) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise\_if}\NormalTok{(is.numeric, mean, }\AttributeTok{na.rm =}\NormalTok{ T)}

\NormalTok{koog\_year }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(year, st10) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 2}
\DocumentationTok{\#\#    year  st10}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1  2010 11.5 }
\DocumentationTok{\#\# 2  2011  9.40}
\DocumentationTok{\#\# 3  2012  9.92}
\DocumentationTok{\#\# 4  2013  9.31}
\DocumentationTok{\#\# 5  2014 10.7}
\end{Highlighting}
\end{Shaded}

\hypertarget{across---anwenden-von-funktionen-auf-spalten}{%
\subsection{across() - Anwenden von Funktionen auf Spalten}\label{across---anwenden-von-funktionen-auf-spalten}}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/043} 

}

\caption{Illustration von @allison_horst: https://twitter.com/allison_horst}\label{fig:unnamed-chunk-149}
\end{figure}

Sch√∂ner als die graphische Darstellung der Funktion \texttt{across} durch \href{https://twitter.com/allison_horst?lang=de}{Allison Horst} kann man es nicht in Worte fassen. Ein Beispiel dieser um den Mittelwert aus allen Spalten des Speicherkoog zu bilden, die numerisch sind (also quasi auf alle):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{summarize}\NormalTok{(}
\NormalTok{    dplyr}\SpecialCharTok{::}\FunctionTok{across}\NormalTok{(}\FunctionTok{where}\NormalTok{(is.numeric), mean, }\AttributeTok{na.rm =}\NormalTok{ T)}
\NormalTok{    )}
\DocumentationTok{\#\# \# A tibble: 1 x 56}
\DocumentationTok{\#\#     time  st10  mp10  st20  mp20  st30  mp30  st60  mp60 st100 mp100 st150 mp150}
\DocumentationTok{\#\#    \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 43405.  9.64  1.02  9.92 0.935  9.70 0.894  9.23 0.713  9.93 0.503  9.70 0.161}
\DocumentationTok{\#\# \# ... with 43 more variables: eh10a \textless{}dbl\textgreater{}, eh10b \textless{}dbl\textgreater{}, eh10c \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh20a \textless{}dbl\textgreater{}, eh20b \textless{}dbl\textgreater{}, eh20c \textless{}dbl\textgreater{}, eh30a \textless{}dbl\textgreater{}, eh30b \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh30c \textless{}dbl\textgreater{}, eh60a \textless{}dbl\textgreater{}, eh60b \textless{}dbl\textgreater{}, eh60c \textless{}dbl\textgreater{}, eh100a \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   eh100b \textless{}dbl\textgreater{}, eh100c \textless{}dbl\textgreater{}, eh150a \textless{}dbl\textgreater{}, eh150b \textless{}dbl\textgreater{}, eh150c \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   wd \textless{}dbl\textgreater{}, ws \textless{}dbl\textgreater{}, at \textless{}dbl\textgreater{}, rh \textless{}dbl\textgreater{}, ap \textless{}dbl\textgreater{}, pp \textless{}dbl\textgreater{}, sr \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   wt \textless{}dbl\textgreater{}, ec \textless{}dbl\textgreater{}, bat \textless{}dbl\textgreater{}, lt \textless{}dbl\textgreater{}, wt\_2 \textless{}dbl\textgreater{}, oxy10 \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   oxy20 \textless{}dbl\textgreater{}, oxy30 \textless{}dbl\textgreater{}, oxy60 \textless{}dbl\textgreater{}, oxy80 \textless{}dbl\textgreater{}, oxy100 \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

\hypertarget{joins}{%
\subsection{joins}\label{joins}}

Es kann vorkommen, dass bestehende Datens√§tze miteinander verkn√ºpft werden m√ºssen. Dies kann mit den Funktionen

\begin{itemize}
\tightlist
\item
  left\_join()
\item
  right\_join()
\item
  inner\_join()
\item
  full\_join()
\end{itemize}

umgesetzt werden.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/044} 

}

\caption{Illustration von C.Wilke: https://wilkelab.org/SDS375/}\label{fig:unnamed-chunk-151}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Bandmitglieder}
\NormalTok{band\_members }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{name =} \FunctionTok{c}\NormalTok{(}\StringTok{"Mick"}\NormalTok{, }\StringTok{"John"}\NormalTok{, }\StringTok{"Paul"}\NormalTok{), }
  \AttributeTok{band =} \FunctionTok{c}\NormalTok{(}\StringTok{"Stones"}\NormalTok{, }\StringTok{"Beatles"}\NormalTok{, }\StringTok{"Beatles"}\NormalTok{)}
\NormalTok{)}

\CommentTok{\# Instrumente von Bandmitgliedern}
\NormalTok{band\_instruments }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{name =} \FunctionTok{c}\NormalTok{(}\StringTok{"John"}\NormalTok{, }\StringTok{"Paul"}\NormalTok{, }\StringTok{"Keith"}\NormalTok{), }
  \AttributeTok{plays =} \FunctionTok{c}\NormalTok{(}\StringTok{"guitar"}\NormalTok{, }\StringTok{"bass"}\NormalTok{, }\StringTok{"guitar"}\NormalTok{)}
\NormalTok{)}

\NormalTok{band\_members}
\DocumentationTok{\#\# \# A tibble: 3 x 2}
\DocumentationTok{\#\#   name  band   }
\DocumentationTok{\#\#   \textless{}chr\textgreater{} \textless{}chr\textgreater{}  }
\DocumentationTok{\#\# 1 Mick  Stones }
\DocumentationTok{\#\# 2 John  Beatles}
\DocumentationTok{\#\# 3 Paul  Beatles}

\NormalTok{band\_instruments}
\DocumentationTok{\#\# \# A tibble: 3 x 2}
\DocumentationTok{\#\#   name  plays }
\DocumentationTok{\#\#   \textless{}chr\textgreater{} \textless{}chr\textgreater{} }
\DocumentationTok{\#\# 1 John  guitar}
\DocumentationTok{\#\# 2 Paul  bass  }
\DocumentationTok{\#\# 3 Keith guitar}

\CommentTok{\# Verkn√ºpfe Table rechts mit links}
\FunctionTok{left\_join}\NormalTok{(band\_members, band\_instruments)}
\DocumentationTok{\#\# \# A tibble: 3 x 3}
\DocumentationTok{\#\#   name  band    plays }
\DocumentationTok{\#\#   \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{} }
\DocumentationTok{\#\# 1 Mick  Stones  \textless{}NA\textgreater{}  }
\DocumentationTok{\#\# 2 John  Beatles guitar}
\DocumentationTok{\#\# 3 Paul  Beatles bass}

\CommentTok{\# Verkn√ºpfe Table links mit rechts}
\FunctionTok{right\_join}\NormalTok{(band\_members, band\_instruments)}
\DocumentationTok{\#\# \# A tibble: 3 x 3}
\DocumentationTok{\#\#   name  band    plays }
\DocumentationTok{\#\#   \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{} }
\DocumentationTok{\#\# 1 John  Beatles guitar}
\DocumentationTok{\#\# 2 Paul  Beatles bass  }
\DocumentationTok{\#\# 3 Keith \textless{}NA\textgreater{}    guitar}

\CommentTok{\# Verkn√ºpfe die Schnittmengen}
\FunctionTok{inner\_join}\NormalTok{(band\_members, band\_instruments)}
\DocumentationTok{\#\# \# A tibble: 2 x 3}
\DocumentationTok{\#\#   name  band    plays }
\DocumentationTok{\#\#   \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{} }
\DocumentationTok{\#\# 1 John  Beatles guitar}
\DocumentationTok{\#\# 2 Paul  Beatles bass}

\CommentTok{\# Verkn√ºpfe alle F√§lle}
\FunctionTok{full\_join}\NormalTok{(band\_members, band\_instruments)}
\DocumentationTok{\#\# \# A tibble: 4 x 3}
\DocumentationTok{\#\#   name  band    plays }
\DocumentationTok{\#\#   \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{} }
\DocumentationTok{\#\# 1 Mick  Stones  \textless{}NA\textgreater{}  }
\DocumentationTok{\#\# 2 John  Beatles guitar}
\DocumentationTok{\#\# 3 Paul  Beatles bass  }
\DocumentationTok{\#\# 4 Keith \textless{}NA\textgreater{}    guitar}
\end{Highlighting}
\end{Shaded}

Es gibt auch eine M√∂glichkeit viele data.frames in R in Form einer Liste zu verkn√ºpfen. Dazu wird das package \texttt{plyr::} ben√∂tigt und die FUnktion \texttt{join\_all()}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# x,y,z sind die Dateinamen die verkn√ºpft werden sollen}
\CommentTok{\# by = ist die Spalte die verkn√ºpft werden soll}
\CommentTok{\# type = left bedeutet, dass alle neuen Spalten an data..frame x angepasst werden}
\NormalTok{plyr}\SpecialCharTok{::}\FunctionTok{join\_all}\NormalTok{(}\FunctionTok{list}\NormalTok{(x,y,z), }\AttributeTok{by=}\StringTok{\textquotesingle{}Flag\textquotesingle{}}\NormalTok{, }\AttributeTok{type=}\StringTok{\textquotesingle{}left\textquotesingle{}}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\hypertarget{pivot_longer---long-data-format}{%
\subsection{pivot\_longer() - Long data format}\label{pivot_longer---long-data-format}}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/042} 

}

\caption{Illustration von C.Wilke: https://wilkelab.org/SDS375/}\label{fig:unnamed-chunk-154}
\end{figure}

Aktuell steht derselbe Wertetyp, n√§mlich die Bodentemperatur, nebeneinander. Man bezeichnet dies als \emph{wide format}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(date, }\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{10}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 10 x 7}
\DocumentationTok{\#\#    date                 st10  st20  st30  st60 st100 st150}
\DocumentationTok{\#\#    \textless{}dttm\textgreater{}              \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\#  1 2010{-}04{-}01 00:00:00  7.42  7.28  6.98  6.13  5.55  5.44}
\DocumentationTok{\#\#  2 2010{-}04{-}01 01:00:00  7.21  7.24  6.99  6.12  5.6   5.42}
\DocumentationTok{\#\#  3 2010{-}04{-}01 02:00:00  7.01  7.14  6.94  6.13  5.59  5.41}
\DocumentationTok{\#\#  4 2010{-}04{-}01 03:00:00  6.91  7.12  6.88  6.17  5.63  5.44}
\DocumentationTok{\#\#  5 2010{-}04{-}01 04:00:00  6.81  7.12  6.9   6.17  5.58  5.47}
\DocumentationTok{\#\#  6 2010{-}04{-}01 05:00:00  6.73  6.96  6.89  6.15  5.6   5.45}
\DocumentationTok{\#\#  7 2010{-}04{-}01 06:00:00  6.66  6.96  6.91  6.16  5.64  5.43}
\DocumentationTok{\#\#  8 2010{-}04{-}01 07:00:00  6.59  6.9   6.85  6.19  5.65  5.44}
\DocumentationTok{\#\#  9 2010{-}04{-}01 08:00:00  6.51  6.92  6.85  6.17  5.61  5.45}
\DocumentationTok{\#\# 10 2010{-}04{-}01 09:00:00  6.54  6.82  6.81  6.2   5.65  5.45}
\end{Highlighting}
\end{Shaded}

Um Daten graphisch darzustellen und zu analysieren ist einer der h√§ufigsten Schritte sie in eine bestimmte Art und Weise umzustrukturieren. Ein h√§ufiger Schritt ist dabei das aneinanderkn√ºpfen/verketten/vektorisieren (you name it) von Variablen. Dies kann mit dem Befehl \texttt{pivot\_longer()} erfolgen.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(date, }\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{), }\AttributeTok{names\_to =} \StringTok{"depth"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"value"}\NormalTok{, }\AttributeTok{names\_prefix =} \StringTok{"st"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{10}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 10 x 3}
\DocumentationTok{\#\#    date                depth value}
\DocumentationTok{\#\#    \textless{}dttm\textgreater{}              \textless{}chr\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\#  1 2010{-}04{-}01 00:00:00 10     7.42}
\DocumentationTok{\#\#  2 2010{-}04{-}01 00:00:00 20     7.28}
\DocumentationTok{\#\#  3 2010{-}04{-}01 00:00:00 30     6.98}
\DocumentationTok{\#\#  4 2010{-}04{-}01 00:00:00 60     6.13}
\DocumentationTok{\#\#  5 2010{-}04{-}01 00:00:00 100    5.55}
\DocumentationTok{\#\#  6 2010{-}04{-}01 00:00:00 150    5.44}
\DocumentationTok{\#\#  7 2010{-}04{-}01 01:00:00 10     7.21}
\DocumentationTok{\#\#  8 2010{-}04{-}01 01:00:00 20     7.24}
\DocumentationTok{\#\#  9 2010{-}04{-}01 01:00:00 30     6.99}
\DocumentationTok{\#\# 10 2010{-}04{-}01 01:00:00 60     6.12}
\end{Highlighting}
\end{Shaded}

Welche Spalten man f√ºr \texttt{pivot\_longer()} nutzen m√∂chte muss nicht explizit geschrieben werden, sondern kann durch die helper functions contains(), starts\_with(), ends\_with() einfacher gestaltet werden. Ein paar Worte zu den Argumenten:

\begin{itemize}
\tightlist
\item
  \texttt{cols} definiert die Variablen, die verl√§ngert werden sollen. Das Argument kann durch die select() helper Funktionen contains(), starts\_with(), ends\_with() erweitert werden.
\item
  \texttt{names\_to} definiert den neuen Spaltennamen basierend auf den alten Bezeichnungen. Bezeichnet man diesen Wert nicht explizit ist der \texttt{default} Name \emph{name}
\item
  \texttt{values\_to} analog zu \texttt{names\_to}
\item
  \texttt{names\_prefix} erm√∂glicht es die Spaltennamen von bestimmten Buchstaben zu befreien. So wird durch unseren Befehl oben aus ``st10'' nun ``10''.
\end{itemize}

Wir haben es also fast geschafft. Unsere Spalte \texttt{depth} ist allerdings vom Typ \texttt{character} und es w√§re praktischer diesen in einem numerischen Format zu haben. Dies geht durch das zus√§tzliche Argument \texttt{names\_transform}, wo in Form eine Liste angegeben werden kann wie der Objekttyp definiert werden soll.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(date, }\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{), }\AttributeTok{names\_to =} \StringTok{"depth"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"value"}\NormalTok{, }\AttributeTok{names\_prefix =} \StringTok{"st"}\NormalTok{, }\AttributeTok{names\_transform =} \FunctionTok{list}\NormalTok{(}\AttributeTok{depth =}\NormalTok{ as.integer)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{10}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 10 x 3}
\DocumentationTok{\#\#    date                depth value}
\DocumentationTok{\#\#    \textless{}dttm\textgreater{}              \textless{}int\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\#  1 2010{-}04{-}01 00:00:00    10  7.42}
\DocumentationTok{\#\#  2 2010{-}04{-}01 00:00:00    20  7.28}
\DocumentationTok{\#\#  3 2010{-}04{-}01 00:00:00    30  6.98}
\DocumentationTok{\#\#  4 2010{-}04{-}01 00:00:00    60  6.13}
\DocumentationTok{\#\#  5 2010{-}04{-}01 00:00:00   100  5.55}
\DocumentationTok{\#\#  6 2010{-}04{-}01 00:00:00   150  5.44}
\DocumentationTok{\#\#  7 2010{-}04{-}01 01:00:00    10  7.21}
\DocumentationTok{\#\#  8 2010{-}04{-}01 01:00:00    20  7.24}
\DocumentationTok{\#\#  9 2010{-}04{-}01 01:00:00    30  6.99}
\DocumentationTok{\#\# 10 2010{-}04{-}01 01:00:00    60  6.12}
\end{Highlighting}
\end{Shaded}

\hypertarget{pivot_wider---wider-data-format}{%
\subsection{pivot\_wider() - wider data format}\label{pivot_wider---wider-data-format}}

Die Syntax ist √§hnlich wie bei \texttt{pivot\_longer} aufgebaut, mit den Argumenten

\begin{itemize}
\tightlist
\item
  data
\item
  id\_cols
\item
  names\_from
\item
  names\_prefix
\item
  names\_sep
\item
  \ldots{}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Daten in einem long format}
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rownames\_to\_column}\NormalTok{(}\StringTok{"name"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\#                name  mpg cyl disp  hp drat    wt  qsec vs am gear carb}
\DocumentationTok{\#\# 1         Mazda RX4 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4}
\DocumentationTok{\#\# 2     Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4}
\DocumentationTok{\#\# 3        Datsun 710 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1}
\DocumentationTok{\#\# 4    Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1}
\DocumentationTok{\#\# 5 Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2}
\CommentTok{\# Daten in einem wide format}
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rownames\_to\_column}\NormalTok{(}\StringTok{"name"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(name, mpg) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ name, }\AttributeTok{values\_from =}\NormalTok{ mpg)}
\DocumentationTok{\#\# \# A tibble: 1 x 32}
\DocumentationTok{\#\#   \textasciigrave{}Mazda RX4\textasciigrave{} \textasciigrave{}Mazda RX4 Wag\textasciigrave{} \textasciigrave{}Datsun 710\textasciigrave{} \textasciigrave{}Hornet 4 Drive\textasciigrave{} \textasciigrave{}Hornet Sportabout\textasciigrave{}}
\DocumentationTok{\#\#         \textless{}dbl\textgreater{}           \textless{}dbl\textgreater{}        \textless{}dbl\textgreater{}            \textless{}dbl\textgreater{}               \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1          21              21         22.8             21.4                18.7}
\DocumentationTok{\#\# \# ... with 27 more variables: Valiant \textless{}dbl\textgreater{}, Duster 360 \textless{}dbl\textgreater{}, Merc 240D \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   Merc 230 \textless{}dbl\textgreater{}, Merc 280 \textless{}dbl\textgreater{}, Merc 280C \textless{}dbl\textgreater{}, Merc 450SE \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   Merc 450SL \textless{}dbl\textgreater{}, Merc 450SLC \textless{}dbl\textgreater{}, Cadillac Fleetwood \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   Lincoln Continental \textless{}dbl\textgreater{}, Chrysler Imperial \textless{}dbl\textgreater{}, Fiat 128 \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   Honda Civic \textless{}dbl\textgreater{}, Toyota Corolla \textless{}dbl\textgreater{}, Toyota Corona \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   Dodge Challenger \textless{}dbl\textgreater{}, AMC Javelin \textless{}dbl\textgreater{}, Camaro Z28 \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   Pontiac Firebird \textless{}dbl\textgreater{}, Fiat X1{-}9 \textless{}dbl\textgreater{}, Porsche 914{-}2 \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

\hypertarget{explorative-datenanalyse}{%
\section{Explorative-Datenanalyse}\label{explorative-datenanalyse}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

Bevor wir uns an das vermeintlich sch√∂nste Thema reinst√ºrzen - der Datenvisualisierung - gehen wir in diesem Kapitel auf die explorative Datenanalyse (EDA) ein.

üîç Besser als in \href{https://r4ds.had.co.nz/exploratory-data-analysis.html}{r4ds} l√§sst es sich eigentlich nicht zusammenfassen

EDA ist kein strikt vorw√§rtsgerichteter Prozess mit bestimmten Regeln. Vielmehr geht es darum mit dem Datensatz zu spielen, Ideen zu erkunden, diese f√ºr gut oder schlecht zu befinden, um die vielversprechendsten Ans√§tze dem Publikum n√§her zu bringen. Was man hierbei nicht vergessen darf ist auch die √úberpr√ºfung der \emph{Datenqualit√§t}, bspw. ob die Daten mit derselben Methoden erhoben wurden, bezieht man sich auf dieselben Einheiten und gibt es Fehlwerte (\texttt{NA}s), die eine Analyse des Datensatzes in ein zweifelhaftes Licht r√ºcken.

\begin{quote}
``There are no routine statistical questions, only questionable statistical routines.'' --- Sir David Cox
\end{quote}

\begin{quote}
``Far better an approximate answer to the right question, which is often vague, than an exact answer to the wrong question, which can always be made precise.'' --- John Tukey
\end{quote}

Zentrales Ziel der EDA ist es, ein Verst√§ndnis f√ºr die Daten zu erlangen auf einem m√∂glichst kreativen Weg.

\hypertarget{fehlende-werte-1}{%
\subsection{Fehlende Werte}\label{fehlende-werte-1}}

Elektroden und Ger√§tschaften im Gel√§nde sind wie Menschen - sie wollen gut gepflegt werden aber auch bei bester Pflege machen sie nicht immer das was sie tun sollen. Starten wir also damit zu erkunden, wieviele Fehlwerte wir in unserem Speicherkoog Datensatz haben. Der erste Weg w√§re zu erkunden, ob √ºberhaupt \texttt{NA}s in unserem Datensatz auftreten:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Tritt ein NA in unserem Vektor auf}
\FunctionTok{any\_na}\NormalTok{(koog}\SpecialCharTok{$}\NormalTok{st10)}
\DocumentationTok{\#\# [1] TRUE}
\end{Highlighting}
\end{Shaded}

Es befinden sich also Fehlwerte in st10.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Mit are\_na bekommen wir einen Vektor mit TRUE und FALSE √ºber NA Werte angezeigt}
\FunctionTok{are\_na}\NormalTok{(koog}\SpecialCharTok{$}\NormalTok{st10) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{10}\NormalTok{)}
\DocumentationTok{\#\#  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE}
\end{Highlighting}
\end{Shaded}

Wir k√∂nnen uns auch eine Prozentzahl angeben lassen, indem wir die Anzahl der NA Werte in unserem Vektor durch die L√§nge des Vektors teilen:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{n\_miss}\NormalTok{(koog}\SpecialCharTok{$}\NormalTok{st10) }\SpecialCharTok{/} \FunctionTok{nrow}\NormalTok{(koog) }\SpecialCharTok{*} \DecValTok{100}
\DocumentationTok{\#\# [1] 2.546093}
\end{Highlighting}
\end{Shaded}

Es fehlen also 2.5\% Der Daten. Das ist erstmal nicht viel. Mithilfe des \texttt{vis\_dat} packages kann man schnell und leicht √ºberpr√ºfen wie die zeitliche Verteilung der Werte ist. Es spielt schlie√ülich schon eine Rolle, ob ich jeden Tag einen systematischen Fehlwert habe oder die Fehlwerte en block w√§hrend einer bestimmten Periode auftreten.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(st10) }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  visdat}\SpecialCharTok{::}\FunctionTok{vis\_miss}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-164-1} \end{center}

Wir sehen also, dass 2,5\% des Datensatzes keine Werte enthalten und f√ºr nur kurze Perioden auftreten. F√ºr die elektrische Leitf√§higkeit \texttt{ec} ist dies leider nicht der Fall. Speziell zu Beginn der Untersuchung gab es immer wieder Ausf√§lle. Diese Werte sind also im Allgemeinen mit Vorsicht zu bewerten.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(ec) }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  visdat}\SpecialCharTok{::}\FunctionTok{vis\_miss}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-165-1} \end{center}

Tabellarisch kann man sich die Daten nat√ºrlich auch angeben lassen:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{contains}\NormalTok{(}\StringTok{"oxy"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{miss\_var\_summary}\NormalTok{(}\AttributeTok{order =}\NormalTok{ T) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 3}
\DocumentationTok{\#\#   variable n\_miss pct\_miss}
\DocumentationTok{\#\#   \textless{}chr\textgreater{}     \textless{}int\textgreater{}    \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 x44       94537   100   }
\DocumentationTok{\#\# 2 lt        69452    73.5 }
\DocumentationTok{\#\# 3 bat       69451    73.5 }
\DocumentationTok{\#\# 4 ec        20429    21.6 }
\DocumentationTok{\#\# 5 wt\_2       8002     8.46}
\end{Highlighting}
\end{Shaded}

\hypertarget{datenvisualisierung}{%
\section{Datenvisualisierung}\label{datenvisualisierung}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

üö® Das folgende Kapitel mit Vorsicht genie√üen! Wenn ich meine Sache gut mache, dann ergibt sich ein gro√ües Suchtpotenzial!

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/050} 

}

\caption{Source from: https://xkcd.com/523/}\label{fig:unnamed-chunk-169}
\end{figure}

üîç Wie immer ist jedem die Literatur von Hadly Wickham ans Herz gelegt \href{https://ggplot2-book.org/introduction.html}{ggplot2: Elegant Graphics for Data Analysis}

√úber die M√∂glichkeiten eine Basis-Abbildung aufzupimpen ist dieser \href{https://www.cedricscherer.com/2019/05/17/the-evolution-of-a-ggplot-ep.-1/}{Blogbeitrag} und dieser \href{https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/\#colors}{Blogbeitrag} ans Herz gelegt.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/053} 

}

\caption{Source from: https://www.cedricscherer.com/}\label{fig:unnamed-chunk-170}
\end{figure}

\hypertarget{ggplot2---grammar-of-graphics}{%
\subsection{ggplot2 - grammar of graphics}\label{ggplot2---grammar-of-graphics}}

ggplot2 basiert auf der \textbf{g}rammar of \textbf{g}raphics und ist ein statistisches Paket um Daten zu visualisieren. Es bietet extrem viele M√∂glichkeiten, Daten auf verschiedenste Weise darzustellen und auch zu transformieren, ohne etwas an den Rohdaten zu ver√§ndern. Der Workflow bei ggplot2 folgt dabei einer Logik und Reihenfolge die es einem erlaubt, in einem iterativen Ansatz identische Abbildungen f√ºr √§hnliche Probleme zu gestalten.

Die Grammatik hinter \texttt{ggplot} zu verstehen ist dabei hilfreich um noch effektiver, schneller und anschaulicher Abbildungen zu erstellen. Das Prinzip sind \textbf{Layer}, also verschiedene Ebenen, die eine Abbildung aufbauen.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/051} 

}

\caption{Source from: http://bloggotype.blogspot.com/}\label{fig:unnamed-chunk-171}
\end{figure}

Alle Abbildungen bestehen aus \textbf{data} mit den Informationen, welche dargestellt werden und \textbf{mapping}, eine Beschreibung wie die Daten durch Aesthetics dargestellt werden. Es gibt f√ºnf Komponenten f√ºr das mapping von Daten:

\begin{itemize}
\tightlist
\item
  \textbf{Layer} beinalten geometrische Elemente (\textbf{geom}s), bspw. \texttt{point}, \texttt{line}, \texttt{bar}, \texttt{boxplot}, \ldots{} und statistische Transformationen (\textbf{stat}s).
\item
  \textbf{Scales} beschreiben Werte im Datenraum und setzen sie zu den Aesthetics in Bezug. Dazu geh√∂ren die Verwendung von Farbe, Form, Gr√∂√üe. Scales beeinflussen ebenfalls die Legende und Achsen.
\item
  \textbf{Coord} beinhaltet das Koordinatensystem, bspw. ob Hilfslinien gezogen werden sollen oder ob neben dem klassischen Kartesischen Koordinatensystem Polar oder andere Kartenprojektionen verwendet werden.
\item
  \textbf{Facet} beschreibt wie Gruppen anhand der Daten verteilt und differenziert dargestellt werden sollen.
\item
  \textbf{Theme} modifiziert die Abbildungen um Textgr√∂√üe, Position, Farbhintergrund und vieles vieles mehr.
\end{itemize}

\hypertarget{schluxfcsselkomponenten}{%
\subsubsection{Schl√ºsselkomponenten}\label{schluxfcsselkomponenten}}

Jeder ggplot2 Aufruf ben√∂tigt drei Komponenten.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{data}
\item
  \textbf{aesthetics} die beschreiben, wie die Daten im Koordinatenraum platziert werden.
\item
  \textbf{geoms} zur Darstellung der Daten.
\end{enumerate}

Der Datensatz sollte und liegt in den meisten F√§llen tabular vor, also mit Zeilen (= observations) und Spalten (=variables), wobei jede Zelle einen eigenen Wert codiert (= value). Das Datenobjekt in R nennt sich \texttt{data.frame} oder neuerdings auch als eine etwas besser verkn√ºpfte Variante im tidyverse \texttt{tibble}.

Hier ein simples Beispiel unter Verwendung des Speicherkoog Datensatzes:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Verwende den Speicherkoogdatensatz auf Tagesbasis}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ koog\_day)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-172-1} \end{center}

Komisch? Wieso ist die Abbildung denn leer? ü§Ø Ach ja, wir m√ºssen bei den Aestehtics noch festlegen, welche Variablen auf welche Achse geplottet werden sollen. Dazu setzen wir das Argument \texttt{aes()} was x = und was y = sein soll. Nehmen wir mal Das Datum auf Tagesbasis und die Bodentemperatur in 10 cm:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ koog\_day, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ daily, }\AttributeTok{y =}\NormalTok{ st10))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-173-1} \end{center}

H√§√§√§? Immer noch leer.

ggplot fehlt der \textbf{geom} Layer um zu wissen, wie die Daten in das Koordinatensstem √ºbertragen werden sollen:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ koog\_day, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ daily, }\AttributeTok{y =}\NormalTok{ st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-174-1} \end{center}

üéâ Herzlichen Gl√ºckwunsch zu deiner ersten ggplot Abbildung! Wir k√∂nnen diesen Abschnitt auch als eigenes Objekt speichern \texttt{ggplot(data\ =\ koog\_day,\ aes(x\ =\ daily,\ y\ =\ st10))} und fortlaufend editieren.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ koog\_day, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ daily, }\AttributeTok{y =}\NormalTok{ st10))}
\CommentTok{\# Erstelle ein Liniendiagram}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-175-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Boxplotdiagram}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-175-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# S√§ulendiagram}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_col}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-175-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Fl√§chendiagram}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_area}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-175-4} \end{center}

\ldots{} und viele weitere. Man kann dabei auch mehrere geoms in einem Plot erstellen:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_boxplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =}\NormalTok{ year))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-176-1} \end{center}

O, viel kann man jetzt nicht erkennen. Der Layer mit dem Boxplot liegt √ºber unserem Liniendiagramm. Was passiert wenn wir die Abfolge der Layer √§ndern?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_boxplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =}\NormalTok{ year)) }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-177-1} \end{center}

Wir k√∂nnen das farblich noch etwas besser darstellen:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ koog\_day, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ daily, }\AttributeTok{y =}\NormalTok{ st10, }\AttributeTok{group =}\NormalTok{ year)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{fill =} \StringTok{"grey"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{data =}\NormalTok{ koog\_year, }\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\FunctionTok{paste}\NormalTok{(year, }\DecValTok{06}\NormalTok{, }\DecValTok{15}\NormalTok{, }\AttributeTok{sep =} \StringTok{"{-}"}\NormalTok{)), st10), }\AttributeTok{shape =} \DecValTok{21}\NormalTok{, }\AttributeTok{fill =} \StringTok{"white"}\NormalTok{, }\AttributeTok{size =} \DecValTok{6}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-178-1} \end{center}

üö® Alles was von den Daten visualisiert werden soll MUSS in den aes() Aufruf geschrieben werden.

üö® Die Reihenfolge der Layer ist entscheident, wie der Plot sp√§ter aussieht.

Das Jahr 2013 war also relativ kalt und das Jahr 2014 das w√§rmste in der Zeitreihe.

Wollen wir bspw. die Bodentemperatur \textgreater= 10 ¬∞C in einer anderen Farbe darstellen, dann muss dies in den aes() Aufruf hinterlegt werden, da wir diese Informationen von den Daten extrahieren:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Das funktioniert nicht}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ koog\_day, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ daily, }\AttributeTok{y =}\NormalTok{ st10), }\AttributeTok{color =}\NormalTok{ st10 }\SpecialCharTok{\textgreater{}} \DecValTok{10}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-179-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Das funktioniert}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ koog\_day, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ daily, }\AttributeTok{y =}\NormalTok{ st10, }\AttributeTok{color =}\NormalTok{ st10 }\SpecialCharTok{\textgreater{}} \DecValTok{10}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-179-2} \end{center}

√Ñhnlich verh√§lt es sich bei der farblichen Darstellung einer Variable. M√∂chte ich der Bodentemperatur den fixen Wert einer Farbe blau zuordnen, dann MUSS dies au√üerhalb des aes() Aufrufes erfolgen:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Das funktinoert nicht}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ koog\_day, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ daily, }\AttributeTok{y =}\NormalTok{ st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =} \StringTok{"blue"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-180-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Das funktioniert}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ koog\_day, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ daily, }\AttributeTok{y =}\NormalTok{ st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{colour =} \StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-180-2} \end{center}

\hypertarget{aesthetics-color-size-shape}{%
\subsubsection{Aesthetics (color, size, shape)}\label{aesthetics-color-size-shape}}

Um zus√§tzliche Informationen einem plot hinzuzuf√ºgen, kann man im \texttt{aes()} Argument folgende Befehle setzen:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Farbe}
\FunctionTok{ggplot}\NormalTok{(koog\_day, }\FunctionTok{aes}\NormalTok{(daily, st10, }\AttributeTok{color =}\NormalTok{ st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-181-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Gr√∂√üe}
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(daily }\SpecialCharTok{\textless{}} \StringTok{"2010{-}06{-}30"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, st10, }\AttributeTok{size =}\NormalTok{ st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-181-2} \end{center}

Die Form (\textbf{shape}) kann man auch beeinflussen, allerdings nicht mit einer kontinuierlichen Variable wie Bodentemperatur. Daher schauen wir uns den \texttt{mtcars} Datensatz an:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Stelle Allrad, Front{-} und Heckantriebler in unterschiedlichen Formen dar}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(displ, hwy, }\AttributeTok{shape =}\NormalTok{ drv)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-182-1} \end{center}

\hypertarget{smoothers-and-models}{%
\subsubsection{Smoothers and models}\label{smoothers-and-models}}

Manchmal ist ein Trend aus den Daten nicht unbedingt gut zu erkennen. Nehmen wir das Beispiel Grundwasserstand und E\textsubscript{H} in 60 cm Tiefe:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_day  }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(wt, eh100a)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-183-1} \end{center}

Die Funktion \texttt{geom\_smooth()} plottet als default eine Loess Kurve, welches eine lokale Regression der Daten ist:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_day  }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(wt, eh60a)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# Durch den Alpha Wert k√∂nnen wir den Punkten Transparenz geben}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{size =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-184-1} \end{center}

So l√§sst sich besser erkennen und filtern, dass bei 75 cm im Mittel das E\textsubscript{H} beginnt abzusinken. Wollen wir anstelle der Loess Kurve eine lineare Regression verwenden m√ºssen wir das als Argument definieren:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_day  }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(wt, eh60a)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# Durch den Alpha Wert k√∂nnen wir den Punkten Transparenz geben}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{size =} \DecValTok{2}\NormalTok{, }\AttributeTok{method =} \StringTok{"lm"}\NormalTok{) }\CommentTok{\# lm = linear model}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-185-1} \end{center}

E\textsubscript{H} und Grundwasserstand sind also negativ korreliert.

\hypertarget{labels}{%
\subsubsection{Labels}\label{labels}}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/052} 

}

\caption{Source from: https://xkcd.com/833/}\label{fig:unnamed-chunk-186}
\end{figure}

Bisher haben wir gesehen, dass ggplot als \texttt{default} die Achsenbezeichnung (Spaltenname) in den aesthetics benutzt, um die Achsen zu beschriften.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_day  }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(wt, eh60a)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# Durch den Alpha Wert k√∂nnen wir den Punkten Transparenz geben}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{size =} \DecValTok{2}\NormalTok{, }\AttributeTok{method =} \StringTok{"lm"}\NormalTok{) }\CommentTok{\# lm = linear model}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-187-1} \end{center}

\texttt{wt} kann jedoch alles bedeuten und welche Einheit dahintersteckt erschlie√üt sich auch nicht. Eine gute Achsenbeschriftung ist extrem wichtig und kann wie folgt umgesetzt werden:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day  }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(wt, eh60a)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# Durch den Alpha Wert k√∂nnen wir den Punkten Transparenz geben}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{size =} \DecValTok{2}\NormalTok{, }\AttributeTok{method =} \StringTok{"lm"}\NormalTok{) }\SpecialCharTok{+}\CommentTok{\# lm = linear model}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Eine klasse Abbildung"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Grundwasserflurabstand (cm u. GOK)"}\NormalTok{, }
    \AttributeTok{y =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(E[H], }\StringTok{" (mV)"}\NormalTok{))}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

Mit der Funktion \texttt{expression()} k√∂nnen wir Sonderzeichen setzen aber auch Zahlen hoch oder tiefstellen. Durch das Setzen der Zahl in eine eckige Klammer \texttt{{[}{]}} tiefstellen und durch \texttt{\^{}} hochstellen. Wollen wir diese Sonderzeichen mit normalem Text verkn√ºpfen, dann behelfen wir uns mit der Funktion \texttt{paste()}. Die Einzelnen Bauteile des Satzes werden durch \texttt{,} getrennt.

üîç \href{http://rchaeology.blogspot.com/2012/11/combining-superscripts-subscripts-and.html}{http://rchaeology.blogspot.com}

\hypertarget{themes}{%
\subsubsection{Themes}\label{themes}}

\texttt{ggplot2} hat bereits eine Vielzahl integrierter themes. Ein theme beeinflusst das Erscheinungsbild der Abbildung.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# schwarz/wei√ü}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-189-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# klassisch}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-189-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Cleveland}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme\_cleveland}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-189-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Komplett ohne Achsen etc. }
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme\_void}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-189-4} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# F√ºr die Excel Nostalgie}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme\_excel}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-189-5} \end{center}

Und noch eine weitere Vielzahl. Wir sind auf diese themese aber nicht begrenzt, sondern k√∂nnen alles editieren. Wollen wir die Farbe des Textes in rot √§ndern, m√ºssen wir folgendes tun:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"red"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-190-1} \end{center}

Auf diese Art k√∂nnen wir alle Bestandteile einer Abbildung ver√§ndern:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plotfarbe}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"lightblue"}\NormalTok{,}
                                \AttributeTok{colour =} \StringTok{"lightblue"}\NormalTok{,}
                                \AttributeTok{size =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"solid"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-191-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Hintergrundfarbe }
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"lightblue"}\NormalTok{,}
                                \AttributeTok{colour =} \StringTok{"lightblue"}\NormalTok{,}
                                \AttributeTok{size =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"solid"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-191-2} \end{center}

Zu Beginn einer R Session oder eines Skriptes kann man sich auch ein modifiziertes theme speichern und auf diese einfach zur√ºckgreifen:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Setze das theme}
\NormalTok{kristofs\_theme\_des\_jahres }\OtherTok{\textless{}{-}} \FunctionTok{theme}\NormalTok{(}
  \AttributeTok{panel.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"yellow"}\NormalTok{, }\AttributeTok{color =} \StringTok{"red"}\NormalTok{),}
  \AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(), }
  \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(), }
  \AttributeTok{panel.border =} \FunctionTok{element\_blank}\NormalTok{())}
\CommentTok{\# Wende es auf unseren Plot an}
\NormalTok{p }\SpecialCharTok{+}\NormalTok{ kristofs\_theme\_des\_jahres}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-192-1} \end{center}

\hypertarget{facets}{%
\subsubsection{Facets}\label{facets}}

Facets sind \emph{multi-panel-plots} und lassen sich am besten auf diskrete Variablen √ºbertragen.

üí° Facets sind gro√üartig um plots √ºberschaulicher zu gestalten.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Plotte Farbe zu den Daten}
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(hp, mpg, }\AttributeTok{color =}\NormalTok{ cyl)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-193-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle facets nach der Variable cyl (Zylinder)}
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(hp, mpg, }\AttributeTok{color =}\NormalTok{ cyl)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{cyl)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-193-2} \end{center}

So ist es direkt ersichtlich, je mehr Zylinder desto mehr PS und desto h√∂her ist der Verbrauch. Mit einem 8-Zylinder muss man beim Tanken schon etwas tiefer in die Tasche greifen. Die Variable nach der das facetting stattfindet wird mit der Tile \texttt{\textasciitilde{}} verkn√ºpft. \texttt{facet\_grid} ist am besten f√ºr viele Variablen in Form einer Matrix (m x n) und \texttt{facet\_wrap} f√ºr eine Variable wobei die Anzahl der Spalten (\texttt{ncol}) und Zeilen (\texttt{nrow}) definiert werden kann. Auch ob die Skala an die Zahlen des facets angepasst werden sollen.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle facets nach der Variable cyl (Zylinder)}
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(hp, mpg, }\AttributeTok{color =}\NormalTok{ cyl)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{cyl, }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{scales =} \StringTok{"free\_y"}\NormalTok{) }\CommentTok{\# Arrangiere die Plots untereinander und Autoskalierung}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-194-1} \end{center}

üí° Um die Variablennamen nach denen das facetting stattfindet nicht in den Rohdaten durchzuf√ºhren, gibt es das Argument \texttt{labbeler\ =}. Das ist praktisch um die Plot zu annotieren:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle einen Vektor (col\_name) mit den Namen, die ge√§ndert werden sollen}
\NormalTok{col\_name }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"4"} \OtherTok{=} \StringTok{"gut"}\NormalTok{, }\StringTok{"6"} \OtherTok{=} \StringTok{"besser"}\NormalTok{, }\StringTok{"8"} \OtherTok{=} \StringTok{"am besten"}\NormalTok{)}

\CommentTok{\# Erstelle facets nach der Variable cyl (Zylinder)}
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(hp, mpg, }\AttributeTok{color =}\NormalTok{ cyl)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{cyl, }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{scales =} \StringTok{"free\_y"}\NormalTok{, }\AttributeTok{labeller =} \FunctionTok{as\_labeller}\NormalTok{(col\_name)) }
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-195-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# F√ºge den col\_name vector dem labeller Argument hinzu}
\end{Highlighting}
\end{Shaded}

\hypertarget{coordinate-system}{%
\subsubsection{Coordinate system}\label{coordinate-system}}

Fast ausschlie√ülich arbeitet man mit dem klassichen kartesischen Koordinatensystem. Ein Trick die Achsen zu vertauschen geht mit \texttt{coord\_flip()}:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Normal}
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(mpg, hp)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-196-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Achsen tauschen}
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(mpg, hp)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{coord\_flip}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-196-2} \end{center}

Man kann auch in einen Teil des plots ``zoomen'', wobei mit \texttt{coord\_cartesian()} keine Neuberechnung stattfindet gegen√ºber scale limits oder xlim:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(displ, cty)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{geom\_smooth}\NormalTok{()}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \DecValTok{4}\NormalTok{, }\AttributeTok{linetype =} \DecValTok{2}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \DecValTok{6}\NormalTok{, }\AttributeTok{linetype =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-197-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{xlim}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{6}\NormalTok{)) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"xlim"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-197-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{6}\NormalTok{)) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"scale limits"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-197-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{xlim =} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{6}\NormalTok{)) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"coord\_cartesian"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-197-4} \end{center}

\hypertarget{annotations}{%
\subsubsection{Annotations}\label{annotations}}

Die Funktion \texttt{annotate()} ist hilfreich, um Dinge hervorzuheben und dem Leser einen schnelleren Zugang zu der Hauptaussage einer Abbildung zu geben:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(displ, hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{data =} \FunctionTok{subset}\NormalTok{(mpg, manufacturer }\SpecialCharTok{==} \StringTok{"subaru"}\NormalTok{), }
             \AttributeTok{colour =} \StringTok{"orange"}\NormalTok{,}
             \AttributeTok{size =} \DecValTok{3}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{annotate}\NormalTok{(}\AttributeTok{geom =} \StringTok{"curve"}\NormalTok{, }
           \AttributeTok{x =} \DecValTok{4}\NormalTok{, }\AttributeTok{y =} \DecValTok{35}\NormalTok{, }\AttributeTok{xend =} \FloatTok{2.65}\NormalTok{, }\AttributeTok{yend =} \DecValTok{27}\NormalTok{, }
           \AttributeTok{curvature =} \FloatTok{0.3}\NormalTok{, }\AttributeTok{arrow =} \FunctionTok{arrow}\NormalTok{(}\AttributeTok{length =} \FunctionTok{unit}\NormalTok{(}\DecValTok{2}\NormalTok{, }\StringTok{"mm"}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\AttributeTok{geom =} \StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \FloatTok{4.1}\NormalTok{, }\AttributeTok{y =} \DecValTok{35}\NormalTok{, }\AttributeTok{label =} \StringTok{"subaru"}\NormalTok{, }\AttributeTok{hjust =} \StringTok{"left"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-198-1} \end{center}

Farben √ºber facets zu colorieren mit den Daten in grau als Hintergrund ist ebenfalls m√∂glich:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(displ, hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{data =}\NormalTok{ mpg[}\FunctionTok{c}\NormalTok{(}\StringTok{"displ"}\NormalTok{, }\StringTok{"hwy"}\NormalTok{)], }\AttributeTok{color =} \StringTok{"grey"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{colour =} \FunctionTok{factor}\NormalTok{(cyl))) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{cyl)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-199-1} \end{center}

\hypertarget{verknuxfcfpen-von-tidyverse-und-ggplot}{%
\subsection{Verkn√ºfpen von tidyverse und ggplot}\label{verknuxfcfpen-von-tidyverse-und-ggplot}}

\texttt{ggplot2::} ist ein package aus dem tidyverse und die √§hnliche Syntax erlaubt es, Befehle der Datenmanipulation direkt mit der graphischen Darstellung in ggplot umzusetzen. Um die Befehle in einem ggplot Aufruf zu verkn√ºpfen wird das \texttt{+} verwendet, welches anders ist als im restlichen tidyverse wo der pipe Operator verwendet wird (\texttt{\%\textgreater{}\%}). Wollen wir also unseren Datensatz der Bodentemperatur nur auf das Jahr 2011 begrenzen, geht dies folgenderma√üen:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Filter f√ºr das Jahr 2011}
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(daily }\SpecialCharTok{\textgreater{}} \StringTok{"2011{-}01{-}01"} \SpecialCharTok{\&}\NormalTok{ daily }\SpecialCharTok{\textless{}} \StringTok{"2011{-}12{-}31"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-200-1} \end{center}

F√ºr manche Abbildung macht es Sinn die Datenbereinigung im Vorfeld durchzuf√ºhren und dies als eigenes Objekt zu speichern (bspw. \texttt{koog\_day\_2011} f√ºr das Jahr 2011; speziell wenn man auf diesen Datensatz h√§ufiger zur√ºckgreift) oder man verkn√ºpft es immer wieder aufs Neue mit dem \texttt{\%\textgreater{}\%}.

\hypertarget{arbeiten-mit-zeiten-1}{%
\subsection{Arbeiten mit Zeiten}\label{arbeiten-mit-zeiten-1}}

Man h√§tte dieses Kapitel auch bei dem Kapitel Daten manipulieren bringen k√∂nnen. Habe ich aber nicht. Warum? Zeiten sind nicht nur wichtig um Daten zu gruppieren und Statistik damit zu betreiben, sondern auch die Darstellung bei einer Abbildung muss ad√§quat dargestellt werden. Das wichtigste package um mit Zeiten zu arbeiten lautet \texttt{lubridate::}. Schauen wir uns ein subset vom Speicherkoog an:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{time }\OtherTok{\textless{}{-}}\NormalTok{ readr}\SpecialCharTok{::}\FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/data.csv"}\NormalTok{, }\AttributeTok{delim =} \StringTok{";"}\NormalTok{)}
\NormalTok{time }\OtherTok{\textless{}{-}}\NormalTok{ time }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(date, ST10) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{clean\_names}\NormalTok{()}

\FunctionTok{head}\NormalTok{(time, }\DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 2}
\DocumentationTok{\#\#   date              st10}
\DocumentationTok{\#\#   \textless{}chr\textgreater{}            \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 01.04.2010 00:00  7.42}
\DocumentationTok{\#\# 2 01.04.2010 01:00  7.21}
\DocumentationTok{\#\# 3 01.04.2010 02:00  7.01}
\DocumentationTok{\#\# 4 01.04.2010 03:00  6.91}
\DocumentationTok{\#\# 5 01.04.2010 04:00  6.81}
\FunctionTok{class}\NormalTok{(time}\SpecialCharTok{$}\NormalTok{date)}
\DocumentationTok{\#\# [1] "character"}
\end{Highlighting}
\end{Shaded}

Wir sehen, dass der Zeitstempel in unserem Objekt \texttt{time} \texttt{character} ist. In R ist dies kein g√ºltiges Zeitformat, obwohl Zeitstempel in Rohdaten fast immer als \texttt{string} angegeben werden. Die drei grundlegenden Objekttypen f√ºr Zeiten in R lauten:

\begin{itemize}
\tightlist
\item
  \texttt{date} = Angabe als ``'' in einem tibble.
\item
  \texttt{time} = Angabe als ``'' in einem tibble.
\item
  \texttt{date-time} = Angabe als ``'' in einem tibble. Auch \texttt{POSIXct} genannt.
\end{itemize}

üí° Verwende immer den einfachsten Zeittyp, der deine Voraussetzungen erf√ºllt.

Es gibt drei M√∂glichkeiten, wo die Umwandlung zu einen \texttt{date} Objekt eine Rolle spielt. (i) Umwandlung von einem string, (ii) von individuellen Komponenten und (iii) von einem bestehenden date/time Objekt:

\hypertarget{strings}{%
\subsubsection{strings}\label{strings}}

Im deutschen w√§re eine Zeitangabe \texttt{01.04.2010} aber die internationale und in R codierte Art dieses wiederzugeben lautet \texttt{2010-04-01}. Die einfachste Art dies wiederzugeben lautet:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{time\_char }\OtherTok{\textless{}{-}} \StringTok{"01.04.2010"}
\FunctionTok{class}\NormalTok{(time\_char)}
\DocumentationTok{\#\# [1] "character"}

\NormalTok{time\_date }\OtherTok{\textless{}{-}}\NormalTok{ lubridate}\SpecialCharTok{::}\FunctionTok{as\_date}\NormalTok{(time\_char, }\AttributeTok{format =} \StringTok{"\%d.\%m.\%Y"}\NormalTok{)}
\FunctionTok{class}\NormalTok{(time\_date)}
\DocumentationTok{\#\# [1] "Date"}
\end{Highlighting}
\end{Shaded}

Bei dem Argument \texttt{format\ =\ ...} haben wir angegeben, wie das Datum hinterlegt ist und nun haben wir erfolgreich ein \texttt{date} Objekt erstellt.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{time\_char }\OtherTok{\textless{}{-}} \StringTok{"01.04.2010 01:00:00"}
\FunctionTok{class}\NormalTok{(time\_char)}
\DocumentationTok{\#\# [1] "character"}

\NormalTok{time\_date }\OtherTok{\textless{}{-}}\NormalTok{ lubridate}\SpecialCharTok{::}\FunctionTok{as\_datetime}\NormalTok{(time\_char, }\AttributeTok{format =} \StringTok{"\%d.\%m.\%Y \%H:\%M:\%S"}\NormalTok{)}
\FunctionTok{class}\NormalTok{(time\_date)}
\DocumentationTok{\#\# [1] "POSIXct" "POSIXt"}
\end{Highlighting}
\end{Shaded}

Falls wir zurs√§tzliche Zeitangaben zum Datum haben lautet die Funktion \texttt{as\_datetime}.

Die Liste wie Datumsangaben codiert sein k√∂nnen findet sich unter:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?strptime}
\end{Highlighting}
\end{Shaded}

Ein shortcut in lubridate geht √ºber das Arrangement von ``y'', ``m'', ``d'', um automatisch ein Datum zu erstellen. Die Position von y, m, d in Kombination mit einem Zeitstempel h, m, s, l√§sst sich flexibel verschieben:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dmy\_hms}\NormalTok{(}\StringTok{"01.04.2010 01:00:00"}\NormalTok{)}
\DocumentationTok{\#\# [1] "2010{-}04{-}01 01:00:00 UTC"}
\CommentTok{\#\textgreater{} [1] "2017{-}01{-}31"}
\FunctionTok{mdy}\NormalTok{(}\StringTok{"January 31st, 2017"}\NormalTok{)}
\DocumentationTok{\#\# [1] "2017{-}01{-}31"}
\CommentTok{\#\textgreater{} [1] "2017{-}01{-}31"}
\FunctionTok{dmy\_h}\NormalTok{(}\StringTok{"31{-}Jan{-}2017 01"}\NormalTok{)}
\DocumentationTok{\#\# [1] "2017{-}01{-}31 01:00:00 UTC"}
\CommentTok{\#\textgreater{} [1] "2017{-}01{-}31"}
\end{Highlighting}
\end{Shaded}

Die Angabe einer Zeitzone ist auch m√∂glich:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ymd}\NormalTok{(}\DecValTok{20170131}\NormalTok{, }\AttributeTok{tz =} \StringTok{"UTC"}\NormalTok{)}
\DocumentationTok{\#\# [1] "2017{-}01{-}31 UTC"}
\CommentTok{\#\textgreater{} [1] "2017{-}01{-}31 UTC"}
\end{Highlighting}
\end{Shaded}

Falls in unseren Daten nur eine Jahreszahl als \texttt{character} angegeben wird, gibt es einen Trick ein dennoch g√ºltiges Datum daraus zu formen. Mit dem Argument \texttt{truncated} l√§sst sich dennoch ein vollst√§ndiges Datum erstellen:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{yrs }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{2001}\NormalTok{, }\DecValTok{2002}\NormalTok{, }\DecValTok{2002}\NormalTok{, }\DecValTok{2002}\NormalTok{, }\DecValTok{2003}\NormalTok{, }\DecValTok{2005}\NormalTok{)}
\NormalTok{lubridate}\SpecialCharTok{::}\FunctionTok{ymd}\NormalTok{(yrs, }\AttributeTok{truncated =}\NormalTok{ 2L)}
\DocumentationTok{\#\# [1] "2001{-}01{-}01" "2002{-}01{-}01" "2002{-}01{-}01" "2002{-}01{-}01" "2003{-}01{-}01"}
\DocumentationTok{\#\# [6] "2005{-}01{-}01"}
\end{Highlighting}
\end{Shaded}

\hypertarget{von-individuellen-komponenten}{%
\subsubsection{Von individuellen Komponenten}\label{von-individuellen-komponenten}}

Manachmal sind die Zeitangaben auch auf verschiedene Spalten verteilt. Eine M√∂glichkeit ist \texttt{make\_date()} f√ºr Datum oder \texttt{make\_datetime()} f√ºr zus√§tzliche Zeitangabe:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{time\_char }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{year =} \DecValTok{2010}\NormalTok{,}
  \AttributeTok{month =} \DecValTok{4}\NormalTok{,}
  \AttributeTok{day =} \DecValTok{1}\NormalTok{, }
  \AttributeTok{hour =} \DecValTok{1}\NormalTok{,}
  \AttributeTok{minute =} \DecValTok{0}
\NormalTok{)}
\NormalTok{time\_char}
\DocumentationTok{\#\# \# A tibble: 1 x 5}
\DocumentationTok{\#\#    year month   day  hour minute}
\DocumentationTok{\#\#   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1  2010     4     1     1      0}
\CommentTok{\# Erstelle ein Datum aus den einzelnen Spalten}
\NormalTok{time\_char }\OtherTok{\textless{}{-}}\NormalTok{ time\_char }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{datetime =} \FunctionTok{make\_datetime}\NormalTok{(year,month,day,hour,minute))}
\NormalTok{time\_char}
\DocumentationTok{\#\# \# A tibble: 1 x 6}
\DocumentationTok{\#\#    year month   day  hour minute datetime           }
\DocumentationTok{\#\#   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{} \textless{}dttm\textgreater{}             }
\DocumentationTok{\#\# 1  2010     4     1     1      0 2010{-}04{-}01 01:00:00}
\end{Highlighting}
\end{Shaded}

\hypertarget{ein-bestehendes-objekt}{%
\subsubsection{Ein bestehendes Objekt}\label{ein-bestehendes-objekt}}

Das ganze l√§sst sich nat√ºrlich auch R√ºckw√§rts gestalten, sodass ich aus einem bestehenden Objekt

\begin{itemize}
\tightlist
\item
  year()
\item
  month()
\item
  mday() (day of the month)
\item
  yday() (day of the year)
\item
  wday() (day of the week)
\item
  hour()
\item
  minute()
\item
  second()
\end{itemize}

extrahieren kann.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{datetime }\OtherTok{\textless{}{-}} \FunctionTok{ymd\_hms}\NormalTok{(}\StringTok{"2016{-}07{-}08 12:34:56"}\NormalTok{)}

\FunctionTok{year}\NormalTok{(datetime)}
\DocumentationTok{\#\# [1] 2016}
\CommentTok{\#\textgreater{} [1] 2016}
\FunctionTok{month}\NormalTok{(datetime)}
\DocumentationTok{\#\# [1] 7}
\CommentTok{\#\textgreater{} [1] 7}
\FunctionTok{mday}\NormalTok{(datetime)}
\DocumentationTok{\#\# [1] 8}
\CommentTok{\#\textgreater{} [1] 8}

\FunctionTok{yday}\NormalTok{(datetime)}
\DocumentationTok{\#\# [1] 190}
\CommentTok{\#\textgreater{} [1] 190}
\FunctionTok{wday}\NormalTok{(datetime)}
\DocumentationTok{\#\# [1] 6}
\CommentTok{\#\textgreater{} [1] 6}
\end{Highlighting}
\end{Shaded}

F√ºr month() und wday() gibt es das Argument \texttt{label\ =\ T}, um den Namen anzuzeigen und mit \texttt{abbr\ =\ F} kann dieser ausgeschrieben angezeigt werden.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{month}\NormalTok{(datetime, }\AttributeTok{label =} \ConstantTok{TRUE}\NormalTok{)}
\DocumentationTok{\#\# [1] Jul}
\DocumentationTok{\#\# 12 Levels: Jan \textless{} Feb \textless{} Mrz \textless{} Apr \textless{} Mai \textless{} Jun \textless{} Jul \textless{} Aug \textless{} Sep \textless{} ... \textless{} Dez}
\CommentTok{\#\textgreater{} [1] Jul}
\CommentTok{\#\textgreater{} 12 Levels: Jan \textless{} Feb \textless{} Mar \textless{} Apr \textless{} May \textless{} Jun \textless{} Jul \textless{} Aug \textless{} Sep \textless{} ... \textless{} Dec}
\FunctionTok{wday}\NormalTok{(datetime, }\AttributeTok{label =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{abbr =} \ConstantTok{FALSE}\NormalTok{)}
\DocumentationTok{\#\# [1] Freitag}
\DocumentationTok{\#\# 7 Levels: Sonntag \textless{} Montag \textless{} Dienstag \textless{} Mittwoch \textless{} Donnerstag \textless{} ... \textless{} Samstag}
\CommentTok{\#\textgreater{} [1] Friday}
\CommentTok{\#\textgreater{} 7 Levels: Sunday \textless{} Monday \textless{} Tuesday \textless{} Wednesday \textless{} Thursday \textless{} ... \textless{} Saturday}
\end{Highlighting}
\end{Shaded}

Zeiten k√∂nnen auch gerundet werden mit den Funktionen \texttt{floor\_date()}, \texttt{round\_date()} und \texttt{ceiling\_date()}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Runden zur n√§chstm√∂glichen Einheit}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{ymd\_hms}\NormalTok{(}\StringTok{"2009{-}08{-}03 12:01:59.23"}\NormalTok{)}
\FunctionTok{round\_date}\NormalTok{(x, }\StringTok{"minute"}\NormalTok{)}
\DocumentationTok{\#\# [1] "2009{-}08{-}03 12:02:00 UTC"}
\CommentTok{\#\textgreater{} [1] "2009{-}08{-}03 12:01:00 UTC"}

\CommentTok{\# Abrunden zur angegebenen Einheit}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{ymd\_hms}\NormalTok{(}\StringTok{"2009{-}08{-}03 12:01:59.23"}\NormalTok{)}
\FunctionTok{floor\_date}\NormalTok{(x, }\StringTok{"minute"}\NormalTok{)}
\DocumentationTok{\#\# [1] "2009{-}08{-}03 12:01:00 UTC"}
\CommentTok{\#\textgreater{} [1] "2009{-}08{-}03 12:01:00 UTC"}

\CommentTok{\# Aufrunden }
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{ymd\_hms}\NormalTok{(}\StringTok{"2009{-}08{-}03 12:01:59.23"}\NormalTok{)}
\FunctionTok{ceiling\_date}\NormalTok{(x, }\StringTok{"minute"}\NormalTok{)}
\DocumentationTok{\#\# [1] "2009{-}08{-}03 12:02:00 UTC"}
\CommentTok{\#\textgreater{} "2009{-}08{-}03 12:02:00 UTC"}
\end{Highlighting}
\end{Shaded}

\hypertarget{darstellung-in-abbildungen}{%
\subsubsection{Darstellung in Abbildungen}\label{darstellung-in-abbildungen}}

Im Folgenden schauen wir uns nun den Verlauf der Bodentemperatur in 10 cm Tiefe an. Die X Achse ist lesbar, l√§sst sich aber besser darstellen:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(date }\SpecialCharTok{\textless{}} \FunctionTok{as.POSIXct}\NormalTok{(}\StringTok{"2010{-}04{-}30 23:00"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(date, st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\NormalTok{p}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-212-1} \end{center}

Die Funktion die wir daf√ºr ben√∂tigen lautet

\begin{itemize}
\tightlist
\item
  \texttt{scale\_x\_date}
\item
  \texttt{scale\_x\_datetime}
\item
  \texttt{scale\_x\_time}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{scale\_x\_date}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"1 week"}\NormalTok{)}
\CommentTok{\# Fehler: Invalid input: date\_trans works with objects of class Date only}
\end{Highlighting}
\end{Shaded}

ü§Ø Warum geht es nicht\ldots richtig! Unsere Spalte \texttt{date} ist ein \texttt{datetime} Objekt und daher muss der Funktionsaufruf lauten:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Setze die breaks w√∂chentlich}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{scale\_x\_datetime}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"1 week"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-214-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# W√∂chentliche Skalierung und KW des Jahres}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{scale\_x\_datetime}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"1 week"}\NormalTok{, }\AttributeTok{date\_labels =} \StringTok{"\%W"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-214-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Tagesbasis}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{scale\_x\_datetime}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"1 day"}\NormalTok{, }\AttributeTok{date\_labels =} \StringTok{"\%m{-}\%d"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-214-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Tagesbasis und jetzt auch lesbar}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{scale\_x\_datetime}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"4 day"}\NormalTok{, }\AttributeTok{date\_labels =} \StringTok{"\%m{-}\%d"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-214-4} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Tagesbasis und jetzt auch lesbar mit minor breaks auf Tagesbasis}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{scale\_x\_datetime}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"4 day"}\NormalTok{, }\AttributeTok{date\_labels =} \StringTok{"\%m{-}\%d"}\NormalTok{, }\AttributeTok{minor\_breaks =} \StringTok{"1 day"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-214-5} \end{center}

F√ºr alle Jahre geht dies nat√ºrlich auch:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Default plot}
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-215-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Customized plot with proper labeling}
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_date}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"1 year"}\NormalTok{, }\AttributeTok{date\_labels =} \StringTok{"\%Y"}\NormalTok{, }\AttributeTok{minor\_breaks =} \StringTok{"1 year"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-215-2} \end{center}

\hypertarget{pivoting-to-longer-format}{%
\subsection{pivoting to longer format}\label{pivoting-to-longer-format}}

Aktuell befindet sich jede Variable in \textbf{einer Spalte} und jede Messung entspricht einer Zeile. Was m√ºssen wir also tun, wenn wir die Bodentemperatur aus allen Tiefen in \textbf{einer} Abbildung darstellen wollen und nicht in mehreren?!

üí° R basiert auf einer \emph{long-format} Datendarstellung (auch gestapelt genannt), wohingegen Excel auf einem \emph{wide-format} basiert. Das Transformieren zu einem \emph{long-format} ist eine der h√§ufigsten Datentransformationen um den Datensatz \emph{tidy} zu bekommen.

Wir brauchen einen langen Vektor aller Bodentemperaturen, um diesen darzustellen und erreichen es mit der Funktion \texttt{pivot\_longer()} aus dem \texttt{tidyr::} package.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle einen langen Vektor der Bodentemperatur}
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{starts\_with}\NormalTok{(}\StringTok{"st"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# Durch helper functions k√∂nnen wir alle Spalten ausw√§hlen, die mit "st" beginnen}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, value, }\AttributeTok{color =}\NormalTok{ name)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-216-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# W√§hle nur die 10 und die 150 cm Tiefe aus durch Angabe der Spaltennamen}
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{c}\NormalTok{(}\StringTok{"st10"}\NormalTok{, }\StringTok{"st150"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# Durch helper functions k√∂nnen wir alle Spalten ausw√§hlen, die mit "st" beginnen}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, value, }\AttributeTok{color =}\NormalTok{ name)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-216-2} \end{center}

Beim pivoting k√∂nnen wir uns Informationen in den Zeilennamen auch zunutze machen, um diese in den Neuen Variablenbezeichnungen zu integrieren. Dabei empfiehlt sich eine Spaltenbeschriftung zu w√§hlen, die auf dieses Schema leicht √ºbernommen werden kann. Eine M√∂glichkeit die Bodentemperatur in 10 cm Tiefe zu codieren w√§re \texttt{st\_10}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle ein tibble im wide format}
\NormalTok{test }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{st\_10 =} \FunctionTok{rnorm}\NormalTok{(}\AttributeTok{n =} \DecValTok{10}\NormalTok{, }\AttributeTok{mean =} \DecValTok{10}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{), }
  \AttributeTok{st\_20 =} \FunctionTok{rnorm}\NormalTok{(}\AttributeTok{n =} \DecValTok{10}\NormalTok{, }\AttributeTok{mean =} \DecValTok{9}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{), }
  \AttributeTok{st\_30 =} \FunctionTok{rnorm}\NormalTok{(}\AttributeTok{n =} \DecValTok{10}\NormalTok{, }\AttributeTok{mean =} \DecValTok{8}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{) }
\NormalTok{)}
\NormalTok{test}
\DocumentationTok{\#\# \# A tibble: 10 x 3}
\DocumentationTok{\#\#    st\_10 st\_20 st\_30}
\DocumentationTok{\#\#    \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\#  1  9.35  8.13  7.99}
\DocumentationTok{\#\#  2 11.4  10.1   7.99}
\DocumentationTok{\#\#  3 11.4   6.22  8.10}
\DocumentationTok{\#\#  4 10.1   7.54  8.16}
\DocumentationTok{\#\#  5 10.4  10.9   9.03}
\DocumentationTok{\#\#  6  8.85  8.09  7.97}
\DocumentationTok{\#\#  7  9.12  9.66  7.32}
\DocumentationTok{\#\#  8 11.0  10.7   9.67}
\DocumentationTok{\#\#  9 10.8   6.99  8.12}
\DocumentationTok{\#\# 10  9.13 10.7   8.01}
\CommentTok{\# Erstelle tibble test\_long im long format}
\NormalTok{test\_long }\OtherTok{\textless{}{-}}\NormalTok{ test }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{), }\AttributeTok{names\_to =} \FunctionTok{c}\NormalTok{(}\StringTok{"Parameter"}\NormalTok{, }\StringTok{"Depth"}\NormalTok{), }\AttributeTok{values\_to =} \StringTok{"Wert"}\NormalTok{, }\AttributeTok{names\_sep =} \StringTok{"\_"}\NormalTok{) }\CommentTok{\# Gebe an wie die Informationen im Spaltenname getrennt sind}
\NormalTok{test\_long}
\DocumentationTok{\#\# \# A tibble: 30 x 3}
\DocumentationTok{\#\#    Parameter Depth  Wert}
\DocumentationTok{\#\#    \textless{}chr\textgreater{}     \textless{}chr\textgreater{} \textless{}dbl\textgreater{}}
\DocumentationTok{\#\#  1 st        10     9.35}
\DocumentationTok{\#\#  2 st        20     8.13}
\DocumentationTok{\#\#  3 st        30     7.99}
\DocumentationTok{\#\#  4 st        10    11.4 }
\DocumentationTok{\#\#  5 st        20    10.1 }
\DocumentationTok{\#\#  6 st        30     7.99}
\DocumentationTok{\#\#  7 st        10    11.4 }
\DocumentationTok{\#\#  8 st        20     6.22}
\DocumentationTok{\#\#  9 st        30     8.10}
\DocumentationTok{\#\# 10 st        10    10.1 }
\DocumentationTok{\#\# \# ... with 20 more rows}
\end{Highlighting}
\end{Shaded}

\hypertarget{good-practices}{%
\subsection{Good practices}\label{good-practices}}

üîç \href{https://clauswilke.com/dataviz/index.html}{Fundamentals of Data Visualization - Claus O. Wilke}

Ein nicht unerheblicher Teil der Menschen hat eine rot-gr√ºn Schw√§che und darum ist es gut, diese Farben nicht explizit zu verwenden. Die \href{https://www.thinkingondata.com/something-about-viridis-library/}{viridis} Farbpalette bietet tolle Farben die f√ºr √§sthetische Abbildungen zusammengestellt wurden. Eine andere M√∂glichkeit ist das package \texttt{RColorBrwer}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# default Farben}
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(hp, mpg, }\AttributeTok{color =} \FunctionTok{as.factor}\NormalTok{(gear))) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-218-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Manuell gesetzte Farben (schlechte Farbwahl)}
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(hp, mpg, }\AttributeTok{color =} \FunctionTok{as.factor}\NormalTok{(gear))) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"green"}\NormalTok{, }\StringTok{"orange"}\NormalTok{, }\StringTok{"red"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-218-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Benutze das viridis package}
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(hp, mpg, }\AttributeTok{color =} \FunctionTok{as.factor}\NormalTok{(gear))) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_viridis\_d}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-218-3} \end{center}

\begin{quote}
``There are three fundamental use cases for color in data visualizations: (i) we can use color to distinguish groups of data from each other; (ii) we can use color to represent data values; and (iii) we can use color to highlight.'' - Claus Wilke, Fundamentals of Data Visualization
\end{quote}

üö® Sei konsistent bei der Farbwahl in deinem Projekt, Manuskript, Abschlussarbeit. Das erleichtert es dem Leser deine Story oder die Aussage deiner Arbeit zu verstehen.

üö® Coloriere nur wenn es auch wirklich wichtig ist und es eine Bedeutung in der Abbildung hat.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/054} 

}

\caption{Source from: https://clauswilke.com/dataviz/index.html}\label{fig:unnamed-chunk-219}
\end{figure}

\begin{quote}
``Even if with a lot of effort we can figure out exactly which state is which, this visualization defeats the purpose of coloring. We should use color to enhance figures and make them easier to read, not to obscure the data by creating visual puzzles.''
\end{quote}

\hypertarget{speichern-eines-plots}{%
\subsection{Speichern eines plots}\label{speichern-eines-plots}}

\texttt{ggplot} Objekte sind wie alle Objekte in R anzusehen und k√∂nnen ebenfalls gespeichert werden. Die Funktion um eine Abb. (oder anderes Objekt) zu speichern ist \texttt{ggsave()}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Speichere die Abbildung als Objekt p}
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ mtcars }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(hp, mpg, }\AttributeTok{color =} \FunctionTok{as.factor}\NormalTok{(gear))) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\CommentTok{\# Speichere das Objekt p unter dem Pfad "images/temp/"}
\CommentTok{\# Achte auf den "/" slash}
\FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"images/temp/test.png"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ p, }\AttributeTok{width =} \DecValTok{5}\NormalTok{, }\AttributeTok{height =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Um zu sehen wie sich eine Abbildung entwickelt mag ich es auch, eine Ordner \texttt{temp} (f√ºr temporary) anzulegen und jede editierte Abbildung abzuspeichern. Das kann man auch automatisieren mit dem Zeitstempel des Computers als fortlaufenden Dateinamen.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggsave}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"images/temp/Title\_of\_file\_"}\NormalTok{, }\FunctionTok{format}\NormalTok{(}\FunctionTok{Sys.time}\NormalTok{(), }\StringTok{"\%Y{-}\%m{-}\%d\_\%H{-}\%M{-}\%S"}\NormalTok{), }\StringTok{".png"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{formen-der-darstellung}{%
\subsection{Formen der Darstellung}\label{formen-der-darstellung}}

\hypertarget{overplotting}{%
\subsubsection{Overplotting}\label{overplotting}}

Bei mittleren bis gro√üen Datens√§tzen l√§uft man Gefahr des ``overplottings''. Eine M√∂glichkeit ist es durch die Form oder Transparenz die Aussagekraft zu erh√∂hen:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Example from https://ggplot2{-}book.org/statistical{-}summaries.html\#overplotting}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{x =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{4000}\NormalTok{), }\AttributeTok{y =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{4000}\NormalTok{))}
\NormalTok{norm }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(x, y)) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{y =} \ConstantTok{NULL}\NormalTok{) }

\NormalTok{norm }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-222-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{norm }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{shape =} \DecValTok{1}\NormalTok{) }\CommentTok{\# Hollow circles}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-222-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{norm }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{shape =} \StringTok{"."}\NormalTok{) }\CommentTok{\# Pixel sized}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-222-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{norm }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\CommentTok{\# Pixel sized}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-222-4} \end{center}

Hat man sehr gro√üen Daten kann ein 2D Geometrien n√ºtzlich sein:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{norm }\SpecialCharTok{+} \FunctionTok{geom\_bin2d}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"bin2d"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-223-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{norm }\SpecialCharTok{+} \FunctionTok{geom\_hex}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"hex"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-223-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{norm }\SpecialCharTok{+} \FunctionTok{geom\_hex}\NormalTok{(}\AttributeTok{bins =} \DecValTok{10}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"hex (bins = 10)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-223-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{norm }\SpecialCharTok{+} \FunctionTok{geom\_density2d}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"density2d"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-223-4} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# F√ºr den Speicherkoog k√∂nnte ein overlay wie folgt aussehen:}
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(wt, eh60a)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_density\_2d}\NormalTok{(}\AttributeTok{bins =} \DecValTok{10}\NormalTok{) }\SpecialCharTok{+}
\NormalTok{  my\_theme}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-223-5} \end{center}

\hypertarget{positions-argument}{%
\subsubsection{Positions Argument}\label{positions-argument}}

Jedes \texttt{geom} hat auch ein Argument zur Auskunft der Position. Schauen wir es uns am Beispiel eines S√§ulendiagrams an:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(cty, }\AttributeTok{fill =}\NormalTok{ class)) }\SpecialCharTok{+} 
  \FunctionTok{xlab}\NormalTok{(}\ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}

\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"stack"}\NormalTok{) }\CommentTok{\# the default}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-224-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"dodge"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-224-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"fill"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"fill"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-224-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"identity"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"gray"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-224-4} \end{center}

F√ºr Punkte gibt es nochmal speziellere Argumente, \texttt{identity}, \texttt{nudge}, \texttt{jitter}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(displ, cty, }\AttributeTok{color =}\NormalTok{ class)) }\SpecialCharTok{+} 
  \FunctionTok{xlab}\NormalTok{(}\ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}

\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"identity"}\NormalTok{) }\CommentTok{\# the default}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-225-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position =} \FunctionTok{position\_nudge}\NormalTok{(}\AttributeTok{x =} \DecValTok{2}\NormalTok{, }\AttributeTok{y =} \SpecialCharTok{{-}}\DecValTok{2}\NormalTok{)) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"nudge"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-225-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position =} \StringTok{"jitter"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"jitter"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-225-3} \end{center}

\texttt{position\_nudge()} verschiebt unsere Daten um -2 auf der y Achse und +2 auf der x Achse.

üîç \url{https://rpubs.com/bpbond/727258}

\hypertarget{inspirationen}{%
\subsubsection{Inspirationen}\label{inspirationen}}

üîç \url{https://r-charts.com/}

Die folgenden Abbildungen spiegeln alle dasselbe wieder, unterscheiden sich jedoch durch das \texttt{geom} in der Darstellung:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{fill =}\NormalTok{ class)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{y =} \ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}

\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_histogram}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ)) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"histogram"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-226-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_density}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ)) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"density"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-226-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_freqpoly}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ)) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"freqpoly"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-226-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_boxplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ class, }\AttributeTok{y =}\NormalTok{ displ)) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"boxplot"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-226-4} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_violin}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ class, }\AttributeTok{y =}\NormalTok{ displ)) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"violin"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-226-5} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\SpecialCharTok{+} \FunctionTok{geom\_dotplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ class), }\AttributeTok{stackratio =} \FloatTok{0.35}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"dotplot"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-226-6} \end{center}

\hypertarget{linien}{%
\paragraph{Linien}\label{linien}}

F√ºr quasi kontinuierliche Darstellungen eignen sich Liniendiagramme:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(daily }\SpecialCharTok{\textgreater{}} \StringTok{"2011{-}01{-}01"} \SpecialCharTok{\&}\NormalTok{ daily }\SpecialCharTok{\textless{}} \StringTok{"2011{-}12{-}31"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-227-1} \end{center}

\hypertarget{boxplot}{%
\paragraph{Boxplot}\label{boxplot}}

Man kann die monatliche Variabilit√§t aber auch als boxplot darstellen. Dazu setzen wir in dem Aufruf \texttt{geom\_boxplot(aes(group\ =\ month))} um ggplot mitzuteilen, dass jede einzelne Box f√ºr den individuellen Monat in 2011 gezeigt werden soll.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(daily }\SpecialCharTok{\textgreater{}} \StringTok{"2011{-}01{-}01"} \SpecialCharTok{\&}\NormalTok{ daily }\SpecialCharTok{\textless{}} \StringTok{"2011{-}12{-}31"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =}\NormalTok{ month))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-228-1} \end{center}

Fehlt dieser Aufruf macht die Darstellung weniger Sinn üòé

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(daily }\SpecialCharTok{\textgreater{}} \StringTok{"2011{-}01{-}01"} \SpecialCharTok{\&}\NormalTok{ daily }\SpecialCharTok{\textless{}} \StringTok{"2011{-}12{-}31"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-229-1} \end{center}

\hypertarget{ridgeline-plots}{%
\paragraph{Ridgeline plots}\label{ridgeline-plots}}

Auf der X Achse wird der numerische Wert geplottet und auf der Y Achse die Faktor Variable (in unserem Fall die Bodentemperatur in den Tiefen)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{name =} \FunctionTok{factor}\NormalTok{(name, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"st10"}\NormalTok{,}\StringTok{"st20"}\NormalTok{,}\StringTok{"st30"}\NormalTok{,}\StringTok{"st60"}\NormalTok{,}\StringTok{"st100"}\NormalTok{,}\StringTok{"st150"}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ value, }\AttributeTok{y =} \FunctionTok{fct\_rev}\NormalTok{(name))) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{x =} \StringTok{"Bodentemperatur in ¬∞C"}\NormalTok{, }
    \AttributeTok{y =} \StringTok{"Bodentiefe"}
\NormalTok{  )}

\CommentTok{\# Offene Dichteverteilung der Daten}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_density\_ridges}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-230-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Geschlossene Dichteverteilung der Daten}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_density\_ridges2}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-230-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Beschr√§nke die Darstellung auf min und max der Tiefe}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_density\_ridges}\NormalTok{(}\AttributeTok{rel\_min\_height =} \FloatTok{0.01}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-230-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Mit einheitlicher Farbe}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_density\_ridges}\NormalTok{(}\AttributeTok{fill =} \StringTok{"lightblue"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-230-4} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Farbe nach Gruppen}
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{name =} \FunctionTok{factor}\NormalTok{(name, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"st10"}\NormalTok{,}\StringTok{"st20"}\NormalTok{,}\StringTok{"st30"}\NormalTok{,}\StringTok{"st60"}\NormalTok{,}\StringTok{"st100"}\NormalTok{,}\StringTok{"st150"}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ value, }\AttributeTok{y =} \FunctionTok{fct\_rev}\NormalTok{(name), }\AttributeTok{fill =}\NormalTok{ name)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{x =} \StringTok{"Bodentemperatur in ¬∞C"}\NormalTok{, }
    \AttributeTok{y =} \StringTok{"Bodentiefe"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{geom\_density\_ridges}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-230-5} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Farbe nach Gradient}
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{name =} \FunctionTok{factor}\NormalTok{(name, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"st10"}\NormalTok{,}\StringTok{"st20"}\NormalTok{,}\StringTok{"st30"}\NormalTok{,}\StringTok{"st60"}\NormalTok{,}\StringTok{"st100"}\NormalTok{,}\StringTok{"st150"}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ value, }\AttributeTok{y =} \FunctionTok{fct\_rev}\NormalTok{(name), }\AttributeTok{fill =} \FunctionTok{stat}\NormalTok{(x))) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{x =} \StringTok{"Bodentemperatur in ¬∞C"}\NormalTok{, }
    \AttributeTok{y =} \StringTok{"Bodentiefe"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{geom\_density\_ridges\_gradient}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_viridis\_c}\NormalTok{(}\AttributeTok{option =} \StringTok{"B"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-230-6} \end{center}

\hypertarget{streamline-plots}{%
\paragraph{Streamline plots}\label{streamline-plots}}

Streamline plots sind sinnvoll um Trends √ºber die Zeit darzustellen oder

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Daten Aufbereitung}
\NormalTok{stream }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{day\_of\_year =} \FunctionTok{yday}\NormalTok{(daily)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{==} \StringTok{"2011"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{name =} \FunctionTok{factor}\NormalTok{(name, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"st10"}\NormalTok{,}\StringTok{"st20"}\NormalTok{,}\StringTok{"st30"}\NormalTok{,}\StringTok{"st60"}\NormalTok{,}\StringTok{"st100"}\NormalTok{,}\StringTok{"st150"}\NormalTok{)))}
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ stream }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ day\_of\_year, }\AttributeTok{y =}\NormalTok{ value, }\AttributeTok{fill =}\NormalTok{ name))}
\CommentTok{\# Default stream plot}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_stream}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-231-1} \end{center}

\hypertarget{lollipop-charts}{%
\paragraph{Lollipop charts}\label{lollipop-charts}}

Diese Abbildung eignet sich f√ºr numerische Variablen die gegen eine kategorische geplottet werden sollen:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Data preparation}
\NormalTok{lolli }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(daily }\SpecialCharTok{\textless{}} \StringTok{"2010{-}12{-}31"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise\_at}\NormalTok{(}\FunctionTok{vars}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"eh"}\NormalTok{)), mean, }\AttributeTok{na.rm =}\NormalTok{ T) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{everything}\NormalTok{())}

\NormalTok{col\_names }\OtherTok{\textless{}{-}} \FunctionTok{rev}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"eh10a"}\NormalTok{,}\StringTok{"eh10b"}\NormalTok{,}\StringTok{"eh10c"}\NormalTok{,}
                   \StringTok{"eh20a"}\NormalTok{,}\StringTok{"eh20b"}\NormalTok{,}\StringTok{"eh20c"}\NormalTok{,}
                   \StringTok{"eh30a"}\NormalTok{,}\StringTok{"eh30b"}\NormalTok{,}\StringTok{"eh30c"}\NormalTok{,}
                                           \StringTok{"eh60a"}\NormalTok{,}\StringTok{"eh60b"}\NormalTok{,}\StringTok{"eh60c"}\NormalTok{,}
                                           \StringTok{"eh100a"}\NormalTok{,}\StringTok{"eh100b"}\NormalTok{,}\StringTok{"eh100c"}\NormalTok{,}
                                           \StringTok{"eh150a"}\NormalTok{,}\StringTok{"eh150b"}\NormalTok{,}\StringTok{"eh150c"}\NormalTok{))}
  


\CommentTok{\# Plot the data}
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ lolli }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(value, }\FunctionTok{fct\_relevel}\NormalTok{(name, col\_names))) }\SpecialCharTok{+} \CommentTok{\# order the electrode names by the col\_names vector}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_segment}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \SpecialCharTok{{-}}\DecValTok{300}\NormalTok{, }\AttributeTok{xend =}\NormalTok{ value, }\AttributeTok{y =}\NormalTok{ name, }\AttributeTok{yend =}\NormalTok{ name))}
\NormalTok{p}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-232-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Customization }
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ p }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{shape =} \DecValTok{21}\NormalTok{, }\AttributeTok{size =} \DecValTok{8}\NormalTok{, }\AttributeTok{fill =} \StringTok{"white"}\NormalTok{)}
\NormalTok{p}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-232-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Mithilfe von geom\_text kann auch der Wert in den Kreis geplottet werden}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{round}\NormalTok{(value, }\DecValTok{0}\NormalTok{)), }\AttributeTok{size =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-232-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Mit fct\_relevel aus dem forcats package kann nach Gr√∂√üe sortiert werden}
\NormalTok{lolli }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(value, }\FunctionTok{fct\_reorder}\NormalTok{(name, value))) }\SpecialCharTok{+} \CommentTok{\# order the electrode names by the col\_names vector}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{shape =} \DecValTok{21}\NormalTok{, }\AttributeTok{size =} \DecValTok{8}\NormalTok{, }\AttributeTok{fill =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_segment}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \SpecialCharTok{{-}}\DecValTok{300}\NormalTok{, }\AttributeTok{xend =}\NormalTok{ value, }\AttributeTok{y =}\NormalTok{ name, }\AttributeTok{yend =}\NormalTok{ name))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-232-4} \end{center}

Speziell das sortieren von kategorischen Variablen ist h√§ufig wichtig, um sofort einzusehen das der h√∂chste E\textsubscript{H} die Elektrode eh20c aufweist und der niedrigste Wert bei eh150b gemessen wurde.

\hypertarget{windrose-radar-chart}{%
\paragraph{Windrose (radar chart)}\label{windrose-radar-chart}}

üîç \href{https://davidcarslaw.github.io/openair/reference/windRose.html}{openair package}

In der Meteorologie werden auch Windrosen verwendet, um neben der Windrichtung auch die Geschwindigkeit zu codieren mit der im j√§hrlichen Mittel der Wind weht. Das \texttt{openair::} package bietet M√∂glichkeiten dies umzusetzen. Alles was man braucht ist ein data frame mit einer Variable f√ºr die WIndrichtung (default \texttt{wd}) und der Windgeschwindigkeit (default \texttt{ws}). Durch das Argument \texttt{type\ =} kann man √§hnlich wie beim facetting angeben, wie die Daten aufgebrochen werden sollen (bspw. pro Jahr):

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Restructure data}
\NormalTok{koog\_wind }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(ws, wd, year) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textless{}} \DecValTok{2020} \SpecialCharTok{\&}\NormalTok{ year }\SpecialCharTok{\textgreater{}} \DecValTok{2011}\NormalTok{)}

\CommentTok{\# Plot the data}
\NormalTok{koog\_wind }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{windRose}\NormalTok{(}\AttributeTok{ws =} \StringTok{"ws"}\NormalTok{, }\AttributeTok{wd =} \StringTok{"wd"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-233-1} \end{center}

\hypertarget{treemaps}{%
\paragraph{Treemaps}\label{treemaps}}

Treemaps visualisieren Beobachtungen durch Kacheln, wobei die Fl√§che der Kachel proportional zu dem Wert der Variable ist. Das package \texttt{treemapify::} kann dazu genutzt werden:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create test data}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{group =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Group"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{9}\NormalTok{),}
  \AttributeTok{subgroup =} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"A"}\NormalTok{, }\StringTok{"A"}\NormalTok{,}\StringTok{"C"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"B"}\NormalTok{),}
  \AttributeTok{value =} \FunctionTok{c}\NormalTok{(}\DecValTok{7}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{50}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{16}\NormalTok{,}\DecValTok{18}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{41}\NormalTok{)}
\NormalTok{)}

\CommentTok{\# Plot the data}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{area =}\NormalTok{ value, }\AttributeTok{fill =}\NormalTok{ group)) }\SpecialCharTok{+}
\NormalTok{  treemapify}\SpecialCharTok{::}\FunctionTok{geom\_treemap}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-234-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# F√ºlle mit numerischen Daten}
\NormalTok{df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{area =}\NormalTok{ value, }\AttributeTok{fill =}\NormalTok{ value)) }\SpecialCharTok{+}
\NormalTok{  treemapify}\SpecialCharTok{::}\FunctionTok{geom\_treemap}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_viridis\_c}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-234-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
 
\CommentTok{\# Label den plot mit Gruppenname und Wert}
\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{area =}\NormalTok{ value, }\AttributeTok{fill =}\NormalTok{ value, }\AttributeTok{label =} \FunctionTok{paste}\NormalTok{(group, value, }\AttributeTok{sep =} \StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_treemap}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_treemap\_text}\NormalTok{(}\AttributeTok{colour =} \FunctionTok{c}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\StringTok{"white"}\NormalTok{, }\DecValTok{2}\NormalTok{),}
                               \DecValTok{1}\NormalTok{, }\FunctionTok{rep}\NormalTok{(}\StringTok{"white"}\NormalTok{, }\DecValTok{6}\NormalTok{)),}
                    \AttributeTok{place =} \StringTok{"centre"}\NormalTok{, }\AttributeTok{size =} \DecValTok{15}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_viridis\_c}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-234-3} \end{center}

\hypertarget{contour-plots}{%
\paragraph{Contour plots}\label{contour-plots}}

üîç \url{https://fishandwhistle.net/post/2019/depth-time-heatmaps/}

üîç \url{https://theoceancode.netlify.app/post/odv_figures/}

Die Messtiefen im Speicherkoog sind nahe an der Bodenoberfl√§che in einer h√∂heren Aufl√∂sung und es kann auch zu Messausf√§llen kommen. L√ºcken in den Datens√§tzen vermitteln deswegen nicht unbedingt das r√§umliche und zeitliche Kontinuum, welches in naturwissenschaftlichen Datens√§tzen zu finden ist. Eine M√∂glichkeit dies wiederzuspiegeln bieten contour plots / heatmaps / Rasterabbildungen oder weitere Synonyme.

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Verlauf aller Elektroden}
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{contains}\NormalTok{(}\StringTok{"eh"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{==} \StringTok{"2012"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, value, }\AttributeTok{color =}\NormalTok{ name, }\AttributeTok{group =}\NormalTok{ name)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-235-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Mittelwert bilden pro Tiefe}
\NormalTok{koog\_day }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rowwise}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# f√ºhre die folgende Berechnung Zeilenweise durch}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{eh10\_mean =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(eh10a, eh10b, eh10c), }\AttributeTok{na.rm =}\NormalTok{ T),}
         \AttributeTok{eh20\_mean =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(eh20a, eh20b, eh20c), }\AttributeTok{na.rm =}\NormalTok{ T),}
         \AttributeTok{eh30\_mean =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(eh30a, eh30b, eh30c), }\AttributeTok{na.rm =}\NormalTok{ T),}
         \AttributeTok{eh60\_mean =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(eh60a, eh60b, eh60c), }\AttributeTok{na.rm =}\NormalTok{ T),}
         \AttributeTok{eh100\_mean =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(eh100a, eh100b, eh100c), }\AttributeTok{na.rm =}\NormalTok{ T),}
         \AttributeTok{eh150\_mean =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(eh150a, eh150b, eh150c), }\AttributeTok{na.rm =}\NormalTok{ T))}
\CommentTok{\# Verlauf der Mittelwerte }
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"eh"}\NormalTok{) }\SpecialCharTok{\&} \FunctionTok{contains}\NormalTok{(}\StringTok{"mean"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{==} \StringTok{"2012"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, value, }\AttributeTok{color =}\NormalTok{ name, }\AttributeTok{group =}\NormalTok{ name)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-235-2} \end{center}

Mit den Mittelwerten sieht es schon etwas aufger√§umter aus, wir sind aber immer noch nicht am Ziel. Unser Ziel ist es zum Erstellen der Konturabbildung die fehlenden Werte ``aufzuf√ºllen''. R√§umlich also alle Werte die zwischen den Elektroden 10 und 20 liegen (also hypothetische Messwerte in 11, 12, 13, \ldots{} cm Tiefe) und zeitlich die \texttt{NA}s im Dezember 2012.

üö® Die interpolierten Messwerte sollten nicht (!) f√ºr weitere statistische Verrechnungen genutzt werden, da E\textsubscript{H} Messungen kleinr√§umig sehr variabel sind und wir keine Informationen √ºber den Bereich zwischen den Messtiefen geben k√∂nnen. Nichtsdestotrotz sind Konturabbildungen ein tolles Tool um Daten ansprechend zu visualisieren und auch Trends hervorzuheben.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# create data frame for interpolating}
\CommentTok{\# The column names should be date, depth, value (e.g. redox data)}
\CommentTok{\# NA, NaN, Inf values must be removed from the data frames}
\NormalTok{koog\_contour }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \CommentTok{\# separate by "\_" and remove "eh"}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"eh"}\NormalTok{) }\SpecialCharTok{\&} \FunctionTok{contains}\NormalTok{(}\StringTok{"mean"}\NormalTok{), }\AttributeTok{names\_to =} \FunctionTok{c}\NormalTok{(}\StringTok{"depth"}\NormalTok{, }\StringTok{"mean"}\NormalTok{), }\AttributeTok{names\_sep =} \StringTok{"\_"}\NormalTok{, }\AttributeTok{names\_prefix =} \StringTok{"eh"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{==} \StringTok{"2012"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date =}\NormalTok{ daily) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(date, depth, value) }\SpecialCharTok{\%\textgreater{}\%} 
  \CommentTok{\# remove NaN values from the data to NA values}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{value =} \FunctionTok{na\_if}\NormalTok{(value, }\StringTok{"NaN"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \CommentTok{\# remove all rows that contain a missing value, otherwise an error occurs during interpolation }
  \FunctionTok{drop\_na}\NormalTok{() }

\CommentTok{\# Write function to interpolate between depths }
\NormalTok{estimate\_value\_by\_date }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(target\_date, target\_depth) \{}
\NormalTok{  data\_for\_date }\OtherTok{\textless{}{-}}\NormalTok{ koog\_contour }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{filter}\NormalTok{(date }\SpecialCharTok{==}\NormalTok{ target\_date) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{arrange}\NormalTok{(depth)}
  
  \CommentTok{\# approx() is one way to do a linear interpolation}
  \FunctionTok{approx}\NormalTok{(data\_for\_date}\SpecialCharTok{$}\NormalTok{depth, data\_for\_date}\SpecialCharTok{$}\NormalTok{value, }\AttributeTok{xout =}\NormalTok{ target\_depth)}\SpecialCharTok{$}\NormalTok{y}
\NormalTok{\}}

\CommentTok{\# Test the function for four arbitraily set depths}
\FunctionTok{estimate\_value\_by\_date}\NormalTok{(}\FunctionTok{ymd}\NormalTok{(}\StringTok{"2012{-}05{-}13"}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\FloatTok{1.5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{21}\NormalTok{))}
\DocumentationTok{\#\# [1]       NA       NA       NA 547.1413 643.7689}


\NormalTok{value\_interp\_depth }\OtherTok{\textless{}{-}} \FunctionTok{crossing}\NormalTok{(}
  \CommentTok{\# the same dates as koog\_contour}
  \FunctionTok{tibble}\NormalTok{(}\AttributeTok{date =} \FunctionTok{unique}\NormalTok{(koog\_contour}\SpecialCharTok{$}\NormalTok{date)),}
  \CommentTok{\# depths can now be any value}
  \FunctionTok{tibble}\NormalTok{(}\AttributeTok{depth =} \FunctionTok{seq}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{150}\NormalTok{, }\AttributeTok{length.out =} \DecValTok{100}\NormalTok{)) }\CommentTok{\# The depths must be specified according to the data}
\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(date) }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{mutate}\NormalTok{(}\AttributeTok{value =} \FunctionTok{estimate\_value\_by\_date}\NormalTok{(date[}\DecValTok{1}\NormalTok{], depth))}


\NormalTok{estimate\_value\_by\_depth }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(target\_depth, target\_date) \{}
\NormalTok{  data\_for\_depth }\OtherTok{\textless{}{-}}\NormalTok{ value\_interp\_depth }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{filter}\NormalTok{(depth }\SpecialCharTok{==}\NormalTok{ target\_depth) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{arrange}\NormalTok{(date)}
  \FunctionTok{approx}\NormalTok{(data\_for\_depth}\SpecialCharTok{$}\NormalTok{date, data\_for\_depth}\SpecialCharTok{$}\NormalTok{value, }\AttributeTok{xout =}\NormalTok{ target\_date)}\SpecialCharTok{$}\NormalTok{y}
\NormalTok{\}}


\FunctionTok{estimate\_value\_by\_depth}\NormalTok{(}
  \AttributeTok{target\_depth =} \FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{,}\DecValTok{12}\NormalTok{), }
  \AttributeTok{target\_date =} \FunctionTok{seq}\NormalTok{(}\FunctionTok{ymd}\NormalTok{(}\StringTok{"2012{-}05{-}12"}\NormalTok{), }\FunctionTok{ymd}\NormalTok{(}\StringTok{"2012{-}05{-}15"}\NormalTok{), }\AttributeTok{by =} \DecValTok{1}\NormalTok{)}
\NormalTok{)}
\DocumentationTok{\#\# [1] 549.1958 547.1413 542.2649 550.9811}


\NormalTok{value\_raster }\OtherTok{\textless{}{-}} \FunctionTok{crossing}\NormalTok{(}
  \CommentTok{\# dates can now be any value}
  \FunctionTok{tibble}\NormalTok{(}\AttributeTok{date =} \FunctionTok{seq}\NormalTok{(}\FunctionTok{ymd}\NormalTok{(}\StringTok{"2012{-}01{-}01"}\NormalTok{), }\FunctionTok{ymd}\NormalTok{(}\StringTok{"2012{-}12{-}31"}\NormalTok{), }\AttributeTok{by =} \DecValTok{1}\NormalTok{)),}
  \CommentTok{\# depths must be the same as in temp\_interp\_depth}
  \FunctionTok{tibble}\NormalTok{(}\AttributeTok{depth =} \FunctionTok{unique}\NormalTok{(value\_interp\_depth}\SpecialCharTok{$}\NormalTok{depth))}
\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(depth) }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{mutate}\NormalTok{(}\AttributeTok{value =} \FunctionTok{estimate\_value\_by\_depth}\NormalTok{(depth[}\DecValTok{1}\NormalTok{], date))}

\CommentTok{\# Create a color palette}
\NormalTok{colours }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"\#feb483"}\NormalTok{, }\StringTok{"\#d31f2a"}\NormalTok{, }\StringTok{"\#ffc000"}\NormalTok{, }\StringTok{"\#27ab19"}\NormalTok{, }\StringTok{"\#0db5e6"}\NormalTok{, }\StringTok{"\#7139fe"}\NormalTok{, }\StringTok{"\#d16cfa"}\NormalTok{)}

\NormalTok{p1 }\OtherTok{\textless{}{-}}\NormalTok{ value\_raster }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(date, depth, }\AttributeTok{fill =}\NormalTok{ value)) }\SpecialCharTok{+}
  \FunctionTok{geom\_raster}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_contour}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{z =}\NormalTok{ value), }\AttributeTok{breaks =} \DecValTok{300}\NormalTok{, }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# Label EH \textgreater{}= 300 mV with black}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{150}\NormalTok{, }\DecValTok{0}\NormalTok{), }\AttributeTok{expand =} \DecValTok{0}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# expand = 0 setzt die Grenze der Abbildung direkt an den Rand}
  \FunctionTok{scale\_fill\_gradientn}\NormalTok{(}\AttributeTok{colours =} \FunctionTok{rev}\NormalTok{(colours), }
                       \AttributeTok{name =} \FunctionTok{expression}\NormalTok{(E[H]),}
                       \AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \SpecialCharTok{{-}}\DecValTok{400}\NormalTok{, }\AttributeTok{to =} \DecValTok{800}\NormalTok{, }\AttributeTok{by =} \DecValTok{200}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_date}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"1 month"}\NormalTok{, }\AttributeTok{date\_labels =} \StringTok{"\%m"}\NormalTok{, }\AttributeTok{minor\_breaks =} \StringTok{"1 month"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Konturabbildung der Redoxpotenziale"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Speicherkoog f√ºr das Jahr 2012"}\NormalTok{,}
    \AttributeTok{caption =} \StringTok{"*Schwarze Linie trennt oxidierende (\textgreater{} 300 mV)}\SpecialCharTok{\textbackslash{}n}\StringTok{ und reduzierende Bedingungen"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Monat des Jahres"}\NormalTok{,}
    \AttributeTok{y =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(E[H], }\StringTok{" (mV)"}\NormalTok{))}
\NormalTok{  ) }\SpecialCharTok{+} 
\NormalTok{  my\_theme}

\NormalTok{p2 }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"eh"}\NormalTok{) }\SpecialCharTok{\&} \FunctionTok{contains}\NormalTok{(}\StringTok{"mean"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{==} \StringTok{"2012"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, value, }\AttributeTok{color =}\NormalTok{ name)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()  }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_date}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"1 month"}\NormalTok{, }\AttributeTok{date\_labels =} \StringTok{"\%m"}\NormalTok{, }\AttributeTok{minor\_breaks =} \StringTok{"1 month"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Verlauf der Redoxpotenziale"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Speicherkoog f√ºr das Jahr 2012"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Monat des Jahres"}\NormalTok{,}
    \AttributeTok{y =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(E[H], }\StringTok{" (mV)"}\NormalTok{))}
\NormalTok{  ) }\SpecialCharTok{+} 
\NormalTok{  my\_theme}

\NormalTok{p3 }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{==} \StringTok{"2012"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, wt\_2)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_date}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"1 month"}\NormalTok{, }\AttributeTok{date\_labels =} \StringTok{"\%m"}\NormalTok{, }\AttributeTok{minor\_breaks =} \StringTok{"1 month"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{x =} \StringTok{"Monat des Jahres"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Grundwasserflurabstand}\SpecialCharTok{\textbackslash{}n}\StringTok{(cm u. GOK)"}
\NormalTok{  ) }\SpecialCharTok{+} 
\NormalTok{  my\_theme}

\NormalTok{p1 }\SpecialCharTok{/}\NormalTok{ p3  }
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-236-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"images/results/new\_school.png"}\NormalTok{, }\AttributeTok{height =} \DecValTok{6}\NormalTok{, }\AttributeTok{width =} \DecValTok{6}\NormalTok{)}

\NormalTok{p2 }\SpecialCharTok{/}\NormalTok{ p3}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-236-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"images/results/old\_school.png"}\NormalTok{, }\AttributeTok{height =} \DecValTok{6}\NormalTok{, }\AttributeTok{width =} \DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{warming-stripes}{%
\paragraph{Warming stripes}\label{warming-stripes}}

üîç \url{https://dominicroye.github.io/en/2018/how-to-create-warming-stripes-in-r/}

Warming stripes haben in letzter Zeit gr√∂√üere Beliebtheit bekommen, um den Anstieg der globalen Durchschnittstemperatur zu visualisieren. Quasi erfunden wurden sie von Ed Hawkins:

\begin{quote}
Visualising global temperature change since records began in 1850.
Versions for USA, central England \& Toronto available too:
\url{https://t.co/H5Hv9YgZ7v}
\href{https://t.co/YMzdySrr3A}{pic.twitter.com/YMzdySrr3A}

--- Ed Hawkins (@ed\_hawkins) \href{https://twitter.com/ed_hawkins/status/999242147135188993}{May 23,
2018}
\end{quote}

Als Beispieldatensatz schauen wir uns die Bodentemperatur in 5 cm Tiefe f√ºr eine Messstation des DWD in NRW an. Es handelt sich um die Station \emph{Essen-Bredeney}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# read data for the 5 cm soil depth}
\NormalTok{dh\_005 }\OtherTok{\textless{}{-}}\NormalTok{ readr}\SpecialCharTok{::}\FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/data\_TE05\_MN002.csv"}\NormalTok{, }\AttributeTok{delim =} \StringTok{","}\NormalTok{)}

\CommentTok{\# Define special theme for the plot}
\NormalTok{theme\_strip }\OtherTok{\textless{}{-}} \FunctionTok{theme\_minimal}\NormalTok{()}\SpecialCharTok{+}
                 \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.y =} \FunctionTok{element\_blank}\NormalTok{(),}
                       \AttributeTok{axis.line.y =} \FunctionTok{element\_blank}\NormalTok{(),}
                       \AttributeTok{axis.title =} \FunctionTok{element\_blank}\NormalTok{(),}
                       \AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
                       \AttributeTok{legend.title =} \FunctionTok{element\_blank}\NormalTok{(),}
                       \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{vjust =} \DecValTok{3}\NormalTok{),}
                       \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
                        \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{)}
\NormalTok{                       )}

\CommentTok{\# Define colors to use for the plot}
\NormalTok{col\_strip }\OtherTok{\textless{}{-}} \FunctionTok{brewer.pal}\NormalTok{(}\DecValTok{11}\NormalTok{, }\StringTok{"RdBu"}\NormalTok{)}

\CommentTok{\# For the final graphic we use the geometry geom\_tile( ). Since the data does not have a specific value for the Y axis, we need a dummy value, here I used 1. Also, I adjust the width of the color bar in the legend.}
\NormalTok{dh\_005 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(year), }\AttributeTok{y =} \DecValTok{1}\NormalTok{, }\AttributeTok{fill =}\NormalTok{ st)) }\SpecialCharTok{+}
  \FunctionTok{geom\_tile}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_date}\NormalTok{(}\AttributeTok{date\_breaks =} \StringTok{"5 years"}\NormalTok{,}
               \AttributeTok{date\_labels =} \StringTok{"\%Y"}\NormalTok{,}
               \AttributeTok{expand =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{expand =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_gradientn}\NormalTok{(}\AttributeTok{colors =} \FunctionTok{rev}\NormalTok{(col\_strip)) }\SpecialCharTok{+}
  \FunctionTok{guides}\NormalTok{(}\AttributeTok{fill =} \FunctionTok{guide\_colorbar}\NormalTok{(}\AttributeTok{barwidth =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Entwicklung der Jahresmittelwerte der Bodentemperatur"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"In 5 cm Bodentiefe f√ºr die Station Essen{-}Bredeney"}\NormalTok{,}
    \AttributeTok{caption =} \StringTok{"Quelle: Climate Data Center DWD"}\NormalTok{, }
    \AttributeTok{y =} \ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+}
\NormalTok{  theme\_strip}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-238-1} \end{center}

\hypertarget{farbauswahl}{%
\subsection{Farbauswahl}\label{farbauswahl}}

R bietet eine gigantische Auswahl an Farben, wo man schnell den √úberblick verlieren kann.
Das einfachste ist man w√§hlt die Name √ºber den Namen direkt aus, rot ist bspw. \texttt{"red"}.

Eine gro√üe Auswahl gibt es √ºber das Paket \texttt{RColorBrewer}, wo man auch das Argument setzen kann ausschlie√ülich Farben zu w√§hlen f√ºr Farbblinde:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{display.brewer.all}\NormalTok{(}\AttributeTok{colorblindFriendly =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-239-1} \end{center}

Ein weiteres Standardpaket ist \texttt{viridis}, wobei diese Farben alle f√ºr Farbblinde erstellt wurden.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/061} 

}

\caption{Source from: https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html}\label{fig:unnamed-chunk-240}
\end{figure}

Eine weitere M√∂glichkeit Farben aus einem Bild, bspw. einem Luftbild, zu extrahieren geht mit dem package \texttt{earthtones}.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/062} 

}

\caption{Source from: https://cran.r-project.org/web/packages/earthtones/index.html}\label{fig:unnamed-chunk-241}
\end{figure}

Richtig spannend ist auch das package \texttt{palleteR}, um Farben aus einem Bild zu extrahieren und zu verwenden.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/063} 

}

\caption{Source from: https://github.com/AndreaCirilloAC/paletter}\label{fig:unnamed-chunk-242}
\end{figure}

Wer selber Hand anlegen m√∂chte um Farben zu generieren, dem ist diese Seite w√§rmstens ans Herz gelegt \url{https://projects.susielu.com/viz-palette}.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/064} 

}

\caption{Source from: https://projects.susielu.com/viz-palette}\label{fig:unnamed-chunk-243}
\end{figure}

\hypertarget{beispiele-fuxfcr-unterschiedliche-farben}{%
\subsubsection{Beispiele f√ºr unterschiedliche Farben}\label{beispiele-fuxfcr-unterschiedliche-farben}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# select the data}
\NormalTok{lolli }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"eh"}\NormalTok{) }\SpecialCharTok{\&} \SpecialCharTok{!}\FunctionTok{contains}\NormalTok{(}\StringTok{"mean"}\NormalTok{))}

\CommentTok{\# create a name vector to sort the depth variables}
\NormalTok{col\_names }\OtherTok{\textless{}{-}} \FunctionTok{rev}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"eh10a"}\NormalTok{,}\StringTok{"eh10b"}\NormalTok{,}\StringTok{"eh10c"}\NormalTok{,}
                   \StringTok{"eh20a"}\NormalTok{,}\StringTok{"eh20b"}\NormalTok{,}\StringTok{"eh20c"}\NormalTok{,}
                   \StringTok{"eh30a"}\NormalTok{,}\StringTok{"eh30b"}\NormalTok{,}\StringTok{"eh30c"}\NormalTok{,}
                                           \StringTok{"eh60a"}\NormalTok{,}\StringTok{"eh60b"}\NormalTok{,}\StringTok{"eh60c"}\NormalTok{,}
                                           \StringTok{"eh100a"}\NormalTok{,}\StringTok{"eh100b"}\NormalTok{,}\StringTok{"eh100c"}\NormalTok{,}
                                           \StringTok{"eh150a"}\NormalTok{,}\StringTok{"eh150b"}\NormalTok{,}\StringTok{"eh150c"}\NormalTok{))}
  
\CommentTok{\# Plot the data with default color}
\NormalTok{lolli }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(value, }\FunctionTok{fct\_relevel}\NormalTok{(name, col\_names), }\AttributeTok{color =}\NormalTok{ name)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{x =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"E"}\NormalTok{ [H], }\StringTok{" (mV)"}\NormalTok{)),}
    \AttributeTok{y =} \StringTok{"Elektrode"}
\NormalTok{  ) }\SpecialCharTok{+}
\NormalTok{  my\_theme }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-244-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Plot the data with manual color}
\NormalTok{lolli }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(value, }\FunctionTok{fct\_relevel}\NormalTok{(name, col\_names))) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{color =} \StringTok{"red"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"blue"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{x =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"E"}\NormalTok{ [H], }\StringTok{" (mV)"}\NormalTok{)),}
    \AttributeTok{y =} \StringTok{"Elektrode"}
\NormalTok{  ) }\SpecialCharTok{+}
\NormalTok{  my\_theme }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-244-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Plot the data with scale\_fill\_brewer and various palletes}
\NormalTok{lolli }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(value, }\FunctionTok{fct\_relevel}\NormalTok{(name, col\_names), }\AttributeTok{fill =}\NormalTok{ name)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{x =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"E"}\NormalTok{ [H], }\StringTok{" (mV)"}\NormalTok{)),}
    \AttributeTok{y =} \StringTok{"Elektrode"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"PuBu"}\NormalTok{) }\SpecialCharTok{+}
\NormalTok{  my\_theme }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-244-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Plot the data with viridis color}
\NormalTok{lolli }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(value, }\FunctionTok{fct\_relevel}\NormalTok{(name, col\_names), }\AttributeTok{fill =}\NormalTok{ name)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{x =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"E"}\NormalTok{ [H], }\StringTok{" (mV)"}\NormalTok{)),}
    \AttributeTok{y =} \StringTok{"Elektrode"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_viridis\_d}\NormalTok{() }\SpecialCharTok{+}
\NormalTok{  my\_theme }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-244-4} \end{center}

\hypertarget{karten-erstellen-in-r}{%
\section{Karten erstellen in R üåç}\label{karten-erstellen-in-r}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

R beinhaltet zahlreiche Funktionen um r√§umliche Informationen darzustellen und zu analysieren. Aktuell sind \textgreater{} 180 packages auf CRAN zu finden die sich explizit mit der r√§umlichen Datenanalyse besch√§ftigen, Tendenz steigend. Eine Zusammenfassung ist \href{https://cran.r-project.org/web/views/Spatial.html}{HIER} zu finden, wobei die wichtigsten sind:

\begin{itemize}
\tightlist
\item
  \texttt{rgdal} um Koordinaten zu transformieren
\item
  \texttt{sp} und \texttt{sf} f√ºr Vektordatenanalyse
\item
  \texttt{raster} und \texttt{rastervis} f√ºr fortgeschrittene Analyse von Rasterdaten
\item
  \texttt{spatstat} f√ºr Mustererkennung
\end{itemize}

üîç Dieses Kapitel basiert auf den folgenden Quellen:

\begin{itemize}
\tightlist
\item
  \href{https://sebastiansauer.github.io/unemp-map/}{Sebastian Sauer}
\item
  \href{https://www.geo.fu-berlin.de/en/v/soga/Introduction-to-R/Spatial-Data/index.html}{FU Berlin}
\item
  \href{https://www.r-spatial.org/r/2018/10/25/ggplot2-sf-2.html}{r-spatial}
\item
  \href{https://slcladal.github.io/maps.html}{slcladal}
\end{itemize}

\hypertarget{datenquellen}{%
\subsection{Datenquellen}\label{datenquellen}}

F√ºr Deutschland ist die wohl wichtigste Quelle das \href{https://www.bkg.bund.de/DE/Home/home.html}{Bundesamt f√ºr Kartographie und Geod√§sie}. Die Verwaltungsgebiete k√∂nnen als kostenfreies \emph{shape} Format \href{https://gdz.bkg.bund.de/index.php/default/open-data/verwaltungsgebiete-historisch-vg-hist.html}{hier} heruntergeladen werden. Shape Dateien sind das g√§ngige Format f√ºr Geodaten.

\hypertarget{packages}{%
\subsection{Packages}\label{packages}}

\hypertarget{rgdal-package}{%
\subsubsection{\texorpdfstring{\texttt{rgdal} package}{rgdal package}}\label{rgdal-package}}

Beinhaltet wichtige Funktionen um Koordinaten zu transformieren, bspw. von Geographische L√§nge (longitude) und Breite (latitude) zu kartesischen Koordinaten wie UTM mit dem Referenzsystem ETRS89 f√ºr Deutschland.

\hypertarget{uxfcbungen}{%
\subsection{√úbungen}\label{uxfcbungen}}

\hypertarget{erstelle-eine-karte-der-bundesrepublik}{%
\subsubsection{Erstelle eine Karte der Bundesrepublik}\label{erstelle-eine-karte-der-bundesrepublik}}

Als erstes Laden wir unsere \href{https://gdz.bkg.bund.de/index.php/default/digitale-geodaten/verwaltungsgebiete/verwaltungsgebiete-1-2-500-000-stand-01-01-vg2500.html}{Geodaten} der Verwaltungsgebiete im Ma√üstab 1:2.500.000 herunter und extrahieren sie in unseren Projektordner. ``Der Datensatz umfasst s√§mtliche Verwaltungseinheiten der hierarchischen Verwaltungsebenen vom Staat bis zu den Kreisen mit ihren Grenzen, dem Regionalschl√ºssel und dem Namen der Verwaltungseinheit.''

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Als erstes m√ºssen die wichtigen packages geladen werden}
\FunctionTok{library}\NormalTok{(sf)}
\FunctionTok{library}\NormalTok{(tidyverse)}

\CommentTok{\# Laden der Geodaten und als Objekt speichern mit \textasciigrave{}st\_read\textasciigrave{}}
\NormalTok{map\_state }\OtherTok{\textless{}{-}}\NormalTok{ sf}\SpecialCharTok{::}\FunctionTok{st\_read}\NormalTok{(}\StringTok{"data/vg2500\_01{-}01.utm32s.shape/vg2500/vg2500\_sta.shp"}\NormalTok{)}
\DocumentationTok{\#\# Reading layer \textasciigrave{}vg2500\_sta\textquotesingle{} from data source }
\DocumentationTok{\#\#   \textasciigrave{}C:\textbackslash{}Dorau\textbackslash{}Arbeit\textbackslash{}00. R\textbackslash{}Book\textbackslash{}doku\textbackslash{}data\textbackslash{}vg2500\_01{-}01.utm32s.shape\textbackslash{}vg2500\textbackslash{}vg2500\_sta.shp\textquotesingle{} }
\DocumentationTok{\#\#   using driver \textasciigrave{}ESRI Shapefile\textquotesingle{}}
\DocumentationTok{\#\# Simple feature collection with 3 features and 4 fields}
\DocumentationTok{\#\# Geometry type: MULTIPOLYGON}
\DocumentationTok{\#\# Dimension:     XY}
\DocumentationTok{\#\# Bounding box:  xmin: 280353.1 ymin: 5235878 xmax: 921021.2 ymax: 6104656}
\DocumentationTok{\#\# Projected CRS: ETRS89 / UTM zone 32N}

\CommentTok{\# Ein Riesenvorteil des sf packages ist die Kompatibilit√§t mit dem tidyverse. Daher hat man alle Funktionalit√§ten im Zusammenhang mit ggplot und auch m Daten zu transformieren oder zu filtern}
\NormalTok{map\_state }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_sf}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-246-1} \end{center}

Das sieht aber merkw√ºrdig aus?! Zeile 1 in eurem erstellten Objekt steht f√ºr das Seeeinzugsgebiet Deutschlands. Wir k√∂nnen die erste Zeile mit \texttt{slice} und dem pipe operator \texttt{\%\textgreater{}\%} einfach entfernen:

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{p1 }\OtherTok{\textless{}{-}}\NormalTok{ map\_state }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{slice}\NormalTok{(}\DecValTok{2}\SpecialCharTok{:}\DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# Zeile 1 codiert das Seeeinzugsgebiet. Mit \textasciigrave{}slice\textasciigrave{} entfernt man die erste Zeile in dem man best√§tigt Zeile 2 bis 3 zu behalten}
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_sf}\NormalTok{()}

\NormalTok{p1}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-247-1} \end{center}

Sehr sch√∂n üòÑ Sylt ist wieder zu erkennen! Falls die Farbe nicht gef√§llt kann man das \texttt{theme} einfach anpassen.

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{map\_state }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{slice}\NormalTok{(}\DecValTok{2}\SpecialCharTok{:}\DecValTok{3}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_sf}\NormalTok{(}\AttributeTok{fill =} \StringTok{"grey40"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_void}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-248-1} \end{center}

Falls uns aber nicht die Bundesgrenzen interessieren sondern die Landes- oder sogar Kreisgrenzen, so k√∂nnen wir diese aus unseren Daten ebenfalls einlesen. Die Codierung der Datei lautet:

\begin{itemize}
\tightlist
\item
  Land (\texttt{lan})
\item
  Regierungsbezirk (\texttt{rbz})
\item
  Kreis (\texttt{krs})
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Einlesen der Daten}
\NormalTok{map\_federal }\OtherTok{\textless{}{-}}\NormalTok{ sf}\SpecialCharTok{::}\FunctionTok{st\_read}\NormalTok{(}\StringTok{"data/vg2500\_01{-}01.utm32s.shape/vg2500/vg2500\_lan.shp"}\NormalTok{)}
\DocumentationTok{\#\# Reading layer \textasciigrave{}vg2500\_lan\textquotesingle{} from data source }
\DocumentationTok{\#\#   \textasciigrave{}C:\textbackslash{}Dorau\textbackslash{}Arbeit\textbackslash{}00. R\textbackslash{}Book\textbackslash{}doku\textbackslash{}data\textbackslash{}vg2500\_01{-}01.utm32s.shape\textbackslash{}vg2500\textbackslash{}vg2500\_lan.shp\textquotesingle{} }
\DocumentationTok{\#\#   using driver \textasciigrave{}ESRI Shapefile\textquotesingle{}}
\DocumentationTok{\#\# Simple feature collection with 16 features and 4 fields}
\DocumentationTok{\#\# Geometry type: MULTIPOLYGON}
\DocumentationTok{\#\# Dimension:     XY}
\DocumentationTok{\#\# Bounding box:  xmin: 280353.1 ymin: 5235878 xmax: 921021.2 ymax: 6101335}
\DocumentationTok{\#\# Projected CRS: ETRS89 / UTM zone 32N}

\CommentTok{\# Darstellen der Landesgrenzen}
\NormalTok{p2 }\OtherTok{\textless{}{-}}\NormalTok{ map\_federal }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{geom\_sf}\NormalTok{()}

\NormalTok{p2}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-249-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Einlesen der Daten}
\NormalTok{map\_district }\OtherTok{\textless{}{-}}\NormalTok{ sf}\SpecialCharTok{::}\FunctionTok{st\_read}\NormalTok{(}\StringTok{"data/vg2500\_01{-}01.utm32s.shape/vg2500/vg2500\_krs.shp"}\NormalTok{)}
\DocumentationTok{\#\# Reading layer \textasciigrave{}vg2500\_krs\textquotesingle{} from data source }
\DocumentationTok{\#\#   \textasciigrave{}C:\textbackslash{}Dorau\textbackslash{}Arbeit\textbackslash{}00. R\textbackslash{}Book\textbackslash{}doku\textbackslash{}data\textbackslash{}vg2500\_01{-}01.utm32s.shape\textbackslash{}vg2500\textbackslash{}vg2500\_krs.shp\textquotesingle{} }
\DocumentationTok{\#\#   using driver \textasciigrave{}ESRI Shapefile\textquotesingle{}}
\DocumentationTok{\#\# Simple feature collection with 401 features and 4 fields}
\DocumentationTok{\#\# Geometry type: MULTIPOLYGON}
\DocumentationTok{\#\# Dimension:     XY}
\DocumentationTok{\#\# Bounding box:  xmin: 280353.1 ymin: 5235878 xmax: 921021.2 ymax: 6101335}
\DocumentationTok{\#\# Projected CRS: ETRS89 / UTM zone 32N}

\CommentTok{\# Darstellen der Landesgrenzen}
\NormalTok{p3 }\OtherTok{\textless{}{-}}\NormalTok{ map\_district }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{geom\_sf}\NormalTok{()}

\NormalTok{p3}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-250-1} \end{center}

Es ist Zeit zu feiern! Wir haben unsere erste vektorbasierte Karte mit R erstellt üëç

Man kann weiterhin einzelne Verwaltungsbezirke ausw√§hlen und darstellen. Die Objektstruktur eines \texttt{sf} Objektes erm√∂glicht dies.

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Stelle die ersten 5 Zeilen des Objektes map\_district dar}
\FunctionTok{head}\NormalTok{(map\_district, }\DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# Simple feature collection with 5 features and 4 fields}
\DocumentationTok{\#\# Geometry type: MULTIPOLYGON}
\DocumentationTok{\#\# Dimension:     XY}
\DocumentationTok{\#\# Bounding box:  xmin: 478836.8 ymin: 5958992 xmax: 629246.8 ymax: 6075267}
\DocumentationTok{\#\# Projected CRS: ETRS89 / UTM zone 32N}
\DocumentationTok{\#\#   ADE   ARS        ARS\_0          GEN                       geometry}
\DocumentationTok{\#\# 1   4 01001 010010000000    Flensburg MULTIPOLYGON (((531471 6075...}
\DocumentationTok{\#\# 2   4 01002 010020000000         Kiel MULTIPOLYGON (((577310.3 60...}
\DocumentationTok{\#\# 3   4 01003 010030000000       L√ºbeck MULTIPOLYGON (((624204.4 59...}
\DocumentationTok{\#\# 4   4 01004 010040000000   Neum√ºnster MULTIPOLYGON (((567602.5 59...}
\DocumentationTok{\#\# 5   4 01051 010510000000 Dithmarschen MULTIPOLYGON (((479551.7 59...}
\end{Highlighting}
\end{Shaded}

In der Spalte \textbf{GEN} sind die Namen der Bezirke codiert wohingegen die Geometrien (Formen) in der Spalte daneben gelistet sind.

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{map\_district }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(GEN }\SpecialCharTok{==} \StringTok{"Berlin"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# mit filter() durchsuchen wir die Spalte GEN nach dem Wort Berlin}
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Berlin"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{geom\_sf}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-252-1} \end{center}

\hypertarget{erstelle-eine-weltkarte}{%
\subsubsection{Erstelle eine Weltkarte}\label{erstelle-eine-weltkarte}}

Shape Daten der L√§ndergrenzen sind im package \texttt{rnaturalearth} enthalten.

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Laden der Daten und speichern als Objekt map\_world}
\NormalTok{map\_world }\OtherTok{\textless{}{-}}\NormalTok{ rnaturalearth}\SpecialCharTok{::}\FunctionTok{ne\_countries}\NormalTok{(}\AttributeTok{scale =} \StringTok{"medium"}\NormalTok{, }\AttributeTok{returnclass =} \StringTok{"sf"}\NormalTok{)}
  
\NormalTok{map\_world }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_sf}\NormalTok{(}\AttributeTok{fill =} \StringTok{"white"}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"World map"}\NormalTok{, }
    \AttributeTok{subtitle =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"("}\NormalTok{, }\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(map\_world}\SpecialCharTok{$}\NormalTok{admin)), }\StringTok{" countries)"}\NormalTok{), }\CommentTok{\# Die Funktion length() z√§hlt die L√§nge des Vektors und damit die Anzahl der L√§nder}
    \AttributeTok{x =} \StringTok{"Longitude"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Latitude"}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-253-1} \end{center}

\hypertarget{manuelles-hinzufuxfcgen-von-punkten}{%
\subsubsection{Manuelles Hinzuf√ºgen von Punkten}\label{manuelles-hinzufuxfcgen-von-punkten}}

Es ist m√∂glich Punktinformationen in die Karte zu √ºbernehmen. \texttt{geom\_sf} verh√§lt sich dabei wie jedes geom das verwendet wird. Dazu ist es am einfachsten einen neuen data.frame zu erstellen.

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{sampling\_points }\OtherTok{\textless{}{-}}\NormalTok{ tibble}\SpecialCharTok{::}\FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{site, }\SpecialCharTok{\textasciitilde{}}\NormalTok{lat, }\SpecialCharTok{\textasciitilde{}}\NormalTok{lon,}
  \StringTok{"Lavesum"}\NormalTok{, }\FloatTok{51.814589}\NormalTok{, }\FloatTok{7.216471}
\NormalTok{)}

\FunctionTok{head}\NormalTok{(sampling\_points)}
\FunctionTok{str}\NormalTok{(sampling\_points)}

\NormalTok{map\_germany }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{data =}\NormalTok{ sampling\_points, }\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ lon, }\AttributeTok{y =}\NormalTok{ lat), }\AttributeTok{color =} \StringTok{"red"}\NormalTok{, }\AttributeTok{size =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{statistische-auswertungen}{%
\section{Statistische Auswertungen}\label{statistische-auswertungen}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

\hypertarget{verteilung-der-daten}{%
\subsection{Verteilung der Daten}\label{verteilung-der-daten}}

Auf die verschiedenen Darstellungsformen gehen wir noch nicht ein, aber die Verteilung der Daten spielt f√ºr statistische Tests eine gro√üe Rolle. Sich die Verteilung optisch anzusehen bietet sich durch ein Histogram oder eine Dichteverteilung der H√§ufigkeiten:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Als Histogram mit der Anzahl der observations}
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{100}\NormalTok{) }\CommentTok{\# Die Anzahl der bins spiegelt die Klassen wieder. Default sind 30 }
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-257-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Oder als Dichteverteilung}
\NormalTok{koog }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-257-2} \end{center}

Optisch sieht es nach einer bimodalen Verteilung aus. Statistische Tests wie Korrelation, Regression, t-Test und Varianzanalyse setzen aber eine Normalverteilung voraus. Man nennt diese Tests auch \textbf{parametrische Tests}, da sie von der Verteilung der Daten abh√§ngig sind. Eine reine visuelle Untersuchung ist h√§ufig aber irref√ºhrend und sollte daher durch einen Test untermauert werden. Mit dem Shapiro-Wilk Test k√∂nnen wir in R untersuchen, ob die Daten normalverteilt sind.

üö® Test auf Normalit√§t sind abh√§ngig von der Stichprobengr√∂√üe. Bei kleiner Stichprobenanzahl wird der Test besser bestanden als bei gro√üer.

Die Null-Hypothese des Test besagt, dass die Probenverteilung normal ist. Ist der Test also signfikant, ist die Verteilung \textbf{nicht-normalverteilt}.

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{library}\NormalTok{(rstatix)}
\NormalTok{rstatix}\SpecialCharTok{::}\FunctionTok{shapiro\_test}\NormalTok{(koog\_day}\SpecialCharTok{$}\NormalTok{at)}
\DocumentationTok{\#\# \# A tibble: 1 x 3}
\DocumentationTok{\#\#   variable    statistic  p.value}
\DocumentationTok{\#\#   \textless{}chr\textgreater{}           \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 koog\_day$at     0.988 7.52e{-}18}
\end{Highlighting}
\end{Shaded}

Die Daten der Lufttemperatur sind nicht normalverteilt, da der p Wert signfikant ist (p \textless{} 0.001). Wir m√ºssen die Null-Hypothese also zur√ºckweisen. Es gibt aber M√∂glichkeiten dennoch bestimmte Tests durchzuf√ºhren, auch wenn die Daten keine Normalverteilung aufweisen. Das Zauberwort lautet:

üí° \textbf{Datenfransformation}

\hypertarget{datentransformation}{%
\subsection{Datentransformation}\label{datentransformation}}

üîç Das folgende Kapitel bezieht sich auf \href{https://www.datanovia.com/en/lessons/transform-data-to-normal-distribution-in-r/}{datanovia.com}

Um parametrische Tests (bspw. t-Test) durchzuf√ºhren, m√ºssen die Daten normalverteilt vorliegen. H√§ufig liegen Daten aber auch links- oder rechtsschief vor.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/045} 

}

\caption{Schiefe einer Verteilung}\label{fig:unnamed-chunk-259}
\end{figure}

Zuerst wollen wir uns die Dichteverteilung der Daten f√ºr die Lufttemperatur im Speicherkoog ansehen. Die rote Kurve spiegelt die perfekte Normalverteilung wieder.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggdensity}\NormalTok{(}\AttributeTok{x =} \StringTok{"at"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"lightgray"}\NormalTok{, }\AttributeTok{title =} \StringTok{"Air temperature"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{stat\_overlay\_normal\_density}\NormalTok{(}\AttributeTok{color =} \StringTok{"red"}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-260-1} \end{center}

Die Schiefe der Daten kann mit der Funktion \texttt{skewness} aus dem \texttt{moments::} package analysiert werden. Positive Schiefe (rechtsschief) Median \textless{} Mean und Negative Schiefe (linksschief) Median \textgreater{} Mean

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{skewness}\NormalTok{(koog\_day}\SpecialCharTok{$}\NormalTok{at, }\AttributeTok{na.rm =}\NormalTok{ T)}
\DocumentationTok{\#\# [1] {-}0.1630061}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Eine \textbf{0} bedeutet keine Schiefe und Normalverteilung
\item
  Negative Werte = negative Schiefe = linksschief
\item
  Positive Werte = positive Schiefe = rechtsschief
\end{itemize}

Die Daten der Lufttemperatur haben also eine leichte linksschiefe.

H√§ufig verwendet man eine Log-Transformation der Daten, um eine Normalverteilung zu erreichen. Dazu erstellen wir einen neuen Vektor und nennen ihn \texttt{at\_log}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Quadratwurzel f√ºr moderate Schiefe}
\CommentTok{\#at\_transform \textless{}{-} sqrt(koog\_day$at) \# Positive Schiefe}
\NormalTok{at\_transform }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{max}\NormalTok{(koog\_day}\SpecialCharTok{$}\NormalTok{at }\SpecialCharTok{+} \DecValTok{1}\NormalTok{) }\SpecialCharTok{{-}}\NormalTok{ koog\_day}\SpecialCharTok{$}\NormalTok{at) }\CommentTok{\# Negative Schiefe}

\CommentTok{\# log f√ºr st√§rkere Schiefe}
\CommentTok{\#at\_transform \textless{}{-} log10(koog\_day$at)}
\NormalTok{at\_transform }\OtherTok{\textless{}{-}} \FunctionTok{log10}\NormalTok{(}\FunctionTok{max}\NormalTok{(koog\_day}\SpecialCharTok{$}\NormalTok{at}\SpecialCharTok{+}\DecValTok{1}\NormalTok{, }\AttributeTok{na.rm =}\NormalTok{ T) }\SpecialCharTok{{-}}\NormalTok{ koog\_day}\SpecialCharTok{$}\NormalTok{at) }

\CommentTok{\# Invers f√ºr sehr starke Schiefe}
\NormalTok{at\_transform }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{/}\NormalTok{koog\_day}\SpecialCharTok{$}\NormalTok{at}
\NormalTok{at\_transform }\OtherTok{\textless{}{-}}\NormalTok{ (}\FunctionTok{max}\NormalTok{(koog\_day}\SpecialCharTok{$}\NormalTok{at}\SpecialCharTok{+}\DecValTok{1}\NormalTok{) }\SpecialCharTok{{-}}\NormalTok{ koog\_day}\SpecialCharTok{$}\NormalTok{at)}


\NormalTok{at\_transform }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggdensity}\NormalTok{(}\AttributeTok{fill =} \StringTok{"lightgray"}\NormalTok{, }\AttributeTok{title =} \StringTok{"Air temperature"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{stat\_overlay\_normal\_density}\NormalTok{(}\AttributeTok{color =} \StringTok{"red"}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-262-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{skewness}\NormalTok{(at\_transform, }\AttributeTok{na.rm =}\NormalTok{ T)}
\DocumentationTok{\#\# [1] NaN}
\end{Highlighting}
\end{Shaded}

üö® Wichtig! Eine Transformation ist nicht immer erfolgreich. In diesem Beispiel hat keine Methode zu einer Verbesserung gef√ºhrt.

Falls die Normalverteilung nicht gegeben ist und auch die Transformation keine Verbesserung bringt, kann man einen parametrischen Test an der transformierten und der nicht-transfomrierten Variante durchf√ºhren. Wenn beide Varianten zu dem selben Ergebniss kommen, ist das Arbeiten mit nicht transformierten Variablen zu bevorzugen. Die Vergelichbarkeit wird bei der Transfomration n√§mlich schlechter, bspw. bei dem Vergleich von zwei Gruppen kann man nach der Transformation nicht mehr ohne weiteres sagen, dass der Mittelwert von Gruppe 1 \textgreater{} Gruppe 2 ist.

üí° Wenn die Stichprobenanzahl gro√ü genug ist (\textgreater{} 30 - 40), ist die Wahrscheinlichkeit f√ºr Normalverteilung meist gegegeben oder zumindest nah genug dran, um mit parametrischen Tests weiterzuarbeiten (\href{https://de.wikipedia.org/wiki/Zentraler_Grenzwertsatz}{Zentraler Grenzwertsatz})

\hypertarget{korrelationen}{%
\subsection{Korrelationen}\label{korrelationen}}

üîç \href{https://towardsdatascience.com/eveything-you-need-to-know-about-interpreting-correlations-2c485841c0b8}{https://towardsdatascience.com/}

Eine Korrelation geh√∂rt zu den weit verbreitesten statistischen Ma√üen. Die Anwendung muss jedoch mit besonderem Augenma√ü erfolgen, andernfalls gibt es auch Fehlerquellen. Eine vermeintliche Korrelation aus einer Population kann auch Zufall sein und muss nicht unbedingt durch das Prinzip Ursache-Wirkung verursacht sein. Daher sollte eine Korrelation immer mit einem Signifikanztest verkn√ºpft werden.

Korrelation beschreiben, wie sich Variablen in Abh√§ngigkeit einer anderen Variable verhalten. Beispielsweise

\begin{itemize}
\tightlist
\item
  Bildung und Einkommen
\item
  Jahr des Tages und Lufttemperatur
\item
  Bierkonsum und Bauchumfang
\end{itemize}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/055} 

}

\caption{Illustration von Z. Jaadi: https://towardsdatascience.com}\label{fig:unnamed-chunk-263}
\end{figure}

\textbf{Positive Korrelation}: Zwei Variablen gehen in diesselbe Richtung.
\textbf{Negative Korrelation}: Zwei Variablen bewegen sich in gegengesetzte Richtung.
\textbf{Neutrale Korrelation}: Es gibt keinen Zusammenhang zwischen den Variablen.

Die Form einer Korrelation kann unterschiedlich ausgepr√§gt sein:

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/056} 

}

\caption{Illustration von Z. Jaadi: https://towardsdatascience.com}\label{fig:unnamed-chunk-264}
\end{figure}

\textbf{Lineare Korrelation}: Variablen ver√§ndern sich in konstanter Rate und erf√ºllen die Gleichung Y = aX + b (Die Beziehung l√§sst sich als Gerade beschreiben).
\textbf{Nicht-lineare Korrelation}: Variablen ver√§ndern sich nicht in konstanter Rate. Die Form kann parabolisch, hyperbolisch, \ldots{} etc. sein.
\textbf{Monotone Korrelation}: Die Variablen tendieren in diesselbe Richtung, jedoch nicht in gleicher Rate. Alle lineare Korrelationen sind also monoton, der umgekehrte Prozess muss jedoch nicht unbedingt richtig sein.

Scatterplots oder Punktdiagramme sind sinnvoll, um visuell einen √úberblick √ºber die Verteilung der Daten zu bekommen. Nehmen wir mal das Beispiel Batteriespannung der Station im Speicherkoog und gemessene Solarstrahlung:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(sr, bat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{x =} \StringTok{"Solarstrahlung (W/m¬≤)"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Batteriespannung (V)"}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-265-1} \end{center}

\hypertarget{pearsons-korrelationkoeffizient-r}{%
\subsubsection{Pearson's Korrelationkoeffizient (r)}\label{pearsons-korrelationkoeffizient-r}}

Dieses Ma√ü wird verwendet um St√§rke und Richtung eines linearen Zusammenhanges zwischen zwei Variablen vorherzusagen. Mathematisch l√§sst ausgedr√ºckt teilt man die Co-Varianz von zwei Variablen mit dem Produkt der Standardabweichung:

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/057} 

}

\caption{Illustration von Z. Jaadi: https://towardsdatascience.com}\label{fig:unnamed-chunk-266}
\end{figure}

Die Werte von r variieren zwischen -1 und 1, wobei 1 einen perfekten positiven Zusammenhang darstellt und -1 einen einen perfekten negativen. Die Gr√∂√üe von Pearson's r k√∂nnnte wie folgt eingeteilt werden:

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/058} 

}

\caption{Illustration von Z. Jaadi: https://towardsdatascience.com}\label{fig:unnamed-chunk-267}
\end{figure}

In R k√∂nnen wir Pearson's r mit der Funktion \texttt{stats::cor()} berechnen:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cor}\NormalTok{(koog\_day}\SpecialCharTok{$}\NormalTok{sr, koog\_day}\SpecialCharTok{$}\NormalTok{bat, }\AttributeTok{use =} \StringTok{"complete.obs"}\NormalTok{, }\AttributeTok{method =} \StringTok{"pearson"}\NormalTok{)}
\DocumentationTok{\#\# [1] 0.5694954}
\end{Highlighting}
\end{Shaded}

Mit dem Argument \texttt{method\ =} k√∂nnen wir die drei Optionen nach Spearman, Pearson oder Kendall's Tau angeben. Falls wir fehlende Werte in unserem Datensatz haben, was bei uns der Fall ist, dann m√ºssen wir dies im Argument angeben. Wir setzen das Argument \texttt{complete.obs} um Zeilenweise fehlende Werte aus dem Datensatz zu werfen und von der Korrelation auszuschlie√üen.

\hypertarget{signifikanztest}{%
\subsubsection{Signifikanztest}\label{signifikanztest}}

Die Beziehung zwischen zwei Variablen zu quantifizieren ist nur ein Teil der Geschichte. H√§ufig stellt man Korrelationen zwischen verschiedenen Variablen auf, wobei sich die Population dabei unterscheiden kann. Was wir wollen ist also ein Nachweis, dass unsere Beobachtung innerhalb der Population wahr oder falsch ist, welches wir durch aufstellen einer Testhypothese erreichen.

Formulierung:

\begin{itemize}
\tightlist
\item
  Unsere Stichprobe ist n gro√ü mit zwei Variablen x und y
\item
  Der Korrelationskoeffizient r ist bekannt und kann berechnet werden
\item
  Der Korrelationskoefffizient der Population œÅ (Griech. Buchstabe ``rho'') zwischen x und y ist unbekannt
\item
  Ziel: Wir wollen eine Aussage √ºber œÅ anhand von r treffen
\end{itemize}

Der Hypothesen-Test l√§sst uns erkennen, ob œÅ nah an 0 ist (kein signfikanter linearer Zusammenhang zwischen x und y in der Population) oder signifikant unterschiedlich von 0 (es gibt einen signfikanten linearern Zusammenhang zwischen x und y in der Population).

\textbf{Schritt 1}

Die \emph{alternative Hypothese} ist immer das, was wir versuchen nachzuweisen (also in unserem Fall das der Zusammenhang signifikant ist mit œÅ ‚â† 0). Die \emph{Null Hypothese} versuchen wir zur√ºckzuweisen, also das es keinen signfikanten Zusammenhang gibt mit œÅ = 0.

\textbf{Schritt 2}

Wir wenden einen T-Test (auch Student's T-Test genannt) an um anhang des Stichprobenumfangs n R√ºckschl√ºsse √ºber die Gesamte Population zu treffen. Der Wert t des Tests erhalten wir durch:

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/059} 

}

\caption{Illustration von Z. Jaadi: https://towardsdatascience.com}\label{fig:unnamed-chunk-269}
\end{figure}

mit n = Stichprobenumfang und r = Korrelationskoeffizient. Je gr√∂√üer der T-Wert ist, desto wahrscheinlicher ist es das die Korrelation wiederholbar und damit signifikant ist. Aber wie gro√ü ist gro√ü genug? Das ist der n√§chste Schritt.

\textbf{Schritt 3}

Jeder T-Wert hat einen assoziierten p-Wert. Der p-Wert ist die Wahrscheinlichkeit, dass die Null-Hypothese wahr ist. In unserem Beispiel also die Wahrscheinlichkeit, dass die Korrelation zwischen x und y zuf√§llig ist. Ein p-Wert von 0.05 bedeutet, dass die Wahrscheinlichkeit f√ºr eine zuf√§llige Korrelation nur 5\% betr√§gt, ein Wert von 0.01 sogar nur 1\%. In den meisten Studien wird die Grenze zwischen signifikant und nicht-signfikant bei einem p-Wert von 0.05 gesetzt oder kleiner. Dieser Bereich ist der Signifikanzbereich Œ±. Wir k√∂nnen unser Signfikanzlevel bei 0.05 setzen (Œ± = 0.05) und den p-Wert finden. Dazu ben√∂tigen wir (i) den T-Wert (Schritt 2) und die Anzahl der Freiheitsgrade die berechnet werden k√∂nnen mit df = n - 2. Aus diesen beiden Werten kann der p-Wert mit einer Software oder durch nachschlagen in T-Tabellen erfolgen.

\begin{itemize}
\tightlist
\item
  Wenn der p-Wert kleiner als das Signifikanzlevel (Œ± = 0.05) ist, dann wird die Null-Hypothese zur√ºckgewiesen. Die Korrelation ist also statistisch signifkant!
\item
  Wenn der p-Wert gr√∂√üer ist, k√∂nnen wir die Null-Hypothese nicht zur√ºckweisen und es gibt keinen signfikanten Zusammenhang zwischen den Variablen.
\end{itemize}

In R k√∂nnen wir den p-Wert mit der Funktion \texttt{cor.test()} berechnen:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cor.test}\NormalTok{(koog\_day}\SpecialCharTok{$}\NormalTok{sr, koog\_day}\SpecialCharTok{$}\NormalTok{bat, }\AttributeTok{method =} \StringTok{"pearson"}\NormalTok{, }\AttributeTok{na.action =} \StringTok{"na.omit"}\NormalTok{)}
\DocumentationTok{\#\# }
\DocumentationTok{\#\#  Pearson\textquotesingle{}s product{-}moment correlation}
\DocumentationTok{\#\# }
\DocumentationTok{\#\# data:  koog\_day$sr and koog\_day$bat}
\DocumentationTok{\#\# t = 42.641, df = 3788, p{-}value \textless{} 2.2e{-}16}
\DocumentationTok{\#\# alternative hypothesis: true correlation is not equal to 0}
\DocumentationTok{\#\# 95 percent confidence interval:}
\DocumentationTok{\#\#  0.5475856 0.5906248}
\DocumentationTok{\#\# sample estimates:}
\DocumentationTok{\#\#       cor }
\DocumentationTok{\#\# 0.5694954}
\end{Highlighting}
\end{Shaded}

Unser p-Wert ist \textless{} 2.2e-16 und damit niedriger als unser Signfikanzlevel bei 0.05 (Œ± = 0.05). Wir k√∂nnen die Null-Hypothese also zur√ºckweisen es gibt einen signfikanten linearen Zusammenhang in unseren Variablen Solarstrahlung und Batteriespannung.

\hypertarget{korrelation-vs.-regression}{%
\subsubsection{Korrelation vs.~Regression}\label{korrelation-vs.-regression}}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/060} 

}

\caption{Illustration von Z. Jaadi: https://towardsdatascience.com}\label{fig:unnamed-chunk-271}
\end{figure}

Diese Begriffe werden h√§ufig durcheinander geworfen. Korrelation ist ein statistisches Ma√ü um die Richtung und St√§rke eines Zusammenhanges wiederzugeben. Regression ist eine Technik um die abh√§ngige Variable y vorherzusagen basierend auf der bekannten Variable x und der Gleichung y = a + bx.

\hypertarget{pca}{%
\subsection{PCA}\label{pca}}

üîç \href{http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/}{sthda.com}

Eine Hauptkomponentenanalyse (engl. Principal component analysis; PCA) ist ein Verfahren der multivariaten Statistik. Dadurch k√∂nnen gro√üe Datens√§tze strukturiert und vereinfacht werden, durch eine m√∂glichst geringe Zahl aussagekr√§ftiger Linearkombinationen (\textbf{Hauptkomponenten}). PCA wird verwendet um Informationen von einer Vielzahl (inter-korrelierten) quantitativen Variablen zu extrahieren. Diese Informationen werden reduziert zu den genannten wenigen Hauptkomponenten (= principal components = PC).

Das Ziel einer PCA ist es die Hauptachsen (PC) so zu arrangieren, dass die Variation der Daten maximiert wird. Einfach ausgedr√ºckt kann man eine PCA als Rotation des Koordinatensystems verstehen:

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/046} 

}

\caption{Illustration von C.Wilke: https://wilkelab.org/SDS375/}\label{fig:unnamed-chunk-272}
\end{figure}

üí° Eine PCA ist besonders dann n√ºtzlich, wenn die Variablen in einem Datensatz stark korreliert sind. Korrelation bedeutet Redundanz und wegen dieser Redundanz kann eine PCA viele Variablen in eine geringere Anzahl an neuen Variablen (= PC) umwandeln, welche m√∂glichst viel Varianz der urspr√ºnglichen Daten erkl√§ren.

In R gibt es mehrere M√∂glichkeiten eine PCA durchzuf√ºhren

\begin{itemize}
\tightlist
\item
  prcomp() and princomp() {[}built-in R stats package{]}
\item
  PCA() {[}FactoMineR package{]}
\item
  dudi.pca() {[}ade4 package{]}
\item
  epPCA() {[}ExPosition package{]}
\end{itemize}

Egal welches package man verwendet, die Daten der PCA k√∂nnen auch mit dem \texttt{factoextra} package verarbeitet werden. Dies hat den Vorteil, dass die Visualisierung \texttt{ggplot2}-basiert ist.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Laden des Datensatzes }
\NormalTok{df\_ec }\OtherTok{\textless{}{-}}\NormalTok{ readr}\SpecialCharTok{::}\FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/data\_ecuador.csv"}\NormalTok{, }\AttributeTok{delim =} \StringTok{";"}\NormalTok{, }\AttributeTok{col\_types =} 
                          \FunctionTok{cols}\NormalTok{(}
                            \AttributeTok{wsc =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{wsc\_ma =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{wsc\_som =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{hwsc =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{hwsc\_ma =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{hwsc\_som =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{wsc\_hwsc\_som =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{Fed =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{Feo =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{Feo\_Fed =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{Fepyro =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{Mno =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{Alo =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{Sio =} \FunctionTok{col\_double}\NormalTok{(),}
                            \AttributeTok{Alpyro =} \FunctionTok{col\_double}\NormalTok{()}
\NormalTok{                          )}
\NormalTok{                        )}

\CommentTok{\# Laden der packages}
\FunctionTok{library}\NormalTok{(factoextra)}
\FunctionTok{library}\NormalTok{(FactoMineR)}
\end{Highlighting}
\end{Shaded}

\hypertarget{datenauswahl}{%
\subsubsection{Datenauswahl}\label{datenauswahl}}

Zuerst w√§hlen wir die Daten aus, welche wir in der PCA ber√ºcksichtigen wollen.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create one data frame with the data}
\NormalTok{df\_pca }\OtherTok{\textless{}{-}}\NormalTok{ df\_ec }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(site\_name, depth, som}\SpecialCharTok{:}\NormalTok{P2O5, }\SpecialCharTok{{-}}\NormalTok{mat\_amorph, }\SpecialCharTok{{-}}\NormalTok{index) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{na.omit}\NormalTok{() }\CommentTok{\# Mit dem Befehl werden NA Werte aus den Daten entfernt...wichtig (!) bevor die PCA durchgef√ºhrt werden kann}

\CommentTok{\# Create one data frame }
\NormalTok{df\_var }\OtherTok{\textless{}{-}}\NormalTok{ df\_pca }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(site\_name, depth)}

\FunctionTok{head}\NormalTok{(df\_pca, }\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 44}
\DocumentationTok{\#\#   site\_name depth   som   wsc wsc\_ma wsc\_som  hwsc hwsc\_ma hwsc\_som wsc\_hwsc\_som}
\DocumentationTok{\#\#   \textless{}chr\textgreater{}     \textless{}chr\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}        \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 PA1       0{-}30   167  1.24      37   0.007  5.11      44    0.031        0.038}
\DocumentationTok{\#\# 2 PA1       30{-}60  118. 0.538     32   0.005  2.30      37    0.02         0.024}
\DocumentationTok{\#\# 3 PA1       60{-}90  114. 0.301     31   0.003  1.46      37    0.013        0.015}
\DocumentationTok{\#\# 4 PA1       0{-}30   162. 1.15      39   0.007  5.04      44    0.031        0.038}
\DocumentationTok{\#\# 5 PA1       30{-}60  115. 0.46      38   0.004  1.91      37    0.017        0.021}
\DocumentationTok{\#\# \# ... with 34 more variables: N \textless{}dbl\textgreater{}, C\_N \textless{}dbl\textgreater{}, ph\_h2o \textless{}dbl\textgreater{}, ph\_cacl2 \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   delta\_ph \textless{}dbl\textgreater{}, ph\_naf \textless{}dbl\textgreater{}, melanic\_index \textless{}dbl\textgreater{}, bs \textless{}dbl\textgreater{}, Ca \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   Mg \textless{}dbl\textgreater{}, K \textless{}dbl\textgreater{}, Na  \textless{}dbl\textgreater{}, Al \textless{}dbl\textgreater{}, Fe \textless{}dbl\textgreater{}, Mn \textless{}dbl\textgreater{}, H \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   Fed \textless{}dbl\textgreater{}, Feo \textless{}dbl\textgreater{}, Feo\_Fed \textless{}dbl\textgreater{}, Fepyro \textless{}dbl\textgreater{}, Mno \textless{}dbl\textgreater{}, Alo \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   Sio \textless{}dbl\textgreater{}, Alpyro \textless{}dbl\textgreater{}, SiO2 \textless{}dbl\textgreater{}, TiO2 \textless{}dbl\textgreater{}, Al2O3 \textless{}dbl\textgreater{}, Fe2O3 \textless{}dbl\textgreater{},}
\DocumentationTok{\#\# \#   MnO \textless{}dbl\textgreater{}, MgO \textless{}dbl\textgreater{}, CaO \textless{}dbl\textgreater{}, Na2O \textless{}dbl\textgreater{}, K2O \textless{}dbl\textgreater{}, P2O5 \textless{}dbl\textgreater{}}
\end{Highlighting}
\end{Shaded}

\hypertarget{daten-standardisieren}{%
\subsubsection{Daten Standardisieren}\label{daten-standardisieren}}

Bei einer PCA werden die Daten h√§ufig standardisiert, also skaliert. Dies ist besonders wichtig wenn die Einheiten stark unterschiedlich sind, bspw. in \%, mg kg\textsuperscript{-1}, etc.

üí° Wenn man die Funktion \texttt{PCA()} im FactoMineR verwendet, gibt es das Argument die Daten zu standardisieren. Dies muss also nicht im Vorfeld durchgef√ºhrt werden.

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{pca }\OtherTok{\textless{}{-}} \FunctionTok{PCA}\NormalTok{(df\_pca[,}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)], }\AttributeTok{scale.unit =}\NormalTok{ T, }\AttributeTok{ncp =} \DecValTok{5}\NormalTok{, }\AttributeTok{graph =}\NormalTok{ F) }\CommentTok{\# Makes the PCA but without the site\_name and depth grouping value}
\NormalTok{pca}
\DocumentationTok{\#\# **Results for the Principal Component Analysis (PCA)**}
\DocumentationTok{\#\# The analysis was performed on 44 individuals, described by 42 variables}
\DocumentationTok{\#\# *The results are available in the following objects:}
\DocumentationTok{\#\# }
\DocumentationTok{\#\#    name               description                          }
\DocumentationTok{\#\# 1  "$eig"             "eigenvalues"                        }
\DocumentationTok{\#\# 2  "$var"             "results for the variables"          }
\DocumentationTok{\#\# 3  "$var$coord"       "coord. for the variables"           }
\DocumentationTok{\#\# 4  "$var$cor"         "correlations variables {-} dimensions"}
\DocumentationTok{\#\# 5  "$var$cos2"        "cos2 for the variables"             }
\DocumentationTok{\#\# 6  "$var$contrib"     "contributions of the variables"     }
\DocumentationTok{\#\# 7  "$ind"             "results for the individuals"        }
\DocumentationTok{\#\# 8  "$ind$coord"       "coord. for the individuals"         }
\DocumentationTok{\#\# 9  "$ind$cos2"        "cos2 for the individuals"           }
\DocumentationTok{\#\# 10 "$ind$contrib"     "contributions of the individuals"   }
\DocumentationTok{\#\# 11 "$call"            "summary statistics"                 }
\DocumentationTok{\#\# 12 "$call$centre"     "mean of the variables"              }
\DocumentationTok{\#\# 13 "$call$ecart.type" "standard error of the variables"    }
\DocumentationTok{\#\# 14 "$call$row.w"      "weights for the individuals"        }
\DocumentationTok{\#\# 15 "$call$col.w"      "weights for the variables"}
\end{Highlighting}
\end{Shaded}

Das Ergebnis der Funktion \texttt{PCA()} ist eine Liste mit verschiedenen Komponenten.

Wichtige FUnktionen in dem factoextra package lauten:

\begin{itemize}
\tightlist
\item
  get\_eigenvalue(res.pca): Extrahiert Eigenvalues/Varianz der PC
\item
  fviz\_eig(res.pca): Visualisiert die Eigenvalues
\item
  get\_pca\_ind(res.pca), get\_pca\_var(res.pca): Extrahiert das Ergenis spezieller Variablen
\item
  fviz\_pca\_ind(res.pca), fviz\_pca\_var(res.pca): Visualisiert das Ergenis spezieller Variablen
\item
  fviz\_pca\_biplot(res.pca): Biplot individueller Variablen
\end{itemize}

\hypertarget{eigenvalues}{%
\subsubsection{Eigenvalues}\label{eigenvalues}}

Eigenvalues messen die St√§rke der Variation jeder PC.

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{eig.val }\OtherTok{\textless{}{-}} \FunctionTok{get\_eigenvalue}\NormalTok{(pca)}
\NormalTok{eig.val }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\#       eigenvalue variance.percent cumulative.variance.percent}
\DocumentationTok{\#\# Dim.1 22.0353186        53.744680                    53.74468}
\DocumentationTok{\#\# Dim.2 10.7046683        26.108947                    79.85363}
\DocumentationTok{\#\# Dim.3  2.0512772         5.003115                    84.85674}
\DocumentationTok{\#\# Dim.4  1.5700885         3.829484                    88.68623}
\DocumentationTok{\#\# Dim.5  0.9291947         2.266328                    90.95255}
\end{Highlighting}
\end{Shaded}

F√ºr den Ecuador Datensatz erkl√§ren die Eigenvalues der ersten zwei PCs 83\% der Varianz (das ist viel). Wieviele PCs f√ºr die Auswahl der PCA wichtig sind l√§sst sich nicht objektiv sagen. Eine M√∂glichkeit ist es einen Wert festzulegen, mit dem man selber zufrieden ist:

\begin{quote}
You can also limit the number of component to that number that accounts for a certain fraction of the total variance. For example, if you are satisfied with 70\% of the total variance explained then use the number of components to achieve that. (Kaiser 1961)
\end{quote}

Eine graphische Darstellung der Eigenvalue ist auch eine M√∂glichkeit:

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{fviz\_eig}\NormalTok{(pca, }\AttributeTok{addlabels =}\NormalTok{ T, }\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{60}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-277-1} \end{center}

In der Darstellung sind die EIgenvalues absteigend sortiert und man w√§hlt den Punkt aus, wo die vebleibenden Eigenvalues gleichbleibend klein bleiben (in unserem Fall ab der dritten PC).

\hypertarget{darstellen-der-ergebnisse}{%
\subsubsection{Darstellen der Ergebnisse}\label{darstellen-der-ergebnisse}}

Die einfachste Methode ist mit der Funktion \texttt{get\_pca\_var()}.

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{var }\OtherTok{\textless{}{-}} \FunctionTok{get\_pca\_var}\NormalTok{(pca)}
\NormalTok{var}
\DocumentationTok{\#\# Principal Component Analysis Results for variables}
\DocumentationTok{\#\#  ===================================================}
\DocumentationTok{\#\#   Name       Description                                    }
\DocumentationTok{\#\# 1 "$coord"   "Coordinates for the variables"                }
\DocumentationTok{\#\# 2 "$cor"     "Correlations between variables and dimensions"}
\DocumentationTok{\#\# 3 "$cos2"    "Cos2 for the variables"                       }
\DocumentationTok{\#\# 4 "$contrib" "contributions of the variables"}
\end{Highlighting}
\end{Shaded}

Die vier verschiedenen Komponenten von \texttt{get\_pca\_var()} k√∂nnen genutzt werden um die Ergebnisse auf verschiedenen Art darzustellen:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Coordinates}
\FunctionTok{head}\NormalTok{(var}\SpecialCharTok{$}\NormalTok{coord)}
\DocumentationTok{\#\#              Dim.1       Dim.2      Dim.3       Dim.4        Dim.5}
\DocumentationTok{\#\# som     {-}0.9035830 0.401687675 0.02396744  0.04367303  0.007574548}
\DocumentationTok{\#\# wsc     {-}0.4272716 0.818221888 0.23566053  0.01842607  0.228960043}
\DocumentationTok{\#\# wsc\_ma   0.9311431 0.009632107 0.06882345  0.31524171 {-}0.038210767}
\DocumentationTok{\#\# wsc\_som  0.1897357 0.870939967 0.25573775 {-}0.10827495  0.234158268}
\DocumentationTok{\#\# hwsc    {-}0.4664379 0.858078439 0.11239753  0.02954132  0.055621320}
\DocumentationTok{\#\# hwsc\_ma  0.9266593 0.008194929 0.09076181  0.30533813 {-}0.039134670}
\CommentTok{\# Cos2: Quality on the factore map}
\FunctionTok{head}\NormalTok{(var}\SpecialCharTok{$}\NormalTok{cos2)}
\DocumentationTok{\#\#              Dim.1        Dim.2        Dim.3        Dim.4        Dim.5}
\DocumentationTok{\#\# som     0.81646222 1.613530e{-}01 0.0005744384 0.0019073332 5.737378e{-}05}
\DocumentationTok{\#\# wsc     0.18256102 6.694871e{-}01 0.0555358864 0.0003395199 5.242270e{-}02}
\DocumentationTok{\#\# wsc\_ma  0.86702742 9.277748e{-}05 0.0047366671 0.0993773365 1.460063e{-}03}
\DocumentationTok{\#\# wsc\_som 0.03599964 7.585364e{-}01 0.0654017962 0.0117234644 5.483009e{-}02}
\DocumentationTok{\#\# hwsc    0.21756428 7.362986e{-}01 0.0126332053 0.0008726898 3.093731e{-}03}
\DocumentationTok{\#\# hwsc\_ma 0.85869745 6.715687e{-}05 0.0082377069 0.0932313730 1.531522e{-}03}
\CommentTok{\# Contribution to the PCA}
\FunctionTok{head}\NormalTok{(var}\SpecialCharTok{$}\NormalTok{contrib)}
\DocumentationTok{\#\#             Dim.1        Dim.2      Dim.3      Dim.4      Dim.5}
\DocumentationTok{\#\# som     3.7052436 1.5073142260 0.02800394 0.12147935 0.00617457}
\DocumentationTok{\#\# wsc     0.8284928 6.2541597721 2.70738089 0.02162425 5.64173514}
\DocumentationTok{\#\# wsc\_ma  3.9347170 0.0008667011 0.23091307 6.32940986 0.15713206}
\DocumentationTok{\#\# wsc\_som 0.1633725 7.0860339197 3.18834513 0.74667539 5.90081897}
\DocumentationTok{\#\# hwsc    0.9873435 6.8782944667 0.61587022 0.05558220 0.33294759}
\DocumentationTok{\#\# hwsc\_ma 3.8969142 0.0006273606 0.40158917 5.93796928 0.16482256}
\end{Highlighting}
\end{Shaded}

\hypertarget{darstellung-im-koordinatensystem}{%
\paragraph{Darstellung im Koordinatensystem}\label{darstellung-im-koordinatensystem}}

Um die Variablen im Koordinatensystem darzustellen eignet sich der folgende Befehl:

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{fviz\_pca\_var}\NormalTok{(pca, }\AttributeTok{repel =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-280-1} \end{center}

Dieser Plot wird auch als \textbf{Variable correlation plot} bezeichnet und zeigt die Beziehung zwischen den Variablen:

\begin{itemize}
\tightlist
\item
  Positiv korrelierte Variablen clustern zusammen * Negativ korrelierte Variablen sind gegen√ºber positioniert (gegen√ºberliegende Quadranten)
\item
  Der Abstand der Variable zum Zentrum des Kreises stellt die Qualit√§t der Variable auf der factor map da. Weit entfernte Variablen werden auf der factor map besser dargestellt.
\end{itemize}

Die Qualit√§t der Darstellung wird √ºber \textbf{cos2} definiert (quadrierter Cosinus, quadrierte Koordinaten). Darstellen kann man den Zusammenhang als barplot:

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{fviz\_cos2}\NormalTok{(pca, }\AttributeTok{choice =} \StringTok{"var"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-281-1} \end{center}

Ein gro√üer cos2 Wert bedeutet eine gute Repr√§sentation der Variable auf der PC. In diesem Fall ist die Variable nah am Kreisumfang positioniert.
Ein niedriger co2 Wert bedeutet, dass die Variable nicht perfekt dargestellt wird, wobei die Variable n√§her am Zentrum des Kreises liegt. Die Summe des cos2 einer Variable auf allen PCs ist = 1.
Wenn eine Variable also perfekt durch nur zwei PCs dargestellt wird, dann ist der cos2 Werte \textasciitilde1 und die Variable liegt nah am Kreisumfang. Wozu ist der cos2 also wichtig?

\begin{itemize}
\tightlist
\item
  Beschreibt die QUalit√§t der Darstellung
\item
  Je n√§her die Variable am Kreisumfang desto besser wird diese Variable auf der factor map dargestellt.
\item
  Variablen nahe des Kreiszentrums tragen wenig zur ersten PC bei
\end{itemize}

Die QUalit√§t der Variable kann auch farblich dargestellt werden:

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{fviz\_pca\_var}\NormalTok{(pca, }\AttributeTok{col.var =} \StringTok{"cos2"}\NormalTok{, }\AttributeTok{gradient.cols =} \FunctionTok{c}\NormalTok{(}\StringTok{"\#00AFBB"}\NormalTok{, }\StringTok{"\#E7B800"}\NormalTok{, }\StringTok{"\#FC4E07"}\NormalTok{), }
             \AttributeTok{repel =} \ConstantTok{TRUE} \CommentTok{\# Avoid text overlapping}
\NormalTok{             )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-282-1} \end{center}

\hypertarget{beitrag-einer-variable-zur-pca}{%
\paragraph{Beitrag einer Variable zur PCA}\label{beitrag-einer-variable-zur-pca}}

Der Beitrag einer Variable f√ºr die Variabilit√§t einer PC wird in \% angegeben.

\begin{itemize}
\tightlist
\item
  Variablen die mit PC1 (Dim.1) und PC2 (Dim.2) korreliert sind haben die gr√∂√üte Bedeutung um die Variabilit√§t im Datensatz zu erkl√§ren.
\item
  Variablen die mit keiner PC korrelieren haben den geringsten Beitrag
\end{itemize}

üí° Um die Aussage einer PCA zu verst√§rken k√∂nnen Variablen mit einem geringen Beitrag von der Analyse ausgeschlossen werden.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Show the variables contributing to PC1}
\FunctionTok{fviz\_contrib}\NormalTok{(pca, }\AttributeTok{choice =} \StringTok{"var"}\NormalTok{, }\AttributeTok{axes =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-283-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Show the variables contributing to PC2}
\FunctionTok{fviz\_contrib}\NormalTok{(pca, }\AttributeTok{choice =} \StringTok{"var"}\NormalTok{, }\AttributeTok{axes =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-283-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Show the variables contributing to PC1 AND PC2}
\FunctionTok{fviz\_contrib}\NormalTok{(pca, }\AttributeTok{choice =} \StringTok{"var"}\NormalTok{, }\AttributeTok{axes =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-283-3} \end{center}

SOM, pH und hwsc tragen am meisten zu PC1 und PC2 bei, die mineralogischen Kennwerte des Eisens spielen eine untergeordnete Rolle.

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{fviz\_pca\_var}\NormalTok{(pca, }\AttributeTok{col.var =} \StringTok{"contrib"}\NormalTok{, }\AttributeTok{repel =}\NormalTok{ T, }\AttributeTok{gradient.cols =} \FunctionTok{c}\NormalTok{(}\StringTok{"\#00AFBB"}\NormalTok{, }\StringTok{"\#E7B800"}\NormalTok{, }\StringTok{"\#FC4E07"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-284-1} \end{center}

Je n√§her der Pfeil am Kreisumfang positioniert ist, desto gr√∂√üer ist der Beitrag einer Variable f√ºr die Separierung der Daten.

\hypertarget{darstellen-der-individuen-in-der-pca}{%
\paragraph{Darstellen der Individuen in der PCA}\label{darstellen-der-individuen-in-der-pca}}

Die Informationen der Individuen k√∂nnen mit der Funktion \texttt{get\_pca\_ind()} abgerufen werden.

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{ind }\OtherTok{\textless{}{-}} \FunctionTok{get\_pca\_ind}\NormalTok{(pca)}

\CommentTok{\# Coordinates of individuals}
\FunctionTok{head}\NormalTok{(ind}\SpecialCharTok{$}\NormalTok{coord)}
\DocumentationTok{\#\#       Dim.1      Dim.2      Dim.3      Dim.4      Dim.5}
\DocumentationTok{\#\# 1 {-}3.555229  6.1901987 0.36582084  0.2385691  0.4755535}
\DocumentationTok{\#\# 2 {-}1.853013 {-}0.1218242 1.25100363 {-}1.8782000 {-}0.3163522}
\DocumentationTok{\#\# 3 {-}1.640374 {-}1.1297505 0.72048321 {-}0.9106315 {-}0.1500884}
\DocumentationTok{\#\# 4 {-}2.135484  6.8982505 0.08300526  0.1573187  0.4908759}
\DocumentationTok{\#\# 5 {-}1.465293  0.1039718 0.85549779 {-}1.3135040 {-}0.4857763}
\DocumentationTok{\#\# 6 {-}1.196337 {-}2.4444755 0.78528722 {-}0.6925059  0.6547019}
\CommentTok{\# Quality of individuals}
\FunctionTok{head}\NormalTok{(ind}\SpecialCharTok{$}\NormalTok{cos2)}
\DocumentationTok{\#\#        Dim.1       Dim.2        Dim.3        Dim.4       Dim.5}
\DocumentationTok{\#\# 1 0.23462355 0.711288225 0.0024841244 0.0010564888 0.004197930}
\DocumentationTok{\#\# 2 0.28017327 0.001210980 0.1276987925 0.2878414594 0.008166037}
\DocumentationTok{\#\# 3 0.23813244 0.112952985 0.0459388781 0.0733868052 0.001993549}
\DocumentationTok{\#\# 4 0.07515351 0.784213920 0.0001135449 0.0004078658 0.003971002}
\DocumentationTok{\#\# 5 0.30414848 0.001531328 0.1036751558 0.2443991716 0.033427938}
\DocumentationTok{\#\# 6 0.09606433 0.401075715 0.0413915834 0.0321885866 0.028770156}
\CommentTok{\# Contributions of individuals}
\FunctionTok{head}\NormalTok{(ind}\SpecialCharTok{$}\NormalTok{contrib)}
\DocumentationTok{\#\#       Dim.1        Dim.2       Dim.3      Dim.4      Dim.5}
\DocumentationTok{\#\# 1 1.3036565  8.135482080 0.148272248 0.08238567 0.55314543}
\DocumentationTok{\#\# 2 0.3541482  0.003150948 1.733964139 5.10630656 0.24478359}
\DocumentationTok{\#\# 3 0.2775325  0.270981201 0.575136197 1.20035171 0.05509788}
\DocumentationTok{\#\# 4 0.4703494 10.103039065 0.007633684 0.03582480 0.58936466}
\DocumentationTok{\#\# 5 0.2214505  0.002295120 0.810887778 2.49738790 0.57718269}
\DocumentationTok{\#\# 6 0.1476166  1.268660714 0.683250614 0.69417683 1.04840204}
\end{Highlighting}
\end{Shaded}

Plots: Quality and contribution

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{fviz\_pca\_ind}\NormalTok{(pca, }\AttributeTok{repel =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-286-1} \end{center}

Individuen k√∂nnen auch nach dem cos2 Wert gruppiert werden

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Group by color}
\FunctionTok{fviz\_pca\_ind}\NormalTok{(pca, }\AttributeTok{col.ind =} \StringTok{"cos2"}\NormalTok{, }
             \AttributeTok{gradient.cols =} \FunctionTok{c}\NormalTok{(}\StringTok{"\#00AFBB"}\NormalTok{, }\StringTok{"\#E7B800"}\NormalTok{, }\StringTok{"\#FC4E07"}\NormalTok{),}
             \AttributeTok{repel =} \ConstantTok{TRUE} \CommentTok{\# Avoid text overlapping (slow if many points)}
\NormalTok{             )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-287-1} \end{center}

üí° Individuen mit √§hnlichen Eigenschaften werden zusammen gruppiert.

Um den Anteil (contribution) der ersten zwei PC (DIM.1 und DIM.2) darzustellen schreibe:

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{fviz\_contrib}\NormalTok{(pca, }\AttributeTok{choice =} \StringTok{"ind"}\NormalTok{, }\AttributeTok{axes =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-288-1} \end{center}

Die Proben 39,42,36,37 tragen am meisten f√ºr die Separierung der Daten bei, die Proben 2,3,5 am wenigsten.

\hypertarget{farbliche-darstellung}{%
\paragraph{Farbliche Darstellung}\label{farbliche-darstellung}}

Wie f√ºr Variablen k√∂nnen auch Individuen farblich dargestellt werden, bspw. nach Kategorien gruppiert werden (Standort, Tiefe). Argument \texttt{habillage} oder \texttt{col.ind} kann genutzt werden um Individuen nach Gruppen darzustellen. Um eine Ellipse zu erzeugen kann \texttt{addEllipses\ =\ T} gesetzt werden:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create one data frame with the data}
\NormalTok{df\_pca }\OtherTok{\textless{}{-}}\NormalTok{ df\_ec }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(site\_name, depth, som}\SpecialCharTok{:}\NormalTok{P2O5, }\SpecialCharTok{{-}}\NormalTok{mat\_amorph, }\SpecialCharTok{{-}}\NormalTok{index) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{na.omit}\NormalTok{() }\CommentTok{\# Mit dem Befehl werden NA Werte aus den Daten entfernt...wichtig (!) bevor die PCA durchgef√ºhrt werden kann}

\CommentTok{\# Create one data frame only for the grouping variable}
\NormalTok{df\_var }\OtherTok{\textless{}{-}}\NormalTok{ df\_pca }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(site\_name, depth)}

\NormalTok{pca }\OtherTok{\textless{}{-}} \FunctionTok{PCA}\NormalTok{(df\_pca[,}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)], }\AttributeTok{scale.unit =}\NormalTok{ T, }\AttributeTok{ncp =} \DecValTok{5}\NormalTok{, }\AttributeTok{graph =}\NormalTok{ F) }\CommentTok{\# Makes the PCA but without the site\_name and depth grouping value}

\CommentTok{\# Gruppieren nach Standort}
\FunctionTok{fviz\_pca\_ind}\NormalTok{(pca,}
             \AttributeTok{col.ind =}\NormalTok{ df\_var}\SpecialCharTok{$}\NormalTok{site\_name, }\CommentTok{\# color by site\_name}
             \AttributeTok{addEllipses =} \ConstantTok{TRUE}\NormalTok{, }\CommentTok{\# Concentration ellipses}
             \AttributeTok{label=} \StringTok{"var"}\NormalTok{,}
             \AttributeTok{legend.title =} \StringTok{"Plot"}\NormalTok{,}
             \AttributeTok{repel =} \ConstantTok{TRUE} \CommentTok{\# to not have overlapping text in the figure}
\NormalTok{             )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-289-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Gruppieren nach Tiefe}
\FunctionTok{fviz\_pca\_ind}\NormalTok{(pca,}
             \AttributeTok{geom.var =} \StringTok{"arrow"}\NormalTok{,}
             \AttributeTok{col.ind =}\NormalTok{ df\_var}\SpecialCharTok{$}\NormalTok{depth, }\CommentTok{\# color by depth}
             \AttributeTok{addEllipses =} \ConstantTok{TRUE}\NormalTok{, }\CommentTok{\# Concentration ellipses}
             \AttributeTok{label=} \StringTok{"var"}\NormalTok{,}
             \AttributeTok{legend.title =} \StringTok{"Plot"}\NormalTok{,}
             \AttributeTok{repel =} \ConstantTok{TRUE} \CommentTok{\# to not have overlapping text in the figure}
\NormalTok{             )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-289-2} \end{center}

In diese Darstellung flie√üen ALLE numerischen Variablen des Datensatzes ein. Die Paramo-Standorte clustern sehr sch√∂n zusammen und es gibt eine Separierung von AC1 und AC2. Besonders AC2 unterscheidet sich signifikant. Ein sehr sch√∂nes Ergebnis, dass den Einfluss von 100 Jahren landwirtschaftliche Nutzung hervorhebt.

\hypertarget{figure}{%
\paragraph{Figure}\label{figure}}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Gruppieren nach Standort}
\NormalTok{p1 }\OtherTok{\textless{}{-}} \FunctionTok{fviz\_pca\_ind}\NormalTok{(pca,}
             \AttributeTok{col.ind =}\NormalTok{ df\_var}\SpecialCharTok{$}\NormalTok{site\_name, }\CommentTok{\# color by site\_name}
             \AttributeTok{addEllipses =} \ConstantTok{TRUE}\NormalTok{, }\CommentTok{\# Concentration ellipses}
             \AttributeTok{label=} \StringTok{"var"}\NormalTok{,}
             \AttributeTok{legend.title =} \StringTok{"Plot"}\NormalTok{,}
             \AttributeTok{repel =} \ConstantTok{TRUE} \CommentTok{\# to not have overlapping text in the figure}
\NormalTok{             )}

\CommentTok{\# Gruppieren nach Tiefe}
\NormalTok{p2 }\OtherTok{\textless{}{-}} \FunctionTok{fviz\_pca\_ind}\NormalTok{(pca,}
             \AttributeTok{geom.var =} \StringTok{"arrow"}\NormalTok{,}
             \AttributeTok{col.ind =}\NormalTok{ df\_var}\SpecialCharTok{$}\NormalTok{depth, }\CommentTok{\# color by depth}
             \AttributeTok{addEllipses =} \ConstantTok{TRUE}\NormalTok{, }\CommentTok{\# Concentration ellipses}
             \AttributeTok{label=} \StringTok{"var"}\NormalTok{,}
             \AttributeTok{legend.title =} \StringTok{"Depth"}\NormalTok{,}
             \AttributeTok{repel =} \ConstantTok{TRUE} \CommentTok{\# to not have overlapping text in the figure}
\NormalTok{             )}

\NormalTok{p1 }\SpecialCharTok{+}\NormalTok{ p2 }\SpecialCharTok{+} \FunctionTok{plot\_annotation}\NormalTok{(}\AttributeTok{tag\_levels =} \StringTok{"A"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-290-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"images/results/PCA\_1.png"}\NormalTok{, }\AttributeTok{width =} \DecValTok{12}\NormalTok{, }\AttributeTok{height =} \DecValTok{5}\NormalTok{)}


\FunctionTok{fviz\_pca\_biplot}\NormalTok{(pca, }\AttributeTok{repel =} \ConstantTok{TRUE}\NormalTok{,}\CommentTok{\#to not have overlapping text}
                \CommentTok{\#variables}
                \AttributeTok{col.var =} \StringTok{"contrib"}\NormalTok{,}\CommentTok{\# colour variables according to their contribution to the variance between the axes}
                \AttributeTok{gradient.cols =} \FunctionTok{c}\NormalTok{(}\StringTok{"\#00AFBB"}\NormalTok{, }\StringTok{"\#E7B800"}\NormalTok{, }\StringTok{"\#FC4E07"}\NormalTok{),}
               \CommentTok{\#individuals}
                \AttributeTok{geom.ind =} \StringTok{"point"}\NormalTok{,}\CommentTok{\#using point shape for our indidividual data points}
                \AttributeTok{fill.ind =}\NormalTok{ df\_var}\SpecialCharTok{$}\NormalTok{site\_name, }\AttributeTok{col.ind =} \StringTok{"black"}\NormalTok{, }\CommentTok{\#group and colour according to plot and black border of points}
                \AttributeTok{pointshape =} \DecValTok{21}\NormalTok{, }\AttributeTok{pointsize =} \DecValTok{2}\NormalTok{,}\CommentTok{\#pointshape 21 is the circel with 2 differing colours important for visibility, pointsize can be adjusted if you want}
                \AttributeTok{palette =} \FunctionTok{c}\NormalTok{(}\StringTok{"red"}\NormalTok{, }\StringTok{"orange"}\NormalTok{, }\StringTok{"\#c7e9c0"}\NormalTok{,}\StringTok{"\#41ab5d"}\NormalTok{,}\StringTok{"\#006d2c"}\NormalTok{),}\CommentTok{\# maybe adjust the colour setting here, I tried to take similar colours to before}
                \AttributeTok{addEllipses =} \ConstantTok{TRUE}\NormalTok{,}\CommentTok{\# addinf ellipses to our group of individual data points}
               \CommentTok{\#supplements}
                \AttributeTok{legend.title =} \FunctionTok{list}\NormalTok{(}\AttributeTok{fill=}\StringTok{"Plot"}\NormalTok{,}\AttributeTok{color =} \StringTok{"Contribution"}\NormalTok{))}\CommentTok{\#customizing our legend}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-290-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"images/results/PCA\_2.png"}\NormalTok{, }\AttributeTok{width =} \DecValTok{9}\NormalTok{, }\AttributeTok{height =} \DecValTok{9}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{datenmanagement}{%
\section{Datenmanagement}\label{datenmanagement}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

\begin{quote}
Managing your projects in a reproducible fashion doesn't just make
your science reproducible, it makes your life easier.

--- Vince Buffalo (@vsbuffalo) \href{https://twitter.com/vsbuffalo/status/323638476153167872}{April 15,
2013}
\end{quote}

üîç \url{https://swcarpentry.github.io/r-novice-gapminder/02-project-intro/index.html}

√úber den Satz bin ich k√ºrzlich gestolpert und es steckt seeeehr viel Wahrheit darin. Eins meiner ersten Projekte in R hat sich mit der Entwicklung von Bodentemperaturen in NRW besch√§ftigt. Hier ein Screenshot √ºber die Ordnerstruktur:

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/049} 

}

\caption{Datenstruktur in R}\label{fig:unnamed-chunk-293}
\end{figure}

Es geht mit Sicherheit noch schlimmer, es geht aber mit Sicherheit auch besser! Im Laufe der Zeit wachsen die Dateien in einem Projekt und man verliert schnell den √úberblick. Die wichtigsten Gr√ºnde warum man so ein Chaos vermeiden sollte:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Man kann nicht sagen, welche Daten Rohdaten sind und welche neu generiert wurden.
\item
  Es wird sehr un√ºbersichtlich, da verschiedene Dateitypen gemixt werden.
\item
  Es dauert lange die richtige Datei zu finden und/oder einer Analyse zuzuordnen.
\end{enumerate}

Die Vorteile einer guten Projektstruktur bietet also:

\begin{itemize}
\tightlist
\item
  Ein seri√∂seres Projektmanagement mit h√∂heren Anspruch an die Daten
\item
  Code oder Informationen mit Kollegen zu teilen geht schneller
\item
  Nach einer Pause an dem Projekt gelingt es einem schneller wieder hereinzufinden
\end{itemize}

Eins der wichtigsten tools in RStudio ist das Anlegen eines \textbf{Projektes}.

File -\textgreater{} New Project -\textgreater{} New Directory -\textgreater{} Klick New Project -\textgreater{} Vergebe einen Projektnamen -\textgreater{} Klick Create Project

Der einfachste Weg ein R Projekt zu √∂ffnen (mit der Endung \textbf{.Rproj}) ist Doppelklick in dem Ordner in dem das Projekt hinterlegt wurde.

üí° Alle Daten, Abbildunge, Skripte, \ldots{} werden mit diesem R Projekt verkn√ºpft sein, dass bedeutet sie sind unabh√§ngig von dem individuellen Pfad (bspw. \texttt{C:\textbackslash{}Dorau\textbackslash{}Arbeit\textbackslash{}04.\ Ver√∂ffentlichungen\textbackslash{}01.\ Ver√∂ffentlichungen\textbackslash{}06.\ Soil\ temperatures\ in\ NRW\textbackslash{}01.\ Reporting\ R}) sondern alles ist relativ zu der .Rproj Datei.

Tipps f√ºr eine gutes Projektmanagement sind die folgenden:

\begin{itemize}
\tightlist
\item
  \textbf{read only} Excel oder andere Austauschformate sind Interaktiv und k√∂nnen manipuliert werden, bspw. durch Verkn√ºpfungen in den Zellen.
\item
  \textbf{Daten bereinigen} ist ein wichtiger und zeitaufw√§ndiger Schritt. Wenn man eine grobe Datenaufbereitung auch in Excel durchgef√ºhrt hat empfiehlt es sich, den urspr√ºnglichen Datensatz als zweite Datei abzuspeichern die nur zum Einlesen der Daten in R verwendet wird.
\item
  \textbf{Analysen in einem Skript sollten reproduzierbar sein} Beim Schreiben von Skripten ist es das Ziel, Abbildungen und generell Metadaten zu erzeugen. Dieser Output sollte von jedem externen anwendbar sein, nur bei Bereitstellung des Skriptes und der Rohdaten.
\item
  Jedes Projekt sollte einen eigenen Ordner haben, der nach dem Projekt benannt ist.
\item
  Erstelle Unterordner in dem Projekt, bspw. um Abbildungen in ein Skript zu laden (\texttt{images}), Daten (\texttt{data}), Literatur (\texttt{doc}) und Ergebnisse der Analyse in einen Ergebnisordner (\texttt{results}).
\item
  Benenne alle Dateien so, dass sie einen Inhalt oder eine Funktion wiederspiegeln.
\end{itemize}

Nun haben wir eine sch√∂ne Ordnerstruktur und k√∂nnen diese Nutzen, um Daten einzulesen. Unsere Daten sind relativ zu dem .Rproj abgespeichert. Wollen wir nun die Daten einlesen mit dem Namen \texttt{data.csv}, die im Ordner \texttt{data} abgespeichert sind m√ºssen wir nur angeben:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle ein Objekt df mit den Daten data.csv}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/data.csv"}\NormalTok{, }\AttributeTok{delim =} \StringTok{";"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Viel Besser und reproduzierbarer im Gegensatz zu:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read\_delim}\NormalTok{(}\StringTok{"C:\textbackslash{}Dorau\textbackslash{}Arbeit}\SpecialCharTok{\textbackslash{}04}\StringTok{. Ver√∂ffentlichungen}\SpecialCharTok{\textbackslash{}01}\StringTok{. Ver√∂ffentlichungen}\SpecialCharTok{\textbackslash{}06}\StringTok{. Soil temperatures in NRW}\SpecialCharTok{\textbackslash{}01}\StringTok{. Reporting R/data.csv"}\NormalTok{, }\AttributeTok{delim =} \StringTok{";"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Beim zweiten sind Fehlermeldungen vorprogrammiert und Herr oder Frau XY k√∂nnen auch nichts damit anfangen, da ihr Computer mit Sicherheit nicht \emph{Dorau} hei√üt und auch die weiteren Pfade quatsch sind.

\hypertarget{reporting-in-rmarkdown}{%
\section{Reporting in Rmarkdown}\label{reporting-in-rmarkdown}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

\hypertarget{mathematische-befehle}{%
\subsection{Mathematische Befehle}\label{mathematische-befehle}}

In einem Textblock kann man sich mathematische Notationen anzeigen lassen, indem man die Gleichung mit einem \texttt{\$} Zeichen umrandet f√ºr \emph{inline equations} und zwei \texttt{\$\$} f√ºr Gleichungen in einer eigenen Zeile.

üö® Kein Leerzeichen zwischen dem \texttt{\$} und der Gleichung lassen

üí° Gleichungen in LaTeX zu setzen basiert auf TeX, namentlich nach Leslie Laport benannt.

Beispiel 1: \texttt{\$\textbackslash{}sum\_\{n=1\}\^{}\{10\}\ n\^{}2\$} wird zu \(\sum_{n=1}^{10} n^2\)

Beispiel 2: \texttt{\$\$\textbackslash{}sum\_\{n=1\}\^{}\{10\}\ n\^{}2\$\$} wird zu \[\sum_{n=1}^{10} n^2\]

Zwei \texttt{\$\$} um die Gleichung resultieren, dass die Gleichung nicht in der Zeile eingebettet ist sondern frei steht.

Eine tolle Gleichung \(E=mc^2\) üòé

\hypertarget{bruxfcche}{%
\subsubsection{Br√ºche}\label{bruxfcche}}

\texttt{\$\textbackslash{}frac\{1\}\{2\}\$} ergibt \(\frac{1}{2}\)

\hypertarget{hoch--und-tiefstellung}{%
\subsubsection{Hoch- und Tiefstellung}\label{hoch--und-tiefstellung}}

\texttt{\$Y\ =\ X\_1\ +\ X\_2\$} ergibt \(Y = X_1 + X_2\)

\texttt{\$a\^{}2\ +\ b\^{}2\ =\ c\^{}2\$} ergibt \(a^2 + b^2 = c^2\)

\hypertarget{quadratwurzel}{%
\subsubsection{Quadratwurzel}\label{quadratwurzel}}

\texttt{\$\textbackslash{}sqrt\{p\}\$} ergibt \(\sqrt{p}\)

\texttt{\$x\ =\ \textbackslash{}frac\{-b\ \textbackslash{}pm\ \textbackslash{}sqrt\{b\^{}2\ -\ 4ac\}\}\{2a\}\$} ergibt \(x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}\)

\hypertarget{github}{%
\section{Github}\label{github}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

Github ist ein sogenanntes \emph{version control system}, freeware und wird vorallem bei der Softwareentwicklung genutzt. Der Vorteil ist, dass eine Vielzahl von Leuten an ein und demselben Projekt gleichzeitig arbeiten kann. Die Weiterentwicklung von Dateien und Projekten lassen sich mit github reproduzierbar nachvollziehen. Abgelegt werden Projekte in \textbf{repositories}, kurz \textbf{repos}.

\begin{quote}
Git manages the evolution of a set of files -- called a \textbf{repository} -- in a sane, highly structured way (such as ``Track Changes'' features from Microsoft Word on steroids)
\end{quote}

Schritt 1:

\begin{itemize}
\tightlist
\item
  Installiere git f√ºr windows \href{https://gitforwindows.org/}{here}

  \begin{itemize}
  \tightlist
  \item
    NOTE: When asked about ``Adjusting your PATH environment'', make
    sure to select ``Git from the command line and also from
    3rd-party software''. Otherwise, we believe it is good to accept
    the defaults.
  \item
    Note that RStudio for Windows prefers for Git to be installed
    below C:/Program Files and this appears to be the default. This
    implies, for example, that the Git executable on my Windows
    system is found at C:/Program Files/Git/bin/git.exe. Unless you
    have specific reasons to otherwise, follow this convention.
  \end{itemize}
\item
  Now: Introduce yourself to Git
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# library(usethis)}
\DocumentationTok{\#\# What user name should you give to Git? This does not have to be your GitHub user name, although it can be. Another good option is your actual first name and last name.}

\DocumentationTok{\#\# What email should you give to Git? This must be the email associated with your GitHub account.}
\CommentTok{\#use\_git\_config(user.name = "XY", user.email = "XY@gmx.de")}

\DocumentationTok{\#\# Create a github tokken for secure access to github. Then, you don\textquotesingle{}t need to access all the time your personal item}
\CommentTok{\# usethis::create\_github\_token()}

\DocumentationTok{\#\# Activate your tokken PAT = Personal Access Tokken}
\CommentTok{\# library(gitcreds)}
\CommentTok{\# gitcreds\_set()}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  Use a Git client

  \begin{itemize}
  \tightlist
  \item
    ``Git'' is really just a collection of individual commands you
    execute in the shell (Appendix A). This interface is not
    appealing for everyone. Some may prefer to do Git operations via
    a client with a graphical interface. Git and your Git client are
    not the same thing, just like R and RStudio are not the same
    thing. A Git client and an integrated development environment,
    such as RStudio, are not necessary to use Git or R,
    respectively.
  \item
    Sourcetree is a recommended option
  \end{itemize}
\item
  The most basic commands are listed below:

  \begin{itemize}
  \item
    pwd (print working directory). Shows directory or ``folder'' you
    are currently operating in. This is not necessarily the same as
    the R working directory you get from getwd().
  \item
    ls (list files). Shows the files in the current working
    directory. This is equivalent to looking at the files in your
    Finder/Explorer/File Manager. Use ls -a to also list hidden
    files, such as .Rhistory and .git.
  \item
    cd (change directory). Allows you to navigate through your
    directories by changing the shell's working directory. You can
    navigate like so: go to subdirectory foo of current working
    directory: cd foo go to parent of current working directory: cd
    .. go to your ``home'' directory: cd \textasciitilde{} or simply cd go to
    directory using absolute path, works regardless of your current
    working directory: cd /home/my\_username/Desktop. Windows uses a
    slightly different syntax with the slashes between the folder
    names reversed, , e.g.~cd C:\Users\MY\_USERNAME\Desktop. - Pro
    tip 1: Dragging and dropping a file or folder into the terminal
    window will paste the absolute path into the window. - Pro tip
    2: Use the tab key to autocomplete unambiguous directory and
    file names. Hit tab twice to see all ambiguous options.

    \begin{itemize}
    \tightlist
    \item
      Use arrow-up and arrow-down to repeat previous commands. Or
      search for previous commands with CTRL + r.
    \end{itemize}
  \end{itemize}
\item
  A few Git commands:

  \begin{itemize}
  \tightlist
  \item
    git status is the most used git command and informs you of your
    current branch, any changes or untracked files, and whether you
    are in sync with your remotes.
  \item
    git remote -v lists all remotes. Very useful for making sure git
    knows about your remote and that the remote address is correct.
  \item
    git remote add origin GITHUB\_URL adds the remote GITHUB\_URL with
    nickname origin.
  \item
    git remote set-url origin GITHUB\_URL changes the remote url of
    origin to GITHUB\_URL. This way you can fix typos in the remote
    url.
  \end{itemize}
\item
  Clone the new GitHub repository to your computer via RStudio

  \begin{itemize}
  \tightlist
  \item
    In RStudio, start a new Project:
  \item
    File \textgreater{} New Project \textgreater{} Version Control \textgreater{} Git.
  \item
    In ``Repository URL'', paste the URL of your new GitHub
    repository. It will be something like this
    \url{https://github.com/jennybc/myrepo.git}.
  \end{itemize}
\end{itemize}

\hypertarget{projekt-erstellen}{%
\subsection{Projekt erstellen}\label{projekt-erstellen}}

üö® Wir erstellen ein Projekt in der Reihenfolge \textbf{``GitHub first, then
RStudio''} Dadurch kopieren wird das Projekt von Github direkt auf den Computer und schalten \texttt{pulling} und \texttt{pushing} frei (√§quivalent zu git clone).

Nachdem wir einen Github account f√ºr uns erstellt haben, f√ºgen wir unserem account ein neues repository hinzu.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/077} 

}

\caption{Neues repository erstellen}\label{fig:unnamed-chunk-299}
\end{figure}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/078} 

}

\caption{Kurze und pr√§gnante Namen sind gut}\label{fig:unnamed-chunk-300}
\end{figure}

In unserem repo klicken wir auf Code und kopieren den Link (siehe unten).

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/068} 

}

\caption{Kopieren der URL f√ºr das Verkn√ºpfen des Projektes}\label{fig:unnamed-chunk-301}
\end{figure}

Dann √∂ffnen wir ein neues Projekt mit File --\textgreater{} New Project --\textgreater{} Version control --\textgreater{} Git. Dann kopieren wir die URL in das Feld \textbf{Repository URL} und et voila\ldots mit create project ist unser repo bei github mit unserem lokalen Projekt in R verkn√ºpft.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/069} 

}

\caption{Kopieren der URL f√ºr das Verkn√ºpfen des Projektes}\label{fig:unnamed-chunk-302}
\end{figure}

\hypertarget{workflow}{%
\subsubsection{Workflow}\label{workflow}}

Unser Schema lautet absofort

\begin{quote}
\textbf{Make local changes, save, commit and push to github}
\end{quote}

So sollte man immer vorgehen wenn man wichtige Dinge umgesetzt hat. Vorzugsweise mehrmals am Tag. Ein commit ist dabei wie ein snapshot aller Dateien, die editiert wurden.

üö® Der Text eines commits sollte daher individuell und nicht mehrmals vergeben werden, da es sonst zu Fehlermeldungen f√ºhren kann.

üö® Viele 100-1000 Dateien k√∂nnen zu abst√ºrzen bei der RStudio Oberfl√§che f√ºhren.

üö® Dateien bei github d√ºrfen nicht \textgreater{} 100 mb sein!

üö® Auch Dateiendungen bei github pages sind case sensitive. \texttt{.png} ist also was anderes als \texttt{.PNG}

üí° Unter C: einen Ordner Bilder erstellen, dort alle Bilder reinkopieren. Dann in der Kommandoaufforderung von windows den Pfad der Bilder festlegen mit \texttt{cd\ c:\textbackslash{}Bilder} und als n√§chstes mit \texttt{ren\ *.PNG\ *.png} automatisch alle Endungen umbenennen.

\hypertarget{synchronisieren-vieler-dateien}{%
\subsubsection{Synchronisieren vieler Dateien}\label{synchronisieren-vieler-dateien}}

Bei vielen 100 Dateien folgender Tipp: Markieren aller Eintr√§ge mit ``strg + A'' und dann strg gedr√ºckt halten und ein freies K√§stchen ausw√§hlen. üéâ

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/074} 

}

\caption{Commit von vielen Dateien}\label{fig:unnamed-chunk-303}
\end{figure}

Eine andere M√∂glichkeit ist im Terminal einzugeben

\begin{itemize}
\tightlist
\item
  \texttt{git\ add\ -\/-all}
\item
  \texttt{git\ commit\ -m\ "TEXT"}
\item
  \texttt{git\ push}
\end{itemize}

Falls Dateinamen zu lang sind k√∂nnen ebenfalls Probleme entstehen \href{https://stackoverflow.com/questions/52699177/how-to-fix-filename-too-long-error-during-git-clone/52699496}{stackoverflow}. Dann empfiehlt sich:

\begin{itemize}
\tightlist
\item
  \texttt{git\ clone\ -c\ core.longpaths=true\ \textless{}repo-url\textgreater{}}
\end{itemize}

einzugeben. Dann wird die Option ``lange Dateinnamen'' f√ºr das spezielle repository deaktiviert.

Falls Systemdateien sich auf dem lokalen Ordner befiden (bspw. \texttt{nul}) kann man diese entfernen mit:

\begin{itemize}
\tightlist
\item
  rechtsklick und ``Git Bash Here''
\item
  Schreibe: ``rm nul'' (oder die jeweilige \emph{Dateiname.Dateiendung}\ldots falls keine Dateiendung vorhanden wie bei diese MS-DOS Datei dann weglassen)
\end{itemize}

\hypertarget{ordner-lokal-behalten-aber-auf-git-luxf6schen}{%
\subsubsection{Ordner lokal behalten aber auf Git l√∂schen}\label{ordner-lokal-behalten-aber-auf-git-luxf6schen}}

Dazu kann man im Terminal eingeben \texttt{git\ rm\ -r\ -\/-cached\ FOLDERNAME}.

\hypertarget{cache-suxe4ubern}{%
\subsection{Cache s√§ubern}\label{cache-suxe4ubern}}

\url{https://stackoverflow.com/questions/13716658/how-to-delete-all-commit-history-in-github}

Beispielsweise wenn eine Datei \textgreater{} 100 mb gro√ü ist und dadurch eine commit Fehlermeldung auftritt.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Type in Terminal}
\CommentTok{\# Checkout}
\NormalTok{git checkout }\SpecialCharTok{{-}{-}}\NormalTok{orphan latest\_branch}
\CommentTok{\# Add all the files}
\NormalTok{git add }\SpecialCharTok{{-}}\NormalTok{A }
\CommentTok{\# Commit the changes}
\NormalTok{git commit }\SpecialCharTok{{-}}\NormalTok{am }\StringTok{"commit message"}
\CommentTok{\# Delete the branch}
\NormalTok{git branch }\SpecialCharTok{{-}}\NormalTok{D main}
\CommentTok{\# Rename the current branch to main}
\NormalTok{git branch }\SpecialCharTok{{-}}\NormalTok{m main}
\CommentTok{\# Finally, force update your repository}
\NormalTok{git push }\SpecialCharTok{{-}}\NormalTok{f origin main}
\CommentTok{\#PS: this will not keep your old commit history around}
\end{Highlighting}
\end{Shaded}

\hypertarget{bookdown}{%
\section{Bookdown}\label{bookdown}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/065} 

}

\caption{Source from: https://github.com/rstudio/bookdown}\label{fig:unnamed-chunk-306}
\end{figure}

üîç \url{https://bookdown.org/yihui/bookdown/}

Bookdown wurde von Yihui Xie geschrieben und findet immer weiter Verbreitung. Es ist ein package um technische Reports, B√ºcher, Artikel etc. zu schreiben und mit Leichtigkeit zu formatieren (ü§ê Frustpotenzial ist aber auch hier gegeben, da wie bei allen Dingen nichts auf Anhieb klappt).

Das package basiert auf RMarkdown Dokumenten welches bedeutet, dass man Text als auch Code und den Output von Code (bspw. visualisiert als Abbildung oder Tabelle) nutzen kann. Das fertige book kann dabei in die Dateiformate \emph{PDF}, \emph{HTML}, \emph{Word}, \ldots{} exportiert werden. Die Printversion als auch die Onlineversion des erstellten Buches sehen dabei sehr professionell aus. Beispiele von B√ºchern die mit \texttt{bookdown} geschrieben wurden findet ihr unter \url{https://bookdown.org/}.

\hypertarget{vorbereitung}{%
\subsection{Vorbereitung}\label{vorbereitung}}

Herunterladen von \texttt{pandoc}, \texttt{tinytex} und \texttt{bookdown}. \texttt{pandoc} und \texttt{tinytex} (Abwandlung von LaTeX) werden ben√∂tigt, um das book als .pdf file zu exportieren.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# installing/loading the package:}
\ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(installr)) \{ }\FunctionTok{install.packages}\NormalTok{(}\StringTok{"installr"}\NormalTok{); }\FunctionTok{require}\NormalTok{(installr)\} }\CommentTok{\#load / install+load installr}
\CommentTok{\# Installing pandoc}
\FunctionTok{install.pandoc}\NormalTok{()}
\CommentTok{\# Download tinytex package}
\NormalTok{tinytex}\SpecialCharTok{::}\FunctionTok{install\_tinytex}\NormalTok{()}
\CommentTok{\# Download bookdown package}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"bookdown"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Um alle \texttt{.Rmd} Dateien zu einem book zu binden muss der Befehl \texttt{render\_book()} in die Konsole eingegeben werden.

\hypertarget{github-pages}{%
\subsection{Github pages}\label{github-pages}}

üîç \url{https://bookdown.org/yihui/bookdown/github.html}
üîç \url{https://docs.github.com/en/pages/getting-started-with-github-pages/configuring-a-publishing-source-for-your-github-pages-site}

Als Vorbereitung f√ºr die Ver√∂ffentlichung als eigenst√§ndige github pages m√ºssen wir einige Anpassungen treffen. Die Dateien beim Rendering des Buches (alle \texttt{.html} Dateien) m√ºssen in den Ordner \texttt{docs} verschoben werden. Dazu erg√§nzt man in der \texttt{\_bookdown.yml} Datei den Befehl erg√§nzen:

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/073} 

}

\caption{Einstellungen in welchem Ordner das Book ver√∂ffentlicht werden soll}\label{fig:unnamed-chunk-308}
\end{figure}

Als n√§chstes erstellen wir eine \texttt{.nojekyll} Datei und verschieben diese nach dem rendering des books in den \texttt{docs} Ordner. Dazu in der Konsole \texttt{file.create(".nojekyll")} eingeben.

Unsere Dokumentation mit bookdown besteht aus vielen .html Dateien und kann daher √ºber das feature github pages als eigenst√§ndige website ver√∂ffentlicht werden. Dazu m√ºssen wir in unserem repository folgendes tun:

Settings --\textgreater{} Pages --\textgreater{} Im drop down Men√º \emph{main} und als Ordner \emph{/docs} w√§hlen --\textgreater{} save

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/072} 

}

\caption{Einstellungen f√ºr GitHub Pages}\label{fig:unnamed-chunk-309}
\end{figure}

Falls sich github pages nicht aktualisiert kann es daran liegen, dass die \texttt{index.html} Datei aktualisiert werden muss (bei GitHub website zu finden). Das sollte das Problem beheben.

Note: It can take up to 20 minutes for changes to your site to publish after you push the changes to GitHub. If your don't see your changes reflected in your browser after an hour, see ``About Jekyll build errors for GitHub Pages sites.''

\hypertarget{emojiys}{%
\subsection{Emojiys}\label{emojiys}}

Emojiys k√∂nnen einfach in B√ºcher oder reports eingebunden werden. Eine gro√üe √úbersicht ist \href{https://github.com/hadley/emo}{HIER} zu finden. F√ºr Literaturtipps bietet sich die Lupe an (üîç) oder f√ºr Tipps die Gl√ºhbirne (üí°). Weitere emojiys die ich gerne verwenden sind:

\begin{itemize}
\tightlist
\item
  ü§ê (secret)
\item
  üòé (cool)
\item
  üö® (alert)
\item
  üí° (tipp)
\item
  üí© (bad example)
\item
  üí™ (good example)
\item
  ‚åöÔ∏è (time)
\item
  üçª (time to celebrate)
\item
  üéâ (time to celebrate)
\item
  üíØ\% (100\%)
\item
  ü§Ø (shocked)
\item
  üôÉ
\item
  ‚òÄÔ∏è
\item
  üîç (literature)
\end{itemize}

\hypertarget{blogdown}{%
\section{Blogdown}\label{blogdown}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

\hypertarget{setup-a-homepage-with-hugo-and-blogdown}{%
\section{Setup a homepage with Hugo and blogdown}\label{setup-a-homepage-with-hugo-and-blogdown}}

\begin{itemize}
\tightlist
\item
  A great read is from the developer of blogdown (Allison Horst) \href{https://alison.rbind.io/post/new-year-new-blogdown/\#pre-requisites}{How
  to build a Hugo page with
  blogdown}
\item
  Pre-requisites you need

  \begin{itemize}
  \tightlist
  \item
    R and RStudio
  \item
    GitHub \href{https://happygitwithr.com/}{What is Github}.
  \end{itemize}
\end{itemize}

\hypertarget{github-1}{%
\subsection{Github}\label{github-1}}

\begin{itemize}
\item
  Git is a version control system.
\item
  Its original purpose was to help groups of developers work
  collaboratively on big software projects. Git manages the evolution
  of a set of files -- called a \textbf{repository} -- in a sane, highly
  structured way (such as ``Track Changes'' features from Microsoft Word
  on steroids)
\item
  Install git for windows \href{https://gitforwindows.org/}{here}

  \begin{itemize}
  \tightlist
  \item
    NOTE: When asked about ``Adjusting your PATH environment'', make
    sure to select ``Git from the command line and also from
    3rd-party software''. Otherwise, we believe it is good to accept
    the defaults.
  \item
    Note that RStudio for Windows prefers for Git to be installed
    below C:/Program Files and this appears to be the default. This
    implies, for example, that the Git executable on my Windows
    system is found at C:/Program Files/Git/bin/git.exe. Unless you
    have specific reasons to otherwise, follow this convention.
  \end{itemize}
\item
  Now: Introduce yourself to Git
\item
  Use a Git client

  \begin{itemize}
  \tightlist
  \item
    ``Git'' is really just a collection of individual commands you
    execute in the shell (Appendix A). This interface is not
    appealing for everyone. Some may prefer to do Git operations via
    a client with a graphical interface. Git and your Git client are
    not the same thing, just like R and RStudio are not the same
    thing. A Git client and an integrated development environment,
    such as RStudio, are not necessary to use Git or R,
    respectively.
  \item
    Sourcetree is a recommended option
  \end{itemize}
\item
  The most basic commands are listed below:

  \begin{itemize}
  \item
    pwd (print working directory). Shows directory or ``folder'' you
    are currently operating in. This is not necessarily the same as
    the R working directory you get from getwd().
  \item
    ls (list files). Shows the files in the current working
    directory. This is equivalent to looking at the files in your
    Finder/Explorer/File Manager. Use ls -a to also list hidden
    files, such as .Rhistory and .git.
  \item
    cd (change directory). Allows you to navigate through your
    directories by changing the shell's working directory. You can
    navigate like so: go to subdirectory foo of current working
    directory: cd foo go to parent of current working directory: cd
    .. go to your ``home'' directory: cd \textasciitilde{} or simply cd go to
    directory using absolute path, works regardless of your current
    working directory: cd /home/my\_username/Desktop. Windows uses a
    slightly different syntax with the slashes between the folder
    names reversed, , e.g.~cd C:\Users\MY\_USERNAME\Desktop. - Pro
    tip 1: Dragging and dropping a file or folder into the terminal
    window will paste the absolute path into the window. - Pro tip
    2: Use the tab key to autocomplete unambiguous directory and
    file names. Hit tab twice to see all ambiguous options.

    \begin{itemize}
    \tightlist
    \item
      Use arrow-up and arrow-down to repeat previous commands. Or
      search for previous commands with CTRL + r.
    \end{itemize}
  \end{itemize}
\item
  A few Git commands:

  \begin{itemize}
  \tightlist
  \item
    git status is the most used git command and informs you of your
    current branch, any changes or untracked files, and whether you
    are in sync with your remotes.
  \item
    git remote -v lists all remotes. Very useful for making sure git
    knows about your remote and that the remote address is correct.
  \item
    git remote add origin GITHUB\_URL adds the remote GITHUB\_URL with
    nickname origin.
  \item
    git remote set-url origin GITHUB\_URL changes the remote url of
    origin to GITHUB\_URL. This way you can fix typos in the remote
    url.
  \item
  \end{itemize}
\item
  HTTPS remotes look like \url{https://github.com/}/.git.
\item
  SSH remotes look like
  \href{mailto:git@github.com}{\nolinkurl{git@github.com}}:/.git.

  \begin{itemize}
  \tightlist
  \item
  \end{itemize}
\item
  Clone the new GitHub repository to your computer via RStudio

  \begin{itemize}
  \tightlist
  \item
    In RStudio, start a new Project:
  \item
    File \textgreater{} New Project \textgreater{} Version Control \textgreater{} Git.
  \item
    In ``Repository URL'', paste the URL of your new GitHub
    repository. It will be something like this
    \url{https://github.com/jennybc/myrepo.git}.
  \end{itemize}
\item
  We create a new Project, with the preferred \textbf{``GitHub first, then
  RStudio''} sequence. Why do we prefer this? Because this method of
  copying the Project from GitHub to your computer also sets up the
  local Git repository for immediate pulling and pushing. Under the
  hood, we are doing git clone.
\item
  Click ``Create Project'' to create a new directory, which will be all
  of these things:

  \begin{itemize}
  \tightlist
  \item
    a directory or ``folder'' on your computer
  \item
    a Git repository, linked to a remote GitHub repository
  \item
    an RStudio Project
  \end{itemize}
\item
  \textbf{Make local changes, save, commit}

  \begin{itemize}
  \tightlist
  \item
    Do this every time you finish a valuable chunk of work, probably
    many times a day.
  \item
    A commit functions like a snapshot of all the files in the repo,
    at a specific moment.
  \item
    Every time you make a commit you must also write a short commit
    message. Ideally, this conveys the motivation for the change.
  \item
    PNG is the ``no brainer'' format in which to store figures for the
    web.
  \end{itemize}
\end{itemize}

\hypertarget{domain-name}{%
\subsection{Domain name}\label{domain-name}}

\begin{itemize}
\tightlist
\item
  \href{https://bookdown.org/yihui/blogdown/domain-name.html\#domain-name}{See}
\item
  While you can use the free subdomain names like those provided by
  GitHub or Netlify, it may be a better idea to own a domain name of
  your own. The cost of an apex domain is minimal (typically the
  yearly cost is about US\$10), and you will enter a much richer world
  after you purchase a domain name. For example, you are free to point
  your domain to any web servers, you can create as many subdomain
  names as you want, and you can even set up your own email accounts
  using the domain or subdomains. In this appendix, we will explain
  some basic concepts of domain names, and mention a few (free)
  services to help you configure your domain name.
\end{itemize}

\hypertarget{homepage}{%
\subsection{Homepage}\label{homepage}}

\begin{itemize}
\item
  max. of 5 links in the header

  \begin{itemize}
  \item
    startpage (Biography with images as slideshow, e.g.~recent
    posts)
  \item
    blog (posts)
  \item
    redox with widgets

    \begin{itemize}
    \tightlist
    \item
      projects (with categories:
      Distributors/Applications/Interpretation/literature
    \item
      timeline/history of EH measurements ()
    \end{itemize}
  \item
    publications (recent publications)
  \item
    about
  \end{itemize}
\end{itemize}

\hypertarget{wowchemystarter-academic}{%
\subsection{``wowchemy/starter-academic''}\label{wowchemystarter-academic}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# The whole setup can be condensed into the following part:}
\NormalTok{remotes}\SpecialCharTok{::}\FunctionTok{install\_github}\NormalTok{(}\StringTok{"rstudio/blogdown"}\NormalTok{)}
\NormalTok{usethis}\SpecialCharTok{::}\FunctionTok{create\_project}\NormalTok{()}
\NormalTok{blogdown}\SpecialCharTok{::}\FunctionTok{new\_site}\NormalTok{(}\AttributeTok{theme =} \StringTok{"wowchemy/starter{-}academic"}\NormalTok{)}
\NormalTok{blogdown}\SpecialCharTok{::}\FunctionTok{serve\_site}\NormalTok{()}
\NormalTok{blogdown}\SpecialCharTok{::}\FunctionTok{new\_post}\NormalTok{(}\AttributeTok{title =} \StringTok{"Hi Hugo"}\NormalTok{, }
                     \AttributeTok{ext =} \StringTok{\textquotesingle{}.Rmarkdown\textquotesingle{}}\NormalTok{, }
                     \AttributeTok{subdir =} \StringTok{"post"}\NormalTok{)}
\NormalTok{usethis}\SpecialCharTok{::}\FunctionTok{use\_git}\NormalTok{()}
\NormalTok{usethis}\SpecialCharTok{::}\FunctionTok{use\_github}\NormalTok{() }\CommentTok{\# requires a GitHub PAT}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Information are taken from

  \begin{itemize}
  \tightlist
  \item
    Xie, Y., Thomas, A., Presmanes Hill, A., 2018. blogdown -
    Creating Websites with R Markdown. CRC Press, Boca Raton.
  \item
    \href{https://alison.rbind.io/post/new-year-new-blogdown/\#pre-requisites}{Allison Hill
    blog}
  \end{itemize}
\item
  Setup a profile for the page with

  \begin{itemize}
  \tightlist
  \item
    \texttt{blogdown::config\_Rprofile()}this will execute a special setup
    at every beginning
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{options}\NormalTok{(}
  \CommentTok{\# to automatically serve the site on RStudio startup, set this option to TRUE}
  \AttributeTok{blogdown.serve\_site.startup =} \ConstantTok{FALSE}\NormalTok{,}
  \CommentTok{\# to disable knitting Rmd files on save, set this option to FALSE}
  \AttributeTok{blogdown.knit.on\_save =} \ConstantTok{FALSE}\NormalTok{,     }\CommentTok{\#\textless{}{-} change}
  \AttributeTok{blogdown.author =} \StringTok{"Alison Hill"}\NormalTok{,  }\CommentTok{\#\textless{}{-} add}
  \AttributeTok{blogdown.ext =} \StringTok{".Rmarkdown"}\NormalTok{,      }\CommentTok{\#\textless{}{-} add}
  \AttributeTok{blogdown.subdir =} \StringTok{"post"}          \CommentTok{\#\textless{}{-} add}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  \texttt{config.toml}= Global settings for the page
\item
  \texttt{blogdown::serve\_site} = LiveReload is implemented and the site is
  built. You can preview in the viewer pane (the function is analogue
  to \texttt{blogdown::build\_site()})

  \begin{itemize}
  \tightlist
  \item
    This blocks the console, meaning that you will not be able to
    use your R console once you start this local web server.
  \end{itemize}
\item
  publishing directory (by default, public/ ). Your website will
  be generated to this directory, meaning that you do not need to
  manually add any files to this directory.
\item
  All files are written in R markdown and knitted to a markdown
  document. Hugo is a static site generator and does not know how to
  transform \textbf{.Rmd} or \textbf{.Rmarkdown} documents into \textbf{.HTML}
\end{itemize}

\hypertarget{where-to-adjust-the-homepage}{%
\subsection{Where to adjust the Homepage}\label{where-to-adjust-the-homepage}}

\begin{itemize}
\tightlist
\item
  \texttt{rstudioapi::navigateToFile("content/authors/admin/\_index.md")}
  Biographie

  \begin{itemize}
  \tightlist
  \item
    Change your profile pic, place it in the same folder and rename
    it with \textbf{avatar.jpg}
  \end{itemize}
\item
  \texttt{rstudioapi::navigateToFile("config/\_default/menus.toml")} Rename or
  change the order of the top navbar
\end{itemize}

\hypertarget{workflow-1}{%
\subsection{Workflow}\label{workflow-1}}

\begin{itemize}
\tightlist
\item
  Workflow

  \begin{itemize}
  \tightlist
  \item
    Open the RStudio project for the site.
  \item
    Start the Hugo server using blogdown::serve\_site() (only once
    due to the magic of LiveReload).
  \item
    View site in the RStudio viewer pane, and open in a new browser
    window while I work.
  \item
    Select existing files to edit using the file pane in RStudio.
  \item
    After making changes, save if a plain .md file, or if working
    with an .Rmd or an .Rmarkdown document, knit to preview! You can
    now use the Knit button to knit to the correct output format.
    You can also use the keyboard shortcut Cmd+Shift+K (Mac) or
    Ctrl+Shift+K (Windows/Linux).
  \item
    The console will detect the change (it will print Change
    detected, rebuilding site.), the viewer pane will update, and
    (in a few seconds) your local view in your browser will also
    refresh. Try to avoid hitting the refresh button in your
    browser.
  \item
    When happy with changes, add/commit/push changes to GitHub.
  \item
    Having blogdown::serve\_site running locally with LiveReload is
    especially useful as you can immediately see if you have totally
    screwed up. For example, in editing my about.md file, this error
    popped up in my console after making a change and I was able to
    fix the error right away:
  \end{itemize}
\item
  If you want a featured image to accompany your post and show up on
  your listing page (the clickable list of all your posts), you'll
  want to add an image with the word featured in the filename:
\end{itemize}

\hypertarget{yaml-metadata}{%
\subsection{YAML metadata}\label{yaml-metadata}}

\begin{itemize}
\tightlist
\item
  Each page should start with YAML metadata specifying information
  like the title, date, author, categories, tags, and so on. Depending
  on the specific Hugo theme and templates you use, some of these
  fields may be optional.
\item
  Among all YAML fields, we want to bring these to your attention:
\item
  \textbf{draft}: You can mark a document as a draft by setting draft: true
  in its YAML metadata. Draft posts will not be rendered if the site
  is built via blogdown::build\_site() or blogdown::hugo\_build(), but
  will be rendered in the local preview mode (see Section D.3).
\item
  \textbf{publishdate}: You may specify a future date to publish a post.
  Similar to draft posts, future posts are only rendered in the local
  preview mode.
\item
  \textbf{weight}: This field can take a numeric value to tell Hugo the
  order of pages when sorting them, e.g., when you generate a list of
  all pages under a directory, and two posts have the same date, you
  may assign different weights to them to get your desired order on
  the list.
\item
  \textbf{slug}: A character string as the tail of the URL. It is
  particularly useful when you define custom rules for permanent URLs
  (see Section 2.2.2).
\end{itemize}

\hypertarget{shiny}{%
\section{Shiny}\label{shiny}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

üîç \href{https://mastering-shiny.org/index.html}{Mastering Shiny - Build interactive apps, reports, dashboards}

üîç \url{https://www.youtube.com/watch?v=tfN10IUX9Lo}

Shiny ist ein R package um interaktive web apps, reports und dashbords zu bauen. Shiny kann dabei die Daten online so zur verf√ºgung stellen (bspw. √ºber einen web browser), dass jeder darauf zugreifen kann.

üòé Mit shiny k√∂nnen 100 Seiten auf eine einzige Seite komprimiert werden, sodass der Nutzer individuell auf eine spezielle Seite zugreifen kann. Die √úbersichtlichkeit steigt dadurch extrem.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/081} 

}

\caption{Shiny Prinzip, source: https://blog.efpsa.org/wp-content/uploads/2019/04/pic6.jpg}\label{fig:unnamed-chunk-315}
\end{figure}

Die zwei Hauptkomponenten einer shiny app sind \textbf{UI} (f√ºr User Interface; definiert wie die App aussehen soll) und \textbf{server function} (definiert wie die App arbeiten soll).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# lade shiny}
\FunctionTok{library}\NormalTok{(shiny)}
\CommentTok{\# create UI}
\NormalTok{ui }\OtherTok{\textless{}{-}} \FunctionTok{fluidPage}\NormalTok{(}
  \StringTok{"Hello, world!"}
\NormalTok{)}
\CommentTok{\# create server}
\NormalTok{server }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(input, output, session) \{}
\NormalTok{\}}
\CommentTok{\# run the app}
\FunctionTok{shinyApp}\NormalTok{(ui, server)}
\end{Highlighting}
\end{Shaded}

Die vier Schritte k√∂nnen zusammengefasst werden mit:

\begin{itemize}
\tightlist
\item
  Laden des shiny packages
\item
  UI = Definiere die HTML Webpage mit der Menschen interagieren k√∂nnen (\textbf{frontend})
\item
  Wie soll sich die App verhalten durch definieren einer \texttt{server()} Funktion (ist momentan leer; \textbf{backend})
\item
  Ausf√ºhren der App durch die Funktion `shinyApp(ui, server)
\end{itemize}

Um ein shiny Projekt zu beginnen gibt es zwei M√∂glichkeiten:

\begin{itemize}
\tightlist
\item
  Ein neues directory anlegen durch File -\textgreater{} New Project -\textgreater{} New Directory -\textgreater{} Shiny Web Application
\end{itemize}

Dadurch wird eine \texttt{app.R} Datei erstellt, in der die shiny app definiert wird.

üéâ Damit hast du deine erste web app gebaut!

\hypertarget{ui-benutzeroberfluxe4che}{%
\subsection{UI Benutzeroberfl√§che}\label{ui-benutzeroberfluxe4che}}

Als n√§chste gestalten und modifizieren wir die UI Oberfl√§che:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ui }\OtherTok{\textless{}{-}} \FunctionTok{fluidPage}\NormalTok{(}
  \FunctionTok{selectInput}\NormalTok{(}\StringTok{"dataset"}\NormalTok{, }\AttributeTok{label =} \StringTok{"Dataset"}\NormalTok{, }\AttributeTok{choices =} \FunctionTok{ls}\NormalTok{(}\StringTok{"package:datasets"}\NormalTok{)),}
  \FunctionTok{verbatimTextOutput}\NormalTok{(}\StringTok{"summary"}\NormalTok{),}
  \FunctionTok{tableOutput}\NormalTok{(}\StringTok{"table"}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  \texttt{fluidPage()} ist eine layout Funktion um die Allgemeinen visuellen Strukturen der App festzulegen.
\item
  \texttt{selectInput()} l√§sst den Nutzer mit der App interagieren, indem eine Box bereitgestellt wird mit dem Label ``Dataset''.
\item
  \texttt{verbatimTextOutput()} und \texttt{tableOutput()} sind Funktionen um shiny zu vermitteln, wo und wie der Output dargestellt werden soll.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# run the shinyapp again}
\FunctionTok{shinyApp}\NormalTok{(ui, server)}
\end{Highlighting}
\end{Shaded}

\hypertarget{welche-befehle-sollen-ausgefuxfchrt-werden}{%
\subsection{Welche Befehle sollen ausgef√ºhrt werden}\label{welche-befehle-sollen-ausgefuxfchrt-werden}}

Shiny verwendet \emph{reactive programming}, dass bedeutet wir m√ºssen shiny vermitteln \textbf{wie} eine Berechnung oder Darstellung durchgef√ºhrt wird und nicht \textbf{die} eine Berechnung durchzuf√ºhren.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# define server function}
\NormalTok{server }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(input, output, session) \{}
\NormalTok{  output}\SpecialCharTok{$}\NormalTok{summary }\OtherTok{\textless{}{-}} \FunctionTok{renderPrint}\NormalTok{(\{}
\NormalTok{    dataset }\OtherTok{\textless{}{-}} \FunctionTok{get}\NormalTok{(input}\SpecialCharTok{$}\NormalTok{dataset, }\StringTok{"package:datasets"}\NormalTok{)}
    \FunctionTok{summary}\NormalTok{(dataset)}
\NormalTok{  \})}
  
\NormalTok{  output}\SpecialCharTok{$}\NormalTok{table }\OtherTok{\textless{}{-}} \FunctionTok{renderTable}\NormalTok{(\{}
\NormalTok{    dataset }\OtherTok{\textless{}{-}} \FunctionTok{get}\NormalTok{(input}\SpecialCharTok{$}\NormalTok{dataset, }\StringTok{"package:datasets"}\NormalTok{)}
\NormalTok{    dataset}
\NormalTok{  \})}
\NormalTok{\}}
\CommentTok{\# run the app}
\FunctionTok{shinyApp}\NormalTok{(ui, server)}
\end{Highlighting}
\end{Shaded}

Das Objekt \texttt{server} kann noch besser definiert werden durch eine \emph{reactive expression}. Dadurch muss man Objekte (in diesem Beispiel \texttt{get(input\$dataset,\ "package:datasets")}) nur einmal definieren. Eine reactive expression wird dabei wie ein Funktionsaufruf genutzt:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{server }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(input, output, session) \{}
  \CommentTok{\# Create a reactive expression}
\NormalTok{  dataset }\OtherTok{\textless{}{-}} \FunctionTok{reactive}\NormalTok{(\{}
    \FunctionTok{get}\NormalTok{(input}\SpecialCharTok{$}\NormalTok{dataset, }\StringTok{"package:datasets"}\NormalTok{)}
\NormalTok{  \})}

\NormalTok{  output}\SpecialCharTok{$}\NormalTok{summary }\OtherTok{\textless{}{-}} \FunctionTok{renderPrint}\NormalTok{(\{}
    \CommentTok{\# Use a reactive expression by calling it like a function}
    \FunctionTok{summary}\NormalTok{(}\FunctionTok{dataset}\NormalTok{())}
\NormalTok{  \})}
  
\NormalTok{  output}\SpecialCharTok{$}\NormalTok{table }\OtherTok{\textless{}{-}} \FunctionTok{renderTable}\NormalTok{(\{}
    \FunctionTok{dataset}\NormalTok{()}
\NormalTok{  \})}
\NormalTok{\}}

\FunctionTok{shinyApp}\NormalTok{(ui, server)}
\end{Highlighting}
\end{Shaded}

\hypertarget{beispiel-speicherkoog}{%
\subsection{Beispiel Speicherkoog}\label{beispiel-speicherkoog}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Transform the data to long format to filter by id and display value in the app}
\NormalTok{data }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(daily, }\FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{contains}\NormalTok{(}\StringTok{"st"}\NormalTok{), }\AttributeTok{names\_to =} \StringTok{"id"}\NormalTok{)}

\FunctionTok{str}\NormalTok{(data)}
\end{Highlighting}
\end{Shaded}

\hypertarget{diverses}{%
\section{Diverses}\label{diverses}}

\emph{Der Beitrag wurde das letzte mal am 26 August, 2021 editiert}

\hypertarget{entfernen-aller-packages}{%
\subsubsection{Entfernen aller packages}\label{entfernen-aller-packages}}

\begin{itemize}
\tightlist
\item
  Falls es beim arbeiten mit R und den dazugehoerigen packages zu Problemen kommt hilft der folgende Befehl diese zu loeschen:
\end{itemize}

\href{https://www.r-bloggers.com/2016/10/how-to-remove-all-user-installed-packages-in-r/}{R bloggers}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# create a list of all installed packages}
\NormalTok{ ip }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{installed.packages}\NormalTok{())}
 \FunctionTok{head}\NormalTok{(ip)}
\CommentTok{\# if you use MRO, make sure that no packages in this library will be removed}
\NormalTok{ ip }\OtherTok{\textless{}{-}} \FunctionTok{subset}\NormalTok{(ip, }\SpecialCharTok{!}\FunctionTok{grepl}\NormalTok{(}\StringTok{"MRO"}\NormalTok{, ip}\SpecialCharTok{$}\NormalTok{LibPath))}
\CommentTok{\# we don\textquotesingle{}t want to remove base or recommended packages either\textbackslash{}}
\NormalTok{ ip }\OtherTok{\textless{}{-}}\NormalTok{ ip[}\SpecialCharTok{!}\NormalTok{(ip[,}\StringTok{"Priority"}\NormalTok{] }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"base"}\NormalTok{, }\StringTok{"recommended"}\NormalTok{)),]}
\CommentTok{\# determine the library where the packages are installed}
\NormalTok{ path.lib }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(ip}\SpecialCharTok{$}\NormalTok{LibPath)}
\CommentTok{\# create a vector with all the names of the packages you want to remove}
\NormalTok{ pkgs.to.remove }\OtherTok{\textless{}{-}}\NormalTok{ ip[,}\DecValTok{1}\NormalTok{]}
 \FunctionTok{head}\NormalTok{(pkgs.to.remove)}
\CommentTok{\# remove the packages}

 \FunctionTok{sapply}\NormalTok{(pkgs.to.remove, remove.packages, }\AttributeTok{lib =}\NormalTok{ path.lib)}
\end{Highlighting}
\end{Shaded}

\hypertarget{shortcuts}{%
\subsubsection{Shortcuts}\label{shortcuts}}

Was w√§re das Leben ohne shortcuts. F√ºr viele Anwendungen spart es wahnsinnig viel Zeit.

Informationen koennen auf der \href{https://support.rstudio.com/hc/en-us/articles/200711853-Keyboard-Shortcuts}{RStudio Homepage gefunden werden} oder direkt unter Tools -\textgreater{} Keyboard shortcuts help.

üí° Der shortcut f√ºr die shortcuts lautet \textbf{Alt + shift + K}

\hypertarget{faqs}{%
\subsection{FAQs}\label{faqs}}

\hypertarget{kalender-erstellen}{%
\subsubsection{Kalender erstellen}\label{kalender-erstellen}}

üîç \url{https://r-coder.com/calendar-plot-r/}

Als erstes laden wir das \texttt{calendR} package:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the package}
\FunctionTok{library}\NormalTok{(calendR)}

\CommentTok{\# Display the current year}
\FunctionTok{calendR}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-325-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Specifiy the year you prefer}
\FunctionTok{calendR}\NormalTok{(}\AttributeTok{year =} \DecValTok{2020}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-325-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# start with monday}
\FunctionTok{calendR}\NormalTok{(}\AttributeTok{year =} \DecValTok{2021}\NormalTok{, }
        \AttributeTok{start =} \StringTok{"M"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-325-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# change the language compared with the operating system }
\FunctionTok{Sys.setlocale}\NormalTok{(}\StringTok{"LC\_ALL"}\NormalTok{, }\StringTok{"English"}\NormalTok{)}
\DocumentationTok{\#\# [1] "LC\_COLLATE=English\_United States.1252;LC\_CTYPE=English\_United States.1252;LC\_MONETARY=English\_United States.1252;LC\_NUMERIC=C;LC\_TIME=English\_United States.1252"}
\FunctionTok{calendR}\NormalTok{(}\AttributeTok{year =} \DecValTok{2021}\NormalTok{, }
        \AttributeTok{start =} \StringTok{"M"}\NormalTok{, }
        \AttributeTok{special.days =} \FunctionTok{c}\NormalTok{(}\DecValTok{9}\NormalTok{, }\DecValTok{21}\NormalTok{,}\DecValTok{300}\NormalTok{, }\DecValTok{365}\NormalTok{),}
        \AttributeTok{special.col =} \StringTok{"lightblue"}
\NormalTok{        )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-325-4} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# highlight all the weekends}
\FunctionTok{calendR}\NormalTok{(}\AttributeTok{year =} \DecValTok{2021}\NormalTok{,}
        \AttributeTok{start =} \StringTok{"M"}\NormalTok{,}
        \AttributeTok{special.days =} \StringTok{"weekend"}\NormalTok{) }\CommentTok{\# Color all weekends}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-325-5} \end{center}

\hypertarget{rstudio-1}{%
\subsubsection{RStudio}\label{rstudio-1}}

üîç \url{https://community.rstudio.com/t/plots-not-showing-up-in-the-plots-pane-in-rstudio/3981/5}

Falls die Plots nicht in im plots Fenster oder im Viewer der RStudio Benutzeroberfl√§che angezeigt werden, sondern aussschlie√ülich unter dem code chunk, dann m√ºssen die folgenden Einstellungen gesetzt werden:

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/047} 

}

\caption{Lage Standort Speicherkoog}\label{fig:unnamed-chunk-326}
\end{figure}

\hypertarget{datenmanipulation}{%
\subsubsection{Datenmanipulation}\label{datenmanipulation}}

\hypertarget{create-decadal-data}{%
\paragraph{Create decadal data}\label{create-decadal-data}}

Ein schneller Schritt eine Spalte pro Dekade zu erstellen geht folgenderma√üen:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Example with the gapminder data }
\NormalTok{gapminder }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(year, country, pop) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 3}
\DocumentationTok{\#\#    year country          pop}
\DocumentationTok{\#\#   \textless{}int\textgreater{} \textless{}fct\textgreater{}          \textless{}int\textgreater{}}
\DocumentationTok{\#\# 1  1952 Afghanistan  8425333}
\DocumentationTok{\#\# 2  1957 Afghanistan  9240934}
\DocumentationTok{\#\# 3  1962 Afghanistan 10267083}
\DocumentationTok{\#\# 4  1967 Afghanistan 11537966}
\DocumentationTok{\#\# 5  1972 Afghanistan 13079460}

\CommentTok{\# Use floor() and round to the nearest border}
\NormalTok{gapminder }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{decade =} \FunctionTok{floor}\NormalTok{(year }\SpecialCharTok{/} \DecValTok{10}\NormalTok{),  }
    \AttributeTok{decade =}\NormalTok{ decade }\SpecialCharTok{*} \DecValTok{10}\NormalTok{, }
    \AttributeTok{decade =} \FunctionTok{factor}\NormalTok{(decade)}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(year, decade, country, pop) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{(}\AttributeTok{n =} \DecValTok{5}\NormalTok{)}
\DocumentationTok{\#\# \# A tibble: 5 x 4}
\DocumentationTok{\#\#    year decade country          pop}
\DocumentationTok{\#\#   \textless{}int\textgreater{} \textless{}fct\textgreater{}  \textless{}fct\textgreater{}          \textless{}int\textgreater{}}
\DocumentationTok{\#\# 1  1952 1950   Afghanistan  8425333}
\DocumentationTok{\#\# 2  1957 1950   Afghanistan  9240934}
\DocumentationTok{\#\# 3  1962 1960   Afghanistan 10267083}
\DocumentationTok{\#\# 4  1967 1960   Afghanistan 11537966}
\DocumentationTok{\#\# 5  1972 1970   Afghanistan 13079460}
\end{Highlighting}
\end{Shaded}

\hypertarget{string-manipulation}{%
\paragraph{String manipulation}\label{string-manipulation}}

üîç \url{http://www.endmemo.com/r/gsub.php}
üîç \url{https://bookdown.org/rdpeng/rprogdatascience/r-nuts-and-bolts.html\#summary}

Die wichtigsten R Funktionen um Strings zu bearbeiten sind:

\begin{itemize}
\tightlist
\item
  \texttt{grep()} und \texttt{grepl()}: Sucht nach einem regul√§ren Ausdruck in einem String
\item
  \texttt{regexpr()}, \texttt{gregexpr()} und \texttt{regexec()}: Sucht nach Treffern in einem regul√§ren Ausdruck und geben die Indizes wieder, wo der Treffer auftrifft.
\item
  \texttt{sub()} und \texttt{gsub()}: Sucht nach einem regul√§ren Ausdruck in einem String und ersetzt diesen
\end{itemize}

Das Muster ist dabei \emph{pattern} - \emph{replacement}:

gsub(pattern, replacement, x, ignore.case = FALSE, perl = FALSE, fixed = FALSE, useBytes = FALSE)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"Eine tolle Exursion"}
\FunctionTok{gsub}\NormalTok{(}\StringTok{"Eine tolle"}\NormalTok{, }\StringTok{"Die weltbeste"}\NormalTok{, x)}
\DocumentationTok{\#\# [1] "Die weltbeste Exursion"}
\end{Highlighting}
\end{Shaded}

\hypertarget{split-a-single-column-into-multiple-columns}{%
\paragraph{Split a single column into multiple columns}\label{split-a-single-column-into-multiple-columns}}

üîç \url{https://cmdlinetips.com/2018/03/how-to-split-text-in-a-column-in-data-frame-in-r/}

Beim Anlegen von Variablennamen kann man Informationen in dem jeweiligen Namen bereits hinterlegen. Zum Beispiel die Codierung \texttt{01\_10\_st} kann vom Standort \textbf{01} in \textbf{10} cm Tiefe der Parameter \textbf{Bodentemperatur} sein. M√∂chte ich diese Spalteninformationen nun auf mehrer Spalten Verteilen eignet sich die Funktion \texttt{separate}.

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{id =} \StringTok{"01\_10\_st"}\NormalTok{,}
  \AttributeTok{value =} \FloatTok{10.3}
\NormalTok{)}
\NormalTok{x}
\DocumentationTok{\#\# \# A tibble: 1 x 2}
\DocumentationTok{\#\#   id       value}
\DocumentationTok{\#\#   \textless{}chr\textgreater{}    \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 01\_10\_st  10.3}

\CommentTok{\# Create new columns with the information from the id column}
\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ x }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{separate}\NormalTok{(id, }\AttributeTok{into =} \FunctionTok{c}\NormalTok{(}\StringTok{"study\_site"}\NormalTok{, }\StringTok{"depth"}\NormalTok{, }\StringTok{"parameter"}\NormalTok{))}
\NormalTok{y}
\DocumentationTok{\#\# \# A tibble: 1 x 4}
\DocumentationTok{\#\#   study\_site depth parameter value}
\DocumentationTok{\#\#   \textless{}chr\textgreater{}      \textless{}chr\textgreater{} \textless{}chr\textgreater{}     \textless{}dbl\textgreater{}}
\DocumentationTok{\#\# 1 01         10    st         10.3}
\end{Highlighting}
\end{Shaded}

Aber Achtung. R ist auch hier Anf√§llig gegen√ºber Gro√ü- Kleinschreibung.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"Eine tolle Exursion"}
\FunctionTok{gsub}\NormalTok{(}\StringTok{"Eine Tolle"}\NormalTok{, }\StringTok{"Die weltbeste"}\NormalTok{, x)}
\DocumentationTok{\#\# [1] "Eine tolle Exursion"}
\end{Highlighting}
\end{Shaded}

Ich kann aber auch das Argument setzen, dass Kleinschreibung egal ist mit:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"Eine tolle Exursion"}
\FunctionTok{gsub}\NormalTok{(}\StringTok{"Eine Tolle"}\NormalTok{, }\StringTok{"Die weltbeste"}\NormalTok{, x, }\AttributeTok{ignore.case =}\NormalTok{ T)}
\DocumentationTok{\#\# [1] "Die weltbeste Exursion"}
\end{Highlighting}
\end{Shaded}

\hypertarget{visualisation}{%
\subsection{Visualisation}\label{visualisation}}

\hypertarget{superscripts-and-subscripts}{%
\subsubsection{Superscripts and subscripts}\label{superscripts-and-subscripts}}

Um Zahlen an Plot labels hoch- oder tiefzustellen, bspw. Achsenbeschriftung oder Titel, kann man die Befehlen √®xpression\texttt{und}paste` verwenden. Expression erm√∂glicht die Verwendung von Sonderzeichen und paste erm√∂glicht die Sonderzeichen mit \emph{normalem} Text zu verkn√ºpfen.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle willk√ºrlich Daten a mit vier Gruppen in b}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{a =} \FunctionTok{rnorm}\NormalTok{(}\AttributeTok{n =} \DecValTok{100}\NormalTok{, }\AttributeTok{mean =} \DecValTok{50}\NormalTok{, }\AttributeTok{sd =} \DecValTok{2}\NormalTok{),}
  \AttributeTok{b =} \FunctionTok{rep}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{,}\StringTok{"b"}\NormalTok{,}\StringTok{"c"}\NormalTok{,}\StringTok{"d"}\NormalTok{), }\DecValTok{25}\NormalTok{)}
\NormalTok{)}

\NormalTok{x }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(a, b, }\AttributeTok{group =}\NormalTok{ b)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-332-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# [] Tiefstellen}
\NormalTok{x }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(a, b, }\AttributeTok{group =}\NormalTok{ b)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Eine tolle √úberschrift"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Einheit (XY)"}\NormalTok{,}
    \AttributeTok{y =} \FunctionTok{expression}\NormalTok{(E[H])}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-332-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# \^{} Hochstellen}
\NormalTok{x }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(a, b, }\AttributeTok{group =}\NormalTok{ b)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Eine tolle √úberschrift"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Einheit (XY)"}\NormalTok{,}
    \AttributeTok{y =} \FunctionTok{expression}\NormalTok{(m}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-332-3} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Kombination + normaler Text}
\NormalTok{x }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(a, b, }\AttributeTok{group =}\NormalTok{ b)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Eine tolle √úberschrift"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Einheit (XY)"}\NormalTok{,}
    \AttributeTok{y =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Ca"} \SpecialCharTok{\^{}}\StringTok{"2+"}\NormalTok{, }\StringTok{" Verteilung (g "}\NormalTok{, cm}\SpecialCharTok{\^{}{-}}\DecValTok{3}\NormalTok{, }\StringTok{")"}\NormalTok{))}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-332-4} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Bei langen Beschriftungen eignen sich auch Zeilenumbr√ºche, die mit "\textbackslash{}n" erzeugt werden}
\NormalTok{x }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(a, b, }\AttributeTok{group =}\NormalTok{ b)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Eine tolle }\SpecialCharTok{\textbackslash{}n}\StringTok{√úberschrift"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Einheit (XY)"}\NormalTok{,}
    \AttributeTok{y =} \FunctionTok{expression}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Ca"} \SpecialCharTok{\^{}}\StringTok{"2+"}\NormalTok{, }\StringTok{" Verteilung (g "}\NormalTok{, cm}\SpecialCharTok{\^{}{-}}\DecValTok{3}\NormalTok{, }\StringTok{")"}\NormalTok{))}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-332-5} \end{center}

\hypertarget{modifying-labels-in-faceted-plots}{%
\subsubsection{Modifying labels in faceted plots}\label{modifying-labels-in-faceted-plots}}

üîç \url{https://biostats.w.uib.no/modifying-labels-in-faceted-plots/}

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{images/048} 

}

\caption{@Henry Wang taken from: https://henrywang.nl/ggplot2-theme-elements-demonstration/}\label{fig:unnamed-chunk-333}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Darstellung des gesamten Zeitraums}
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textgreater{}} \StringTok{"2010"} \SpecialCharTok{\&}\NormalTok{ year }\SpecialCharTok{\textless{}} \StringTok{"2013"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-334-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]

\CommentTok{\# Darstellen pro Jahr}
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textgreater{}} \StringTok{"2010"} \SpecialCharTok{\&}\NormalTok{ year }\SpecialCharTok{\textless{}} \StringTok{"2013"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{year, }\AttributeTok{scales =} \StringTok{"free\_x"}\NormalTok{)}

\NormalTok{p}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-334-2} \end{center}

√Ñndern der Hintegrundfarbe

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{strip.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill=}\StringTok{"lightblue"}\NormalTok{, }\AttributeTok{size=}\DecValTok{1}\NormalTok{, }\AttributeTok{color=}\StringTok{"darkblue"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-335-1} \end{center}

√Ñndern der Schriftfarbe

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{strip.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size=}\DecValTok{12}\NormalTok{, }\AttributeTok{face=}\StringTok{"italic"}\NormalTok{, }\AttributeTok{color=}\StringTok{"darkblue"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-336-1} \end{center}

√Ñndern der Beschriftung ist nicht ganz unkompliziert, da die Beschriftung von den Variablennamen der Spalten genommen wird. M√∂glichkeit 1 w√§re, die Beschriftung im Datensatz direkt zu √§ndern. M√∂glichkeit zwei ist einen neuen Namensvektor zu erstellen und die Funktion \texttt{labeller\ =\ labeller()} zu verwenden.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Erstelle Namensvektor}
\NormalTok{new\_name }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"2011"} \OtherTok{=} \StringTok{"Gute Zeiten"}\NormalTok{, }\StringTok{"2012"} \OtherTok{=} \StringTok{"Schlechte Zeiten"}\NormalTok{)}

\CommentTok{\# Nutze die Funktion labeller}
\NormalTok{koog\_day }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textgreater{}} \StringTok{"2010"} \SpecialCharTok{\&}\NormalTok{ year }\SpecialCharTok{\textless{}} \StringTok{"2013"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(daily, st10)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{year, }\AttributeTok{scales =} \StringTok{"free\_x"}\NormalTok{, }\AttributeTok{labeller =} \FunctionTok{labeller}\NormalTok{(}\AttributeTok{year =}\NormalTok{ new\_name))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-337-1} \end{center}

Auch der Abstand zwischen den Panels kann ver√§ndert werden mit \texttt{theme(panel.spacing\ =\ unit())}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Hm....es gibt immer noch einen overlap bei der X{-}Achse}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.spacing.x =} \FunctionTok{unit}\NormalTok{(.}\DecValTok{25}\NormalTok{, }\StringTok{"cm"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-338-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# JA :) Besser}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.spacing.x =} \FunctionTok{unit}\NormalTok{(}\FloatTok{1.25}\NormalTok{, }\StringTok{"cm"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=1\linewidth]{documentation_files/figure-latex/unnamed-chunk-339-1} \end{center}

\hypertarget{glossary}{%
\subsection{Glossary}\label{glossary}}

\begin{itemize}
\item
  \href{https://de.wikipedia.org/wiki/Shell_(Betriebssystem)}{Shell}

  \begin{itemize}
  \tightlist
  \item
    In der Informatik wird als Shell die Software bezeichnet,
    mittels derer ein Benutzer mit einem Betriebssystem interagiert
    -- eine Mensch-Maschine-Schnittstelle. W√§hrend Kernel den Kern
    eines Betriebssystems bezeichnet, ist die Shell (englisch f√ºr
    ‚ÄûSchale'', ‚ÄûH√ºlle'' oder ‚ÄûAu√üenhaut'') anschaulich dessen
    Au√üenschicht und damit Schnittstelle (englisch Interface) zum
    Benutzer.
  \item
    Synonym = ``terminal'', ``command line'', and ``console''
  \end{itemize}
\item
  \href{https://de.wikipedia.org/wiki/Grafische_Benutzeroberfl\%C3\%A4che}{GUI}

  \begin{itemize}
  \tightlist
  \item
    Grafische Benutzeroberfl√§che oder auch grafische
    Benutzerschnittstelle oder Bedienoberfl√§che (Abk. GUI von
    englisch graphical user interface) bezeichnet eine Form von
    Benutzerschnittstelle eines Computers. Sie hat die Aufgabe,
    Anwendungssoftware auf einem Rechner mittels grafischer Symbole,
    Steuerelemente oder auch Widgets genannt, bedienbar zu machen.
  \end{itemize}
\item
  \href{https://de.wikipedia.org/wiki/Zwischenablage}{Clipboard}

  \begin{itemize}
  \tightlist
  \item
    Ein Clipboard ist der englischsprachige Begriff f√ºr eine
    Zwischenablage in der elektronischen Datenverarbeitung, d.~h.
    ein virtueller Zwischenspeicher
  \end{itemize}
\end{itemize}

\end{document}
